{"version":2,"kind":"Article","sha256":"22b0594eea509fb370fff36e59790dd017f56817171c2e9720726087c03df587","slug":"xpanda-mergingshaping","location":"/xPanda_MergingShaping.md","dependencies":[],"frontmatter":{"title":"Panda Merging and Shaping","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\testcsci127_b\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xPanda_MergingShaping.md","url":"/booktest/build/xPanda_MergingShapin-842502edf5c09d3997a499489c227cf8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explanation of Each Operation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ii0BtEbAtI"}],"key":"lgaCndtYFX"}],"identifier":"explanation-of-each-operation","label":"Explanation of Each Operation","html_id":"explanation-of-each-operation","implicit":true,"key":"Anr1Al63tk"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"pd.merge()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AhlDy2Iv80"}],"key":"VTuZhZ9MUa"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nrYcYwXc3q"}],"key":"VbPhf8qTS3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Merges two DataFrames on a common column or key.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"poyomXGkp1"}],"key":"sphOHOX0sK"}],"key":"SERrjkq3Dw"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gRvCMLbknB"},{"type":"inlineCode","value":"merged_df","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZNZ49MN7SV"},{"type":"text","value":" combines ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xwtpaWV8nx"},{"type":"inlineCode","value":"df1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"P8JJefhFCA"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"m2bNtZEa6q"},{"type":"inlineCode","value":"df2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EjNES8iFf6"},{"type":"text","value":" on the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OuHGOIURD6"},{"type":"inlineCode","value":"ID","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bqwGzXaKKT"},{"type":"text","value":" column using an inner join.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"m3WjTCp3UD"}],"key":"GuTaf9ieUb"}],"key":"WEQXivJvVi"}],"key":"mlWS4qcGKS"}],"key":"xzJOEcb0YC"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"pd.concat()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"uY3habusmW"}],"key":"Lv3ecGLJT5"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jDBV5EBBnK"}],"key":"VtX5Cyhh32"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Concatenates two or more DataFrames along rows (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rzJGJUig5U"},{"type":"inlineCode","value":"axis=0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OgzVlDnSlC"},{"type":"text","value":") or columns (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gFfDx9zDT0"},{"type":"inlineCode","value":"axis=1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"axGdW31okt"},{"type":"text","value":").","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kKuJZNEMpu"}],"key":"xYLceTxdOX"}],"key":"QgkW28Gvrn"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EKqyduPQMl"},{"type":"inlineCode","value":"concat_rows","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GJjQZznRl7"},{"type":"text","value":" stacks ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"uhCOpn81dB"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OKpZ6c4RnL"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wnjaV0PVxQ"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YN5HXmM3x4"},{"type":"text","value":" vertically, while ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Ho1JXMgxSM"},{"type":"inlineCode","value":"concat_columns","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mRGj6exu5j"},{"type":"text","value":" appends ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zOSYq5hE9v"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ojPtAXdYWF"},{"type":"text","value":" as additional columns to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HRHEZ5N0rM"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lu3TXKu5od"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"JMlH1JYiox"}],"key":"yepCHmKiIB"}],"key":"VaCRgOfejG"}],"key":"LSYl42BOHt"}],"key":"BgKgjhWfz2"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"df.join()","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"AZHpx9lbd3"}],"key":"lIbq1AQzKZ"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"AGKpkXR3d4"}],"key":"EeMHOzzhWG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Joins two DataFrames based on their indices.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"geovsu3t3H"}],"key":"qE3zGksEN6"}],"key":"GgBi9HWd7B"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"a0W25Ph3EC"},{"type":"inlineCode","value":"joined_df","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"sN3w7p4KU8"},{"type":"text","value":" joins ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bFJeKTFbNr"},{"type":"inlineCode","value":"df1_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"i4grTVU2bX"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RksRqKwUwc"},{"type":"inlineCode","value":"df3_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dmj3qR7oXo"},{"type":"text","value":" on their index values.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CnptDXBdRK"}],"key":"MQI3bGTRan"}],"key":"PbvedCepcC"}],"key":"Oeqc7TR27n"}],"key":"XvaJbPtLMX"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineCode","value":"df.melt()","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kAJHyeR9gT"}],"key":"kcKtfI5UXn"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kLxDHpHv6Q"}],"key":"jrx8AFLpXu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from wide format to long format by unpivoting columns.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zhl4z2pr9y"}],"key":"HSfO6c3l1P"}],"key":"E9idGQGYUa"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"HNhW85fdHh"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"t0QhNbXQLI"},{"type":"text","value":" turns ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"V0GnhZy1GT"},{"type":"inlineCode","value":"Name","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"S8WOwiV3Qs"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"HDZXMUn3DE"},{"type":"inlineCode","value":"Age","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"cwZuUHPeDO"},{"type":"text","value":" columns into rows with corresponding values.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"D0RQ5kR040"}],"key":"AgFEgztmLF"}],"key":"uCl7IO0AFY"}],"key":"kclTND16ac"}],"key":"efpwxjW2EH"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"df.pivot()","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Rw8iTtpHqH"}],"key":"PxfORJifFd"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mQb61nQt2C"}],"key":"YOllkFZBY0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from long format to wide format by pivoting on a specified column.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"kWOTdk9rw0"}],"key":"tuiCubUc4v"}],"key":"n9P3djHGVo"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wEZSZXDlV6"},{"type":"inlineCode","value":"pivoted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bPyuUSjFy9"},{"type":"text","value":" pivots ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"AsBgT0QwqI"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XIwqEAwCim"},{"type":"text","value":" back to wide format with ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"UEXBihMTmL"},{"type":"inlineCode","value":"Name","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"n0hlgS8fMI"},{"type":"text","value":" and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pNyrxqAHvZ"},{"type":"inlineCode","value":"Age","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bOWwehfSiK"},{"type":"text","value":" as columns.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"yIflHRXFGW"}],"key":"SOFOcrQn4R"}],"key":"WlFMkwPBPX"}],"key":"ALrMIWLgSI"}],"key":"WofTVfe2J1"}],"key":"ySfmhHl2L6"},{"type":"code","lang":"python","value":"# Panda Merging and Shaping\n\nimport pandas as pd\n\n# Create sample DataFrames for demonstration\ndf1 = pd.DataFrame({\n    'ID': [1, 2, 3],\n    'Name': ['Alice', 'Bob', 'Charlie'],\n    'Age': [25, 30, 35]\n})\n\ndf2 = pd.DataFrame({\n    'ID': [2, 3, 4],\n    'City': ['New York', 'Chicago', 'Los Angeles'],\n    'Salary': [80000, 120000, 75000]\n})\n\ndf3 = pd.DataFrame({\n    'Department': ['HR', 'Finance', 'IT'],\n    'Head': ['Alice', 'David', 'Charlie']\n})\n\n# ------------------------------\n# 1. pd.merge(): Merge two DataFrames on a common column\n# ------------------------------\nprint(\"Merging df1 and df2 on 'ID':\")\nmerged_df = pd.merge(df1, df2, on='ID', how='inner')  # Inner join\nprint(merged_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 2. pd.concat(): Concatenate two DataFrames along rows or columns\n# ------------------------------\nprint(\"Concatenating df1 and df2 along rows:\")\nconcat_rows = pd.concat([df1, df2], axis=0)  # Concatenating rows\nprint(concat_rows)\nprint(\"\\n\")\n\nprint(\"Concatenating df1 and df2 along columns:\")\nconcat_columns = pd.concat([df1, df2], axis=1)  # Concatenating columns\nprint(concat_columns)\nprint(\"\\n\")\n\n# ------------------------------\n# 3. df.join(): Join two DataFrames on their index\n# ------------------------------\nprint(\"Joining df1 and df3 by index:\")\ndf1_indexed = df1.set_index('Name')\ndf3_indexed = df3.set_index('Head')\njoined_df = df1_indexed.join(df3_indexed, how='left')\nprint(joined_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 4. df.melt(): Unpivot a DataFrame from wide to long format\n# ------------------------------\nprint(\"Melting df1 to long format:\")\nmelted_df = pd.melt(df1, id_vars=['ID'], value_vars=['Name', 'Age'], var_name='Attribute', value_name='Value')\nprint(melted_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 5. df.pivot(): Pivot a DataFrame from long to wide format\n# ------------------------------\nprint(\"Pivoting melted_df back to wide format:\")\npivoted_df = melted_df.pivot(index='ID', columns='Attribute', values='Value')\nprint(pivoted_df)\nprint(\"\\n\")\n\n\n'''\nMerging df1 and df2 on 'ID':\n   ID     Name  Age      City  Salary      \n0   2      Bob   30  New York   80000      \n1   3  Charlie   35   Chicago  120000      \n\n\nConcatenating df1 and df2 along rows:      \n   ID     Name   Age         City    Salary\n0   1    Alice  25.0          NaN       NaN\n1   2      Bob  30.0          NaN       NaN\n2   3  Charlie  35.0          NaN       NaN\n0   2      NaN   NaN     New York   80000.0\n1   3      NaN   NaN      Chicago  120000.0\n2   4      NaN   NaN  Los Angeles   75000.0\n\n\nConcatenating df1 and df2 along columns:\n   ID     Name  Age  ID         City  Salary\n0   1    Alice   25   2     New York   80000\n1   2      Bob   30   3      Chicago  120000\n2   3  Charlie   35   4  Los Angeles   75000\n\n\nJoining df1 and df3 by index:\n         ID  Age Department\nName\nAlice     1   25         HR\nBob       2   30        NaN\nCharlie   3   35         IT\n\n\nMelting df1 to long format:\n   ID Attribute    Value\n0   1      Name    Alice\n1   2      Name      Bob\n2   3      Name  Charlie\n3   1       Age       25\n4   2       Age       30\n5   3       Age       35\n\n\nPivoting melted_df back to wide format:\nAttribute Age     Name\nID\n1          25    Alice\n2          30      Bob\n3          35  Charlie\n'''","position":{"start":{"line":21,"column":1},"end":{"line":141,"column":1}},"key":"KGVjc3AXjH"}],"key":"BL3lTfDSM5"}],"key":"wBilAZl2sA"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Panda Aggregation","url":"/xpanda-aggregation","group":"CSCI 127"},"next":{"title":"Panda Statistical Operations","url":"/xpanda-statistical","group":"CSCI 127"}}},"domain":"http://localhost:3004"}