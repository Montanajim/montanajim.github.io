{"version":2,"kind":"Article","sha256":"bbb47eafa85ea2527cc29baf03206a43efcc4e3d5ad7d8332fa2fa2068556941","slug":"wpref.xssdefendingagainstxss","location":"/wpref/xssDefendingAgainstXSS.md","dependencies":[],"frontmatter":{"title":"Defending Against Cross Site Scripting","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","exports":[{"format":"md","filename":"xssDefendingAgainstXSS.md","url":"CSCI210/build/xssDefendingAgainstX-ec1566dc95c3b0e1f3c2250a40d0010f.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS) is one of the most common ‚Äî and dangerous ‚Äî web security flaws. At its core, XSS happens when untrusted content makes its way into a webpage without being properly handled, letting an attacker run malicious JavaScript in another user‚Äôs browser.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"b0C9O4PUxc"}],"key":"el6BCiED2f"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The good news? A handful of defensive habits stop most XSS dead in its tracks. Below is a practical ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kI6So4WfKT"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"XSS Defense Checklist","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cF154r2oBM"}],"key":"nM84WliMgK"},{"type":"text","value":" that explains not only what to do, but why it matters.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oOESGB63KW"}],"key":"yuUSqFPLIn"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"D30qVcPIzV"},{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1. Escape Output (Context-Aware)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"EGGNGimBRr"}],"identifier":"id-1-escape-output-context-aware","label":"1. Escape Output (Context-Aware)","html_id":"id-1-escape-output-context-aware","implicit":true,"key":"oVkHq8DuAb"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZljTURF1Mc"}],"key":"wM70x0tzTW"},{"type":"text","value":" means converting potentially dangerous characters (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"gJOTOrCJeP"},{"type":"inlineCode","value":"<","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"d7cP5QPnyV"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"GxmNjatGv9"},{"type":"inlineCode","value":">","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MTm3lH52s0"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"VuNy4u28R2"},{"type":"inlineCode","value":"\"","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"DgqomJ7YAj"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jUdl5ruJHr"},{"type":"inlineCode","value":"'","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aKforjdPMz"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uX7EtGCsQj"},{"type":"inlineCode","value":"&","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nfcTGvIn2U"},{"type":"text","value":") into harmless equivalents before showing them in a web page. For example:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aoR7pNIWP4"}],"key":"HMiJOukvMF"},{"type":"code","lang":"php","value":"$name = \"<script>alert(1)</script>\";\necho htmlspecialchars($name, ENT_QUOTES, 'UTF-8');","position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"key":"OxIB7hKphs"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"This would display literally ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Pfd9yKDM59"},{"type":"inlineCode","value":"<script>alert(1)</script>","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"WQjhXjuNIl"},{"type":"text","value":" in the browser instead of executing it.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Vbz2Q4Z7Bd"}],"key":"GLqJKqU2QT"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"But here‚Äôs the subtlety: ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"TloMRI56x7"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"context matters.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"zBREgiLkZ7"}],"key":"KFeCu9xt6m"}],"key":"b0Kx3TAoIs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"HTML body content:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Gcj8dj9tWl"}],"key":"tVPs2rvOPu"},{"type":"text","value":" Use ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"SsNE4bEhns"},{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"UgNJF93Bqf"},{"type":"text","value":" in PHP or ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"MecdAgACMi"},{"type":"inlineCode","value":".textContent","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"C2MrfWEIeq"},{"type":"text","value":" in JS.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"sgneLBHjN6"}],"key":"NuIOXreVoP"}],"key":"R9p4HMfGKK"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"HTML attributes:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"NvHqeaDU7v"}],"key":"DmBq7wuwdx"},{"type":"text","value":" Make sure quotes are escaped.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"HB9aoEqnV6"}],"key":"jgH1QlhTU6"}],"key":"oS3mcnmeWH"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"JavaScript inline:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"o1lz0q0WfB"}],"key":"vhYdO4ZZGg"},{"type":"text","value":" Encode data as JSON, not raw text.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"UrvgqZPIcd"}],"key":"f0HOdY2Gap"}],"key":"O5O35WxvfF"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"CSS/URLs:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"KNNkGbfZwR"}],"key":"cKNo6znVz7"},{"type":"text","value":" Encode values or, better, disallow dynamic injection entirely.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"HnHoPMAi1S"}],"key":"MBHWFp2hWK"}],"key":"fUWGKaMAGg"}],"key":"LgXLrSDRcX"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"üëâ The key lesson: ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"jyfVWdwi32"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Escape when outputting","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"QnvSEb5IE4"}],"key":"a5toe1fSFf"},{"type":"text","value":", not when inputting. Input sanitization alone can‚Äôt predict every possible context where data will appear.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"BXj9D1FkBR"}],"key":"GzUT7TvJta"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"kWX85qeV0r"},{"type":"heading","depth":2,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"2. Validate & Sanitize Input","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ZPA6BoZv5s"}],"identifier":"id-2-validate-sanitize-input","label":"2. Validate & Sanitize Input","html_id":"id-2-validate-sanitize-input","implicit":true,"key":"UX86HbTCZI"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Validation asks: ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"vYRdrJVBuY"},{"type":"emphasis","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Is this data what I expect?","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"S0NTbcmVMi"}],"key":"AzSrxUtvDt"}],"key":"Zdyyd6q6Jq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Last name ‚Üí letters, spaces, hyphens only.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"tZu11i0two"}],"key":"YLAnni04sf"}],"key":"hF1B0tk2lL"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Email ‚Üí valid email format.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"hqzH0W1sdR"}],"key":"CQ0S0Txpg6"}],"key":"FWd2iD3110"}],"key":"zcaRXNBWGH"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Sanitization cleans unwanted bits, but it should ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"htWF8VX9XB"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"never replace escaping.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"d6G5qbNVWk"}],"key":"SyWjOvOulK"},{"type":"text","value":" Think of it as a helpful filter, not the main defense.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"OtsAr7RVHB"}],"key":"j8OFNUAyXm"},{"type":"thematicBreak","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"G6ECIrLQI5"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"3. Use Content Security Policy (CSP)","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"TW1SvWsgGz"}],"identifier":"id-3-use-content-security-policy-csp","label":"3. Use Content Security Policy (CSP)","html_id":"id-3-use-content-security-policy-csp","implicit":true,"key":"nYA8eFzPDm"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"A strong CSP header acts as a ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"Kw55MLNDKK"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"mWAx2WQ6an"}],"key":"T4Mw1jXFEV"},{"type":"text","value":":","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"WIljbQanWC"}],"key":"oFwr6mg4AB"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self'","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"key":"OrO7uccIuF"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Even if an attacker sneaks code in, CSP limits what can run. It‚Äôs not a substitute for escaping, but it reduces the blast radius of mistakes.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"ZXOenohLwD"}],"key":"h3aNAhGeEy"},{"type":"thematicBreak","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"vuJxtwTMj6"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"4. Don‚Äôt Trust JavaScript with HTML Injection","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"qgu78eeYxz"}],"identifier":"id-4-dont-trust-javascript-with-html-injection","label":"4. Don‚Äôt Trust JavaScript with HTML Injection","html_id":"id-4-dont-trust-javascript-with-html-injection","implicit":true,"key":"I2rXfxdq1H"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Tempting but dangerous:","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"FW47zfkF7E"}],"key":"jlh1fBolAv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":60,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"wdCwYECNfZ"},{"type":"inlineCode","value":"innerHTML","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"S3FziGaw8I"}],"key":"qk3ONCXwkC"}],"key":"H8QmKiSyDe"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"omqqjfGHxz"},{"type":"inlineCode","value":"document.write()","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"w2vTT6wXfC"}],"key":"Ooj3TrE8ee"}],"key":"SONh1Wr3su"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"y9IZwcwfrH"},{"type":"inlineCode","value":"$('.element').html()","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"Xdac3GV3GW"}],"key":"aFD8u42tcc"}],"key":"XHH7kwHfx1"}],"key":"JZN6P18D9v"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Safer alternatives:","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"FZ0WPxi1aR"}],"key":"EY1rzn3Qqt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":66,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"vXijhhJdmr"},{"type":"inlineCode","value":"textContent","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"qOyKOe9XSY"}],"key":"QXtL46rjMm"}],"key":"W8g831SXUo"},{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"jTsFfUYmaS"},{"type":"inlineCode","value":"createElement","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ZYWWhQPjiY"}],"key":"yAm9NotWz2"}],"key":"aV6MzqqZ9e"},{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ Framework auto-escaping (React, Vue, Angular).","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"zULh6H9iei"}],"key":"xSjH9JHmxK"}],"key":"gUirUo29il"}],"key":"cxPCxZh9Eb"},{"type":"thematicBreak","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"CJUXVODpYW"},{"type":"heading","depth":2,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"5. Use Frameworks Safely","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"qsGragjZfC"}],"identifier":"id-5-use-frameworks-safely","label":"5. Use Frameworks Safely","html_id":"id-5-use-frameworks-safely","implicit":true,"key":"zzRLzLzg8h"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Modern frameworks protect you ‚Äî until you override them.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"bHrYKH09FG"}],"key":"BlHEDswKIf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"React‚Äôs ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"BKMLTaTCpz"},{"type":"inlineCode","value":"dangerouslySetInnerHTML","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"u6VVgrA8P8"}],"key":"bLjKginVh7"}],"key":"xBf6zgJLDI"},{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vue‚Äôs ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"lUS6ijmY3F"},{"type":"inlineCode","value":"v-html","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"CgUQcnR5QE"}],"key":"v280IxwA8r"}],"key":"bxJYlbRIye"}],"key":"YZc72C2vM5"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Both are escape hatches. Use them rarely, and only with fully trusted content.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"c1oudFtnY2"}],"key":"f6DXL7hoWU"},{"type":"thematicBreak","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"gYDd9crRcw"},{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"6. Protect Your Forms","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"VtRokfMy78"}],"identifier":"id-6-protect-your-forms","label":"6. Protect Your Forms","html_id":"id-6-protect-your-forms","implicit":true,"key":"wbIp9ghPT0"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"While not directly XSS, ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"q2kFR1yzct"},{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"CSRF tokens","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"jmqERlQwMK"}],"key":"fLPHzBRQt0"},{"type":"text","value":" stop attackers from tricking users into submitting malicious forms. Since XSS and CSRF often appear together, defense in depth is key.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"WyX1dpv9BC"}],"key":"NG96y3Z7eZ"},{"type":"thematicBreak","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"yYKg5oPeBE"},{"type":"heading","depth":2,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"7. Encode on the Way Out","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"Vf9BY0FTtS"}],"identifier":"id-7-encode-on-the-way-out","label":"7. Encode on the Way Out","html_id":"id-7-encode-on-the-way-out","implicit":true,"key":"bURii4ND9D"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Escaping at input time sounds convenient ‚Äî but it‚Äôs fragile. What if the data is later used in a different context (HTML vs. JS)?","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"fIMgjEkFCM"}],"key":"CNLMV7lsN9"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Encoding ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"iBheJyixEE"},{"type":"strong","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"at output","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"K69jijCCJy"}],"key":"SCGmXfLgXz"},{"type":"text","value":" ensures the escape matches the context every time. It‚Äôs the difference between a one-size-fits-none approach and a tailored, future-proof defense.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"oM0BKJmJa3"}],"key":"VIZXUaT0vu"},{"type":"thematicBreak","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"Hgva9CkapV"},{"type":"heading","depth":2,"position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"8. Audit & Test","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"enlMIBheTU"}],"identifier":"id-8-audit-test","label":"8. Audit & Test","html_id":"id-8-audit-test","implicit":true,"key":"AFaLPupMGD"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"No defense is perfect without testing. Use:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"URJaiCbGcW"}],"key":"jgEUV8rNfU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":101,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"strong","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Automated tools:","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"MtUjrPRd2i"}],"key":"JaZGUlWnE0"},{"type":"text","value":" OWASP ZAP, Burp Suite.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"KZE2dF0Pm0"}],"key":"FAjVXNxQy2"}],"key":"vmikH6Bxo2"},{"type":"listItem","spread":true,"position":{"start":{"line":103,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"strong","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Manual payloads:","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"ORh25ox0T8"}],"key":"HMZwXSTxlj"}],"key":"G9XmqxcyDo"},{"type":"code","lang":"html","value":"<script>alert(1)</script>\n<img src=x onerror=alert(2)>\n\"><svg onload=alert(3)>","position":{"start":{"line":105,"column":1},"end":{"line":109,"column":1}},"key":"UvYRI1HhPM"}],"key":"aQysaZe8NU"}],"key":"ZeTLJrfwDZ"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"If any of these run, you‚Äôve got work to do.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"p7fo4fQCMv"}],"key":"vaXbh31WMO"},{"type":"thematicBreak","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"IpkyDHNarV"},{"type":"heading","depth":2,"position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"The Golden Rule","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"wt0Hwf6Tcz"}],"identifier":"the-golden-rule","label":"The Golden Rule","html_id":"the-golden-rule","implicit":true,"key":"roJ6eQdbeJ"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"strong","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Treat all user input as hostile. Escape it when you output it.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"RjmneUcKGj"}],"key":"xt3NIwPWoC"},{"type":"text","value":"\nDo that, and you‚Äôll block 90% of XSS attempts before they ever start.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"Hzetypc7FO"}],"key":"IwfuNaArRU"},{"type":"thematicBreak","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"d7H44Eohlz"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Escaping is your first line of defense. Validation, CSP, and safer coding practices are the reinforcements. Together, they form a layered security strategy that keeps both your applications and your users safe.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"zJDDEYPqXj"}],"key":"pLmi2CwOLb"}],"key":"wNJ6rBzYOG"},{"type":"thematicBreak","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"ameZxzVIVN"},{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"RVXro7GLPh"}],"identifier":"id-10-2025","label":"10/2025","html_id":"id-10-2025","implicit":true,"key":"bH30aDuOXt"}],"key":"IHjkxgYf3i"}],"key":"xeAwYgxsfY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"String Sanitation - filter_var()","url":"/wpref/stringsanitation","group":"Web Programming"},"next":{"title":"XSS Examples","url":"/wpref/xssexamples","group":"Web Programming"}}},"domain":"http://localhost:3001"}