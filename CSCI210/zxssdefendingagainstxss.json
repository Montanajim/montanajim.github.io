{"version":2,"kind":"Article","sha256":"bbb47eafa85ea2527cc29baf03206a43efcc4e3d5ad7d8332fa2fa2068556941","slug":"zxssdefendingagainstxss","location":"/zxssDefendingAgainstXSS.md","dependencies":[],"frontmatter":{"title":"Defending Against Cross Site Scripting","content_includes_title":false,"exports":[{"format":"md","filename":"zxssDefendingAgainstXSS.md","url":"/CSCI210/build/zxssDefendingAgainst-df5d06ff12c03d47b1a70665a1851982.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS) is one of the most common ‚Äî and dangerous ‚Äî web security flaws. At its core, XSS happens when untrusted content makes its way into a webpage without being properly handled, letting an attacker run malicious JavaScript in another user‚Äôs browser.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tjY8Hgs5BV"}],"key":"BozxX2F6YB"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The good news? A handful of defensive habits stop most XSS dead in its tracks. Below is a practical ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VD5EUxfwD9"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"XSS Defense Checklist","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nj1nfJuwKX"}],"key":"ds3VSEUs3o"},{"type":"text","value":" that explains not only what to do, but why it matters.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JA2vPxTTBc"}],"key":"gcqeugsSSu"},{"type":"thematicBreak","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IaPnnBpZ0q"},{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1. Escape Output (Context-Aware)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"k087wxOUrs"}],"identifier":"id-1-escape-output-context-aware","label":"1. Escape Output (Context-Aware)","html_id":"id-1-escape-output-context-aware","implicit":true,"key":"OWSuh4YALp"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KjGVkpimOf"}],"key":"mWA2FnI5Ip"},{"type":"text","value":" means converting potentially dangerous characters (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wlDzSnc72l"},{"type":"inlineCode","value":"<","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fYL4iieWlM"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tAqkYqi8Hy"},{"type":"inlineCode","value":">","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"P0mFNf3dJ2"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ipFPjJJdB2"},{"type":"inlineCode","value":"\"","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cZmWkMspWf"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Ecjdmenv6e"},{"type":"inlineCode","value":"'","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MjjaIx55QB"},{"type":"text","value":", ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"skassWQTsE"},{"type":"inlineCode","value":"&","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wl035w3yjA"},{"type":"text","value":") into harmless equivalents before showing them in a web page. For example:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lXUdUi4C7F"}],"key":"OGJBJc5tfv"},{"type":"code","lang":"php","value":"$name = \"<script>alert(1)</script>\";\necho htmlspecialchars($name, ENT_QUOTES, 'UTF-8');","position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"key":"dAdEjlMU4U"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"This would display literally ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"UslciuM9Om"},{"type":"inlineCode","value":"<script>alert(1)</script>","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"rdW3vJ8UU4"},{"type":"text","value":" in the browser instead of executing it.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"MPbK58ZhhV"}],"key":"qCqIyncSfu"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"But here‚Äôs the subtlety: ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"c58cNNala1"},{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"context matters.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ftDuI2H22K"}],"key":"ourENolTDP"}],"key":"cQrqgDt70f"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"HTML body content:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"FaFsSvrRPg"}],"key":"K3sHVG0stV"},{"type":"text","value":" Use ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"iQlWumDaLL"},{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ZAtLI6JYHf"},{"type":"text","value":" in PHP or ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"akPWIiMDN4"},{"type":"inlineCode","value":".textContent","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ZjAowNQ9YN"},{"type":"text","value":" in JS.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"zn0cMWFSbw"}],"key":"TvXporoUg3"}],"key":"kFQoJ1uq3M"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"HTML attributes:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"HbpLvLPhpW"}],"key":"z28PlwNWcU"},{"type":"text","value":" Make sure quotes are escaped.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"BNwdF4w9ZF"}],"key":"KzgGPdg9Cw"}],"key":"oCG4tOlAjj"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"JavaScript inline:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"mGSbQXLJd0"}],"key":"wm2uJNA0YL"},{"type":"text","value":" Encode data as JSON, not raw text.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"mmY2NoodWx"}],"key":"p79nWD8RMJ"}],"key":"nffh0txYWa"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"CSS/URLs:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"I8lYlu9n9T"}],"key":"x9bwFamqaT"},{"type":"text","value":" Encode values or, better, disallow dynamic injection entirely.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"bdaW0xpkrh"}],"key":"wZEwwRLcHn"}],"key":"VMtkBBx5rM"}],"key":"FhGTomCanR"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"üëâ The key lesson: ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"opQMPdtOac"},{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Escape when outputting","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"UfCjy9xgqe"}],"key":"XbuUtXXt82"},{"type":"text","value":", not when inputting. Input sanitization alone can‚Äôt predict every possible context where data will appear.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZKFNjj9jv1"}],"key":"mmltPFtTU8"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"IqWNsdGRXd"},{"type":"heading","depth":2,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"2. Validate & Sanitize Input","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Ll7vTBJLkz"}],"identifier":"id-2-validate-sanitize-input","label":"2. Validate & Sanitize Input","html_id":"id-2-validate-sanitize-input","implicit":true,"key":"XlCtoY6Lfe"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Validation asks: ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"jDfE0y9IE5"},{"type":"emphasis","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Is this data what I expect?","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"rac5YNEbm1"}],"key":"Hz7z0LmLzl"}],"key":"uje5SVxtng"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Last name ‚Üí letters, spaces, hyphens only.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"qRtrIqKRth"}],"key":"dS0Nn0muLn"}],"key":"TReXGuB7qL"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Email ‚Üí valid email format.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"tsNVhpPW6z"}],"key":"AZuNfEfhFy"}],"key":"qvClWXgCPb"}],"key":"SMVLLFXJhB"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Sanitization cleans unwanted bits, but it should ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"HKCq7jlr5X"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"never replace escaping.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"e7Nf8yYXNT"}],"key":"z2f3M9GXWG"},{"type":"text","value":" Think of it as a helpful filter, not the main defense.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"la2eo2LoLv"}],"key":"Y17JuPB4gN"},{"type":"thematicBreak","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"ntaK9w2P4Y"},{"type":"heading","depth":2,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"3. Use Content Security Policy (CSP)","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"uTsSAs3jaU"}],"identifier":"id-3-use-content-security-policy-csp","label":"3. Use Content Security Policy (CSP)","html_id":"id-3-use-content-security-policy-csp","implicit":true,"key":"SQV9p5mbYq"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"A strong CSP header acts as a ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"g9mO1LqPrm"},{"type":"strong","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"Hhhfwlb8ts"}],"key":"BZS6hPN0jT"},{"type":"text","value":":","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"TjOJH18edP"}],"key":"EAtu3E6AyE"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self'","position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"key":"giWT25qa6J"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Even if an attacker sneaks code in, CSP limits what can run. It‚Äôs not a substitute for escaping, but it reduces the blast radius of mistakes.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"pYqkmbx22o"}],"key":"l2esuWuZS4"},{"type":"thematicBreak","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"Z5NEgWNSBH"},{"type":"heading","depth":2,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"4. Don‚Äôt Trust JavaScript with HTML Injection","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"xmxJWEqWEU"}],"identifier":"id-4-dont-trust-javascript-with-html-injection","label":"4. Don‚Äôt Trust JavaScript with HTML Injection","html_id":"id-4-dont-trust-javascript-with-html-injection","implicit":true,"key":"DCEyOwGipu"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Tempting but dangerous:","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Qec0vmIcUy"}],"key":"pbNKSegKm0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":60,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"YRwNNa730t"},{"type":"inlineCode","value":"innerHTML","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"A68qSJvJL5"}],"key":"rr6bL5YxrN"}],"key":"Kt0totymFY"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"wNzT5gqRNA"},{"type":"inlineCode","value":"document.write()","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"pWLkiffV6m"}],"key":"BCTNb2ctQ8"}],"key":"wHxEjRYzSr"},{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"tcUaEDZuG5"},{"type":"inlineCode","value":"$('.element').html()","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"DnrQ5MZ9DJ"}],"key":"lsxbXaiZPj"}],"key":"BqSuaniHaR"}],"key":"IyU7UiPU6H"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Safer alternatives:","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"KtrXcXjG1j"}],"key":"HXfu9HBiRX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":66,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"XHwfrf97tk"},{"type":"inlineCode","value":"textContent","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"eqjhiGNj5y"}],"key":"JWrTVkPj7Q"}],"key":"d6j9hSnnGB"},{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"IGHGC9bLNG"},{"type":"inlineCode","value":"createElement","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"kNMV3t2iW6"}],"key":"WLx4dceNbP"}],"key":"E8avc8xoTd"},{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ Framework auto-escaping (React, Vue, Angular).","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"zsaac3rA0x"}],"key":"lw09wVqSoc"}],"key":"oN1xsAVztf"}],"key":"bZUfMFTwAV"},{"type":"thematicBreak","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"kN2GovdgCn"},{"type":"heading","depth":2,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"5. Use Frameworks Safely","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"X0E2jkk0Tx"}],"identifier":"id-5-use-frameworks-safely","label":"5. Use Frameworks Safely","html_id":"id-5-use-frameworks-safely","implicit":true,"key":"vjNIcrhW4b"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Modern frameworks protect you ‚Äî until you override them.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"zoIWaHxNu9"}],"key":"BfWrV0AayR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"React‚Äôs ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"DeDGu6L8J6"},{"type":"inlineCode","value":"dangerouslySetInnerHTML","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"xCAgL5AqQ2"}],"key":"dbBrgZaWcA"}],"key":"sC2OdSyk1u"},{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vue‚Äôs ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"A5egFuWVGU"},{"type":"inlineCode","value":"v-html","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"mhPWpTrGYn"}],"key":"iHQL7JoDry"}],"key":"GGcQ2SOHAw"}],"key":"qvCNcfWYTj"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Both are escape hatches. Use them rarely, and only with fully trusted content.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"IEJHxoRls7"}],"key":"zUY9TNYuI4"},{"type":"thematicBreak","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"aZopicQwep"},{"type":"heading","depth":2,"position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"6. Protect Your Forms","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"A4goot2JmQ"}],"identifier":"id-6-protect-your-forms","label":"6. Protect Your Forms","html_id":"id-6-protect-your-forms","implicit":true,"key":"BlAxO7I3Qc"},{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"While not directly XSS, ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"d0MgiwwcjP"},{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"CSRF tokens","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"RiI3FgHZL7"}],"key":"A7mXos4gCr"},{"type":"text","value":" stop attackers from tricking users into submitting malicious forms. Since XSS and CSRF often appear together, defense in depth is key.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"zCivUDaHpf"}],"key":"sYtk2qqAql"},{"type":"thematicBreak","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"E6jfjx0vzr"},{"type":"heading","depth":2,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"7. Encode on the Way Out","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"aGG5wXC0jV"}],"identifier":"id-7-encode-on-the-way-out","label":"7. Encode on the Way Out","html_id":"id-7-encode-on-the-way-out","implicit":true,"key":"iIMQf1Wkuo"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Escaping at input time sounds convenient ‚Äî but it‚Äôs fragile. What if the data is later used in a different context (HTML vs. JS)?","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"VuutWj5f0B"}],"key":"eCKNppFxVR"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Encoding ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"nWoFH7uMkR"},{"type":"strong","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"at output","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"s7UBHwxYwO"}],"key":"qHHuYmM0C5"},{"type":"text","value":" ensures the escape matches the context every time. It‚Äôs the difference between a one-size-fits-none approach and a tailored, future-proof defense.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"Rr8hDcRnCw"}],"key":"O9GqgZ96pk"},{"type":"thematicBreak","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"RDjaBdp6Ix"},{"type":"heading","depth":2,"position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"8. Audit & Test","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"EpeoNon2Zf"}],"identifier":"id-8-audit-test","label":"8. Audit & Test","html_id":"id-8-audit-test","implicit":true,"key":"HKbGOhTkgd"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"No defense is perfect without testing. Use:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"kuTKiRGfoB"}],"key":"X4nrWvtLFN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":101,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"strong","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Automated tools:","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Uy9OdNYjU3"}],"key":"gEFGg7UOsm"},{"type":"text","value":" OWASP ZAP, Burp Suite.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"l2GQsgGzR6"}],"key":"nE0oDqq59L"}],"key":"jn1ORNAsWE"},{"type":"listItem","spread":true,"position":{"start":{"line":103,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"strong","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Manual payloads:","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"jwlsARMELx"}],"key":"W9AAOgoA4P"}],"key":"sizhYqmRfW"},{"type":"code","lang":"html","value":"<script>alert(1)</script>\n<img src=x onerror=alert(2)>\n\"><svg onload=alert(3)>","position":{"start":{"line":105,"column":1},"end":{"line":109,"column":1}},"key":"Zw9T4sH9HS"}],"key":"pxCJYsDWxh"}],"key":"M1op6PsP2Y"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"If any of these run, you‚Äôve got work to do.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"Uz7qf10TE1"}],"key":"stCRIm4w1h"},{"type":"thematicBreak","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"NQmosvEyM3"},{"type":"heading","depth":2,"position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"The Golden Rule","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"dEygXwwvo3"}],"identifier":"the-golden-rule","label":"The Golden Rule","html_id":"the-golden-rule","implicit":true,"key":"ZSMMZnQS8r"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"strong","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Treat all user input as hostile. Escape it when you output it.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"dtHMZfYEDy"}],"key":"G3RrrakzRi"},{"type":"text","value":"\nDo that, and you‚Äôll block 90% of XSS attempts before they ever start.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"HgPVVDrDTr"}],"key":"FoIe7Zqw2X"},{"type":"thematicBreak","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"TWcM0A98AK"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Escaping is your first line of defense. Validation, CSP, and safer coding practices are the reinforcements. Together, they form a layered security strategy that keeps both your applications and your users safe.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"btWxkphp3i"}],"key":"KID8vBSigR"}],"key":"ZtZ3AbcgKP"},{"type":"thematicBreak","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"WKvSE79RLl"},{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"tWzdjUQuCA"}],"identifier":"id-10-2025","label":"10/2025","html_id":"id-10-2025","implicit":true,"key":"sw6ERk0bA7"}],"key":"hsow5Spw8L"}],"key":"piHt5ixbIf"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Content Security Policy","url":"/zxsscontentsecuritypolicy","group":"Add Edit Delete"},"next":{"title":"XSS Examples","url":"/zxssexamples","group":"Add Edit Delete"}}},"domain":"http://localhost:3003"}