{"version":2,"kind":"Article","sha256":"627e0c2a48ad0c3f8fa4c2afaa2aef7d263641b45b5983b0655f5d321a744609","slug":"zpdofirstdatadbinsertcarexample","location":"/zPDOFirstDataDBInsertCarExample.md","dependencies":[],"frontmatter":{"title":"PDO - First Data Insert - Car Example","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbookdocmov\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"zPDOFirstDataDBInsertCarExample.md","url":"CSCI210/build/zPDOFirstDataDBInser-ff2c08ed9b46f108d9feb82f8ecb7c99.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Key Ideas","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"R1ObPfq1Zp"}],"identifier":"key-ideas","label":"Key Ideas","html_id":"key-ideas","implicit":true,"key":"BD9Kts9m7E"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Five Steps Of Inserting Data","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"NH7c655dwv"}],"identifier":"five-steps-of-inserting-data","label":"Five Steps Of Inserting Data","html_id":"five-steps-of-inserting-data","implicit":true,"key":"ubg2iUyutT"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create the the insert SQL statement with placeholders (“:”).","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ivmNkx01Lh"}],"key":"yv12cldHTj"}],"key":"EGwzbuUaAZ"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prepare the SQL statement.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pRHX0IHgF8"}],"key":"qsKBrrHgul"}],"key":"YSD2T8peqy"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Save the $_POST data to variables while sanitizing it.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ngfwnnwf68"}],"key":"HxPdy4VkIF"}],"key":"FIaaFTz3nQ"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bind the placeholders with the variables of step 3.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"kgLvkqWoC3"}],"key":"nQCBe4IDsI"}],"key":"t5l97davR2"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Execute the SQL statement.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"pkfWBFSXB1"}],"key":"gXCGFKxGQh"}],"key":"AX1c2Cp52t"}],"key":"HgmzbltBsb"},{"type":"heading","depth":2,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Connection String","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"FwYm3YN5LH"}],"identifier":"connection-string","label":"Connection String","html_id":"connection-string","implicit":true,"key":"US8iQXOmxb"},{"type":"blockquote","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"A database connection string is a string that contains the information needed to connect an application to a database. The string includes parameters such as -  Server instance, Database name, Authentication details, Username, Password .","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QHN0EBfEG1"}],"key":"ZNbHDMtarb"}],"key":"ddW1TozIAR"},{"type":"heading","depth":2,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"dbconnect.php","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"JLtgLo6Bqv"}],"identifier":"dbconnect-php","label":"dbconnect.php","html_id":"dbconnect-php","implicit":true,"key":"j7fjESzL9Y"},{"type":"code","lang":"php","value":"<!--  dbconnect.php --->\n<?php\n/*\n-- Database - SQL Script\nDROP DATABASE IF EXISTS wp_cars;\n\n-- CREATE DATABASE\nCREATE DATABASE IF NOT EXISTS wp_cars;\n\n-- Use Database\nUSE wp_cars;\n\nCREATE TABLE `wp_cars`.`tbl_car`(\n    `OwnerFN` VARCHAR(20),\n    `OwnerLN` VARCHAR(20),\n    `Make` VARCHAR(20),\n    `Model` VARCHAR(20),\n    `Color` VARCHAR(20),\n    `CarYear` CHAR(4),\n    `Car_Id` INT(6) NOT NULL AUTO_INCREMENT,\n    PRIMARY KEY(`Car_Id`)\n) ENGINE = InnoDB;\n\n\n*/\n\n//connect database\ntry\n{\n\t$pdo = new PDO('mysql:host=127.0.0.1;dbname=wp_cars','root','');\n\t$pdo->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION);\n\n\t//only educational purposes\n\t$dbstatus = \"Good database connection\";\n\n}\ncatch(PDOException $e)\n{\n\t$dbstatus = \"Database connection failed<br>\".\n\t\t\t\t$e->getMessage();\n\n\tdie();\n}\nSESSION_START();\n\n?>\n","position":{"start":{"line":27,"column":1},"end":{"line":75,"column":1}},"key":"LizKZNpVBH"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"default.php","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"XxhnrPxjEb"}],"identifier":"default-php","label":"default.php","html_id":"default-php","implicit":true,"key":"HBWMYEiAy9"},{"type":"code","lang":"php","value":"<?php\n// page3.php\n\n// require - all or nothing - will not tolerate an error\n// include - will still try to run if there is an error\n\nrequire('dbconnect.php');\n\n// educational purposes / development purposes\necho($dbstatus.\"<br><hr><br>\");\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n\t<title>Page 1</title>\n\t<style>\n        .divpage1 {\n          width: 50%;\t\n          background-color:cornsilk;\n          margin-left: auto;\n          margin-right: auto;\n        } \n\t</style>\n</head>\n<body>\n<div class=\"divpage1\">     \n\n<?php\n\nfunction sanitize($value){\n\n    // strip of any excess white spaces on the ends\n    $value = trim($value);\n\n    // get rid of any html or php tags\n    $value = strip_tags($value);\n\n    // convert special characters\n    $value = htmlspecialchars($value,ENT_QUOTES,'UTF-8');\n\n    // return the value\n    return $value;\n\n}\n\n// alternative\nfunction sanitize2($value){\n    return htmlspecialchars(strip_tags(trim($value)),ENT_QUOTES,'UTF-8');\n}\n        \n        \nif(!isset($_POST['OwnerFN']))\n{\n    echo('\n\t\t<h1>Car Entry - form uses named place holders</h1>\n        <form method=\"POST\" action=\"default.php\">\n        <table border=\"1\">\n            <tr>\n                <td>First Name</td>\n                <td><input type=\"text\" width=\"20\" name=\"OwnerFN\"\n        required value=\"John\"></td>\n            </tr>\n\n            <tr>\n                <td>Last Name</td>\n                <td><input type=\"text\" width=\"20\" name=\"OwnerLN\"\n        value=\"Doe\"></td>\n            </tr>\n\n            <tr>\n                <td>Make</td>\n                <td><input type=\"text\" width=\"20\" name=\"Make\"\n        value=\"Ford\"></td>\n            </tr>\n\n            <tr>\n                <td>Model</td>\n                <td><input type=\"text\" width=\"20\" name=\"Model\"\n        value=\"F150\"></td>\n            </tr>\n\n            <tr>\n                <td>Year</td>\n                <td><input type=\"text\" width=\"20\" name=\"Year\"\n        value=\"1970\"></td>\n            </tr>\n\n            <tr>\n                <td>Color</td>\n                <td><input type=\"text\" width=\"20\" name=\"Color\"\n        value=\"Red\"></td>\n            </tr>\n\n            <tr>\n                <td></td>\n                <td><input type=\"submit\" value=\"Enter\"></td>\n            </tr>\n\n        </table>\n        </form>\n    ');\n\n    }\n    else\n    {\n\n        try\n        {\n        \n            \n            \n        //Step 1 - create sql statement\n\n        $sql_insert = \"INSERT INTO tbl_car\"\n                .\"(OwnerFN,OwnerLN,Make,Model,CarYear,Color) \"\n                .\"VALUES(:OwnerFN,:OwnerLN,:Make,:Model,:Year,:Color)\";\n\n        //Step 2 - prepare our sql statement\n        //This will box our information at the \":\" placeholders\n\n        $sqlp_insert = $pdo->prepare($sql_insert);\n\n\n        //Step 3 - Sanitize the information - this prevents SQL Injection\n\n        $OwnerFN = sanitize($_POST['OwnerFN'] ?? '');\n        $OwnerLN = sanitize($_POST['OwnerLN'] ?? ''G);\n        $Make = sanitize($_POST['Make'] ?? '');\n        $Model = sanitize($_POST['Model'] ?? '');\n        $Year = sanitize($_POST['Year'] ?? '');\n        $Color = sanitize($_POST['Color'] ?? '');\n\n        //Step 4 - bind our boxes in the sql statement with our variables\n        //bind parameters\n        $sqlp_insert->bindparam(\":OwnerFN\",$OwnerFN);\n        $sqlp_insert->bindparam(\":OwnerLN\",$OwnerLN);\n        $sqlp_insert->bindparam(\":Make\",$Make);\n        $sqlp_insert->bindparam(\":Model\",$Model);\n        $sqlp_insert->bindparam(\":Year\",$Year);\n        $sqlp_insert->bindparam(\":Color\",$Color);\n\n\n        //Step 5 - Execute the query\n        $sqlp_insert->execute();\n\n        echo(\"<br>### input was successful ###<br><br><hr><br>\");\n\n        //-------------------------------------------------\n\n\n        //Display our last car entered\n\n        $sql_selectLastCar = \t\"SELECT * \" .\n                        \"FROM tbl_car \" .\n                        \"WHERE Car_Id = (SELECT MAX(Car_Id) \".\n        \"FROM tbl_car )\";\n\n        //Run the Query\n        $dataSet = $pdo->query($sql_selectLastCar);\n\n        //loop through the columns in the row\n        foreach($dataSet as $row)\n        {\n        echo($row['OwnerFN'].\" \".$row['OwnerLN'].\"<br>\");\n        echo($row['Make'].\" \".$row['Model'].\" \".$row['CarYear'].\"<br>\");\n        echo($row['Color'].\" \".$row['Car_Id'].\"<br><hr><br>\");\n        }\n\n        //need to clear the $_POST because of the isset in if statement\n        unset($_POST['OwnerFN']);\n    }\n    catch(PDOException $e)\n    {\n        echo(\"**** Input Error ****<br>\".$e);\n    }\n\n    //add a button so we can add another car\n    echo('<a href=\"default.php\"><button type=\"button\">'.\n    'Add Another Car</button>');\n\n}\n?>\n<br><hr><br>\n    <br><a href=\"default.php\"><button type=\"button\">Home</button></a>&nbsp;&nbsp;\n    <a href=\"page2.php\"><button type=\"button\">Page 2</button></a>&nbsp;&nbsp;\n    <a href=\"page3.php\"><button type=\"button\">Page 3</button></a>&nbsp;&nbsp;\n<br><br><br>\n</div>\n</body>\n</html>","position":{"start":{"line":81,"column":1},"end":{"line":273,"column":1}},"key":"FvmhfTkBSB"},{"type":"heading","depth":2,"position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"Page2.php","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"LNaxPWGRmA"}],"identifier":"page2-php","label":"Page2.php","html_id":"page2-php","implicit":true,"key":"ykMZE3holw"},{"type":"code","lang":"php","value":"<?php\n\t// page2.php\n\trequire('dbconnect.php');\n?>\n<!DOCTYPE html>\n<html>\n<head>\n\t<title>Inventory</title>\n\t<style>\n        #div1 {\n          width: 75%;\t\n          background-color:cornsilk;\n          margin-left: auto;\n          margin-right: auto;\n        } \n\t</style>\n</head>\n<body>\n<div id=\"div1\">\n\t<H1>Car Inventory</H1>\n\n\t<table align=\"center\" border=\"1\">\n\t<tr>\n\t\t<td>First Name</td>\n\t\t<td>Last Name</td>\n\t\t<td>Make</td>\n\t\t<td>Model</td>\n\t\t<td>Year</td>\n\t\t<td>Color</td>\n\t\t<td>Car_Id</td>\n\t</tr>\n\t<?php\n\t\t$sql = \"SELECT * FROM tbl_car\";\n\t\t$ds = $pdo->query($sql);\n\n\t\tforeach($ds as $row)\n\t\t{\t\t\n\t\t\techo('<tr>');\n\t\t\techo('\n\t\t\t\t<td>'.$row['OwnerFN'].'</td>\n\t\t\t\t<td>'.$row['OwnerLN'].'</td>\n\t\t\t\t<td>'.$row['Make'].'</td>\n\t\t\t\t<td>'.$row['Model'].'</td>\n\t\t\t\t<td>'.$row['CarYear'].'</td>\n\t\t\t\t<td>'.$row['Color'].'</td>\n\t\t\t\t<td>'.$row['Car_Id'].'</td>\n\t\t\t\t');\n\t\t\techo('</tr>');\n}\n\t?>\n\t</table>\n\n\n<br><hr><br>\n    <br><a href=\"default.php\"><button type=\"button\">Home</button></a>&nbsp;&nbsp;\n    <a href=\"page2.php\"><button type=\"button\">Page 2</button></a>&nbsp;&nbsp;\n    <a href=\"page3.php\"><button type=\"button\">Page 3</button></a>&nbsp;&nbsp;\n<br><br><br>\n</div>\n</body>\n</html>\n","position":{"start":{"line":279,"column":1},"end":{"line":342,"column":1}},"key":"yoUEbvDBqQ"},{"type":"code","lang":"php","value":"<?php\n// page3.php\n\n// require - all or nothing - will not tolerate an error\n// include - will still try to run if there is an error\n\nrequire('dbconnect.php');\n\n// educational purposes / development purposes\necho($dbstatus.\"<br><hr><br>\");\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n\t<title>Page 3</title>\n\t<style>\n        .divpage3 {\n          width: 75%;\t\n          background-color:cornsilk;\n          margin-left: auto;\n          margin-right: auto;\n        } \n\t</style>\n</head>\n<body>\n<div class=\"divpage3\">      \n<?php\n  \nif(!isset($_POST['OwnerFN']))\n{\n    echo('\n    <h1>Car Entry - form uses ? for place holders</h1>\n    <form method=\"POST\" action=\"page3.php\">\n    <table border=\"1\" align=\"center\">\n        <tr>\n            <td>First Name</td>\n            <td><input type=\"text\" width=\"20\" name=\"OwnerFN\" required value=\"Roger\"></td>\n        </tr>\n        <tr>\n            <td>Last Name</td>\n            <td><input type=\"text\" width=\"20\" name=\"OwnerLN\" value=\"Smith\"></td>\n        </tr>\n        <tr>\n            <td>Make</td>\n            <td><input type=\"text\" width=\"20\" name=\"Make\" required value=\"AMC\"></td>\n        </tr>\n        <tr>\n            <td>Model</td>\n            <td><input type=\"text\" width=\"20\" name=\"Model\" required value=\"Gremlin\"></td>\n        </tr>\n        <tr>\n            <td>Year</td>\n            <td><input type=\"text\" width=\"20\" name=\"CarYear\" required value=\"1970\"></td>\n        </tr>\n        <tr>\n            <td>Color</td>\n            <td><input type=\"text\" width=\"20\" name=\"Color\" required value=\"Green\"></td>\n        </tr>\n        <tr>\n            <td></td>\n            <td><input type=\"submit\" value=\"Enter\"></td>\n        </tr>\n    </table>\n    </form>\n    ');\n\n}\nelse\n{\n    echo('');\n\tprint_r($_POST);\n\techo(\"<br><hr><br>\");\n\ttry\n\t{\n\t//Step 1 - create sql statement\n\t$sql_Insert =  \t\"INSERT INTO tbl_car\".\n\t\t\t\t\"(OwnerFN,OwnerLN,Make,Model,CarYear,Color) \".\n\t\t\t\t\"VALUES(?,?,?,?,?,?)\";\n\n\t//Step2 - prepare our sql statement\n\t//This will box our information at the \":\" placeholders\n\n\t$sql_Insert =  $pdo->prepare($sql_Insert);\n\n\n\t//Step 3 - Sanitize the information\n\t// use filter_var\n\t$OwnerFN = filter_var($_POST['OwnerFN'],FILTER_SANITIZE_STRING);\n\t$OwnerLN = filter_var($_POST['OwnerLN'],FILTER_SANITIZE_STRING);\n\t$Make = filter_var($_POST['Make'],FILTER_SANITIZE_STRING);\n\t$Model = filter_var($_POST['Model'],FILTER_SANITIZE_STRING);\n\t$CarYear = filter_var($_POST['CarYear'],FILTER_SANITIZE_STRING);\n\t$Color = filter_var($_POST['Color'],FILTER_SANITIZE_STRING);\n\n\n\n\t//Step 4 - Bind our placeholders to our clean variables\n\n\t// \n\t// $sql_Insert->bindparam(1,$OwnerFN);\n\t// $sql_Insert->bindparam(2,$OwnerLN);\n\t// $sql_Insert->bindparam(3,$Make);\n\t// $sql_Insert->bindparam(4,$Model);\n\t// $sql_Insert->bindparam(5,$CarYear);\n\t// $sql_Insert->bindparam(6,$Color);\n\t\n\t$data = array($_POST['OwnerFN'],\n\t\t\t\t$_POST['OwnerLN'],\n\t\t\t\t$_POST['Make'],\n\t\t\t\t$_POST['Model'],\n\t\t\t\t$_POST['CarYear'],\n\t\t\t\t$_POST['Color'],);\n\t\n\t$data = array($OwnerFN,$OwnerLN,$Make,$Model,$CarYear,$Color);\n\t\n\n\t//Step 5 - Execute the SQL Statement\n\t$sql_Insert->execute($data);\n\t//$sql_Insert->execute();\n\techo(\"<br>### input was successful # # # <br><hr><br>\");\n\n\t// ---------------------------------------------\n\n\t$sql_SelectLastCar = \t\n        \t\t\t\"SELECT * \".\n\t\t\t\t\t\"FROM tbl_car \".\n\t\t\t\t\t\"WHERE Car_Id = \".\n\t\t\t\t\t\"(SELECT MAX(Car_Id) FROM tbl_car) \";\n\n\t// run the query\n\t$dataSet = $pdo->query($sql_SelectLastCar);\n\n\t// loop the columns\n\tforeach($dataSet as $row)\n\t{\n\techo($row['OwnerFN'].\" \".$row['OwnerLN'].\"<br>\");\n\techo($row['Make'].\" \".$row['Model'].\" \".$row['CarYear'].\"<br>\");\n\techo($row['Color'].\" \".$row['Car_Id'].\"<br>\");\n\t}\n\n\t//-----------------------------------------------\n\n\tunset($_POST);\n\n\t}\n\tcatch(PDOExcept $eio)\n\t{\n\t\techo(\"**** Input Error<br>\".$eio);\n\t}\n\t\n\t// add a button\n\techo('<a href=\"default.php\"><button type=\"button\">'.\n'Add Another Car</button></a>');\n\n\n}\n?>\n<br><hr><br>\n    <br><a href=\"default.php\"><button type=\"button\">Home</button></a>&nbsp;&nbsp;\n    <a href=\"page2.php\"><button type=\"button\">Page 2</button></a>&nbsp;&nbsp;\n    <a href=\"page3.php\"><button type=\"button\">Page 3</button></a>&nbsp;&nbsp;\n<br><br><br>\n</div>\n</body>\n</html>","position":{"start":{"line":346,"column":1},"end":{"line":513,"column":1}},"key":"C4Q2hZs1jY"},{"type":"paragraph","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"key":"xDZ2FtTmB6"}],"key":"V44UgPcYE6"}],"key":"M6IxTtBEVu"}],"key":"LsooKvOvku"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"PHP Closing Tags: Leave Them Out Or Out","url":"/zphpclosingtags","group":"Web Programming"},"next":{"title":"PDO With No Named Placeholders","url":"/zpdonoplaceholdersexample","group":"Web Programming"}}},"domain":"http://localhost:3000"}