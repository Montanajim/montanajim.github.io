{"version":2,"kind":"Article","sha256":"f4691d2f29d65dc97fed15efe85f83004b1c976404fbb9167a5491fcec0cf73d","slug":"wpref.xsscontentsecuritypolicy","location":"/wpref/xssContentSecurityPolicy.md","dependencies":[],"frontmatter":{"title":"Content Security Policy","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xssContentSecurityPolicy.md","url":"/CSCI210//build/xssContentSecurityPo-9d9c07e2dc0b8af1b28979f40537f04b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Browser’s Bodyguard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yqHvKOSAf8"}],"key":"J9A2RMhQbE"}],"identifier":"the-browsers-bodyguard","label":"The Browser’s Bodyguard","html_id":"the-browsers-bodyguard","implicit":true,"key":"w6vTbV8bfg"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the constant duel between security and convenience, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ddBfykOADG"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"N4kegU8jgq"}],"key":"aET5cYTAsg"},{"type":"text","value":" remains a classic ambush. Developers defend their web pages with careful ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FA0fcuDUkb"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"escaping","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sbf9wtXgjj"}],"key":"pAQAFsQEiw"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MfGd8sm9l8"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"validation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fix1hSkBIs"}],"key":"ihPIf3NUVA"},{"type":"text","value":", but even the best code occasionally slips. That’s where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uQEseiLMwP"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Content Security Policy (CSP)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RC7s4U1Fhw"}],"key":"iroMY8Js5L"},{"type":"text","value":" steps in — not as a replacement, but as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SGQtjPG9Rh"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"complementary layer of armor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A1e7LMjyc6"}],"key":"IcI6K3cJfc"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uaH6QvtSCc"}],"key":"BQ9IOCPOxs"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ON2N6vKx1a"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. What is Content Security Policy (CSP)?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TgHANx9mPy"}],"key":"sB8lKFlHBK"}],"identifier":"id-1-what-is-content-security-policy-csp","label":"1. What is Content Security Policy (CSP)?","html_id":"id-1-what-is-content-security-policy-csp","implicit":true,"key":"pziCT2GRiL"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"f34tpEKG4a"}],"key":"u5Ehe0ODtp"},{"type":"text","value":" is an HTTP response header that acts as a browser-enforced whitelist. It tells the browser ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GrTENuuJfV"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gDnZdE4DiF"}],"key":"Lhxdcsn0zM"},{"type":"text","value":" which sources of scripts, styles, images, fonts, and frames are trusted — and blocks everything else.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jUV0oYlAUk"}],"key":"bZle4FdYui"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In essence, CSP transforms the browser from a passive renderer into an active security guard.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hbsNy4EYW9"}],"key":"ub6PqjiBoH"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kXJUT5pIXG"}],"key":"idkSe8DvEX"}],"key":"t8Xc7MzOGe"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"mkCakkrYpS"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"This directive means:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"kG3MzLbp2s"}],"key":"rBqRBqZ9ky"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All content must come from the same origin (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"PKUggmZ2il"},{"type":"inlineCode","value":"'self'","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"wRWvbVi8NN"},{"type":"text","value":").","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"lDwG9gL0IJ"}],"key":"Jx0JcN9PmZ"}],"key":"ngwBtf7SuM"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"JavaScript may also load from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"DovPsL0C0o"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"jsDelivr","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"tVoYWUIq4K"}],"key":"mi4fyRmgia"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"pRu240krW9"}],"key":"YaxOYzbcUw"}],"key":"hyCG3A6Jpr"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plugins and embedded objects (like Flash or Java applets) are entirely forbidden.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"zD7BK1sjW1"}],"key":"U2O0r9k5Fd"}],"key":"n38MF7GjZc"}],"key":"za97RfoVXV"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The result: even if an attacker injects a malicious ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"v99i0nFp3l"},{"type":"inlineCode","value":"<script>","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Yp2tWbHBio"},{"type":"text","value":" tag, the browser refuses to execute it because it’s not on the approved list.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ZVaVuMStle"}],"key":"NChf1OxjFp"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZqF2XHuyKh"},{"type":"heading","depth":2,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2. Why CSP is Complementary, Not a Substitute","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"hVuiLc3u12"}],"key":"ga4UuF9Bhx"}],"identifier":"id-2-why-csp-is-complementary-not-a-substitute","label":"2. Why CSP is Complementary, Not a Substitute","html_id":"id-2-why-csp-is-complementary-not-a-substitute","implicit":true,"key":"JLXCbNCeQE"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"It’s tempting to treat CSP as a magic fix for XSS — but that would be a mistake.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"puHX7UYAEO"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Escaping and validation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"CnOVQWp3X1"}],"key":"I3Z77oLLYu"},{"type":"text","value":" remain your ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"KdKBH9ZBe9"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"primary defense","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Vs5lZZ8Tha"}],"key":"gtLnb2nkku"},{"type":"text","value":"; CSP simply limits the damage if something slips through.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"CpUQg0Sauz"}],"key":"M5fOFGuoTH"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Here’s why they must work hand-in-hand:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"lN70yPL36h"}],"key":"hoG1TRsOaQ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":38,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"CSP restricts behavior, not content.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"J0I30okiqC"}],"key":"whYw2k2olJ"},{"type":"text","value":"\nIt tells the browser what to load, but it can’t sanitize data. Escaping neutralizes harmful input before it ever reaches the browser.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"WwZdQfQaTi"}],"key":"z5ygcERTxT"}],"key":"DzlSu1g6zr"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Misconfigurations happen.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"iFDZtYVoiQ"}],"key":"lRet4wEmkj"},{"type":"text","value":"\nA single misplaced ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"TQtinDEGtM"},{"type":"inlineCode","value":"'unsafe-inline'","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"kWljpVxjI3"},{"type":"text","value":" or forgotten domain can open the gates again. Proper escaping ensures that even missteps in policy remain survivable.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"K0XLnB4VnH"}],"key":"uTK10GnxQY"}],"key":"dnd3wpzIKV"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Browser support varies.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"hkBT3MfhGn"}],"key":"dGyJaQUFo0"},{"type":"text","value":"\nOlder or embedded browsers may ignore parts of CSP. Escaping works everywhere.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"MtIM59aRsp"}],"key":"CNsbjGfmbE"}],"key":"a3tR0n3dte"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Defense in depth.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"Az6lMnvFVH"}],"key":"AHQOxShxCE"},{"type":"text","value":"\nSecurity thrives on redundancy. Escaping stops bad data; CSP catches anything that somehow sneaks through.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"nyDndkCsO0"}],"key":"z1xXpbRHp5"}],"key":"KuQe18fWis"}],"key":"yPMEJJUr1O"},{"type":"blockquote","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Think of escaping as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"UhYKfUKJia"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"locking the door","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"QxjRSzRnqU"}],"key":"mWMcA92gxB"},{"type":"text","value":", and CSP as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"C81mMOGReD"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"posting a guard outside","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"OxvgV6yqbu"}],"key":"BygeVFa0YB"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"X1KSiBiiW2"}],"key":"DGMhZF4e8a"}],"key":"pto9vAYNlA"},{"type":"thematicBreak","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"qbGY0vCrrk"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3. Where and How to Apply a CSP Header","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"tmyGmmJn0l"}],"key":"ZOWAOS38wu"}],"identifier":"id-3-where-and-how-to-apply-a-csp-header","label":"3. Where and How to Apply a CSP Header","html_id":"id-3-where-and-how-to-apply-a-csp-header","implicit":true,"key":"wbU03TsQQn"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"CSP is enforced by the browser but delivered by your server. You set it as an ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"uIe1K1HL2B"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"HTTP response header","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"CQ3cdIUx3e"}],"key":"wi4J98QGAE"},{"type":"text","value":", usually through your web server configuration or application code.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"AH1McsklBA"}],"key":"eJ78q59cFM"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Apache Example","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"SbVYST8uem"}],"key":"Ms79eH7VYJ"}],"identifier":"apache-example","label":"Apache Example","html_id":"apache-example","implicit":true,"key":"l6yq8qLPwI"},{"type":"code","lang":"apache","value":"Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\"","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"key":"LZjlFS48pG"},{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Nginx Example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"IVvftlghhO"}],"key":"YUivNjlG0F"}],"identifier":"nginx-example","label":"Nginx Example","html_id":"nginx-example","implicit":true,"key":"U2cAQm7sxC"},{"type":"code","lang":"nginx","value":"add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\";","position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"key":"K9fV6KQNeF"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"PHP Example","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"TeJPS8qmsj"}],"key":"MTAou4cvsO"}],"identifier":"php-example","label":"PHP Example","html_id":"php-example","implicit":true,"key":"WgfVJ4BUbn"},{"type":"code","lang":"php","value":"<?php\nheader(\"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\");\n?>","position":{"start":{"line":69,"column":1},"end":{"line":73,"column":1}},"key":"skXivq3Bdd"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"(Place this before any HTML output so the header is sent correctly.)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"VxZO5SIKFW"}],"key":"l6DzqtrEMQ"}],"key":"TGdlHCPN7S"},{"type":"thematicBreak","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"s9w7n7SuXE"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"4. The Meta Tag — A Limited Alternative","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"P5VkMz1NwD"}],"key":"gDeZkTRV8W"}],"identifier":"id-4-the-meta-tag-a-limited-alternative","label":"4. The Meta Tag — A Limited Alternative","html_id":"id-4-the-meta-tag-a-limited-alternative","implicit":true,"key":"vmGcXFqpv1"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"When you can’t modify server headers (for instance, on a static host or learning environment), CSP can also be added via a ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"x0R5Ng2cVw"},{"type":"inlineCode","value":"<meta>","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"CkuSA61VpX"},{"type":"text","value":" tag:","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"iZsSspcYP0"}],"key":"lRRnutVBCC"},{"type":"code","lang":"html","value":"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'\">","position":{"start":{"line":83,"column":1},"end":{"line":85,"column":1}},"key":"UEu1of1eVR"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"This works only for the current document and has limited enforcement power. It’s fine for classroom demos or single pages, but in production, always use the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"yOGrm8lK9R"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"HTTP header","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"FGD9vlPi59"}],"key":"VGbTNgtSmh"},{"type":"text","value":" form.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"z7lI8kzYfj"}],"key":"WsrZ233zDq"},{"type":"thematicBreak","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"EKspGUU4ok"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"5. Building a Policy in Practice","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"f8aIzcz4J7"}],"key":"dsCVxHcFQ2"}],"identifier":"id-5-building-a-policy-in-practice","label":"5. Building a Policy in Practice","html_id":"id-5-building-a-policy-in-practice","implicit":true,"key":"D2Nk9QbQHz"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Start simple, test carefully, then tighten. CSP has a ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"AYhDNkFvkW"},{"type":"emphasis","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"report-only","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"l4n7mIkmIV"}],"key":"rwBy2j1AH8"},{"type":"text","value":" mode that allows you to test your policy without breaking your site:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"Vg8NMczagE"}],"key":"CcdjONXPTJ"},{"type":"code","lang":"http","value":"Content-Security-Policy-Report-Only: default-src 'self';","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"key":"tEJ4s5CZ8B"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"You can even log violations to a monitoring endpoint:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"TIRmHSxvay"}],"key":"oeEJn7lhAW"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; report-uri /csp-violation-report-endpoint/;","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"key":"wVHYhHUi4f"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This iterative approach lets you fine-tune your policy safely before enforcement.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"nv4Yn4dw3c"}],"key":"ysFzDKtqay"},{"type":"thematicBreak","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"dE2XNEaAfr"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"6. The Belt and Suspenders Philosophy","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"KhTxQnZlzI"}],"key":"XBPihbT3lc"}],"identifier":"id-6-the-belt-and-suspenders-philosophy","label":"6. The Belt and Suspenders Philosophy","html_id":"id-6-the-belt-and-suspenders-philosophy","implicit":true,"key":"GFE5vtqbQW"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Security is strongest when multiple defenses overlap.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"MOJG6jguih"}],"key":"bH8t9MH9hZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"KquqFlPAIS"}],"key":"pWyL3VNNmJ"},{"type":"text","value":": Removes or neutralizes malicious input.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"FLnWlvd4Em"}],"key":"KMdOxbGkbf"}],"key":"Kr4OkTmVf8"},{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"Qwh9CbCMM1"}],"key":"Di2XaxFOL3"},{"type":"text","value":": Ensures only expected data enters the system.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"nDRd71BoMR"}],"key":"Sx78do8vFb"}],"key":"H3eVh7IkLc"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"HlXdfjUs0u"}],"key":"BKlvxQz09D"},{"type":"text","value":": Stops execution or loading of untrusted resources.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"JHqKipP4h2"}],"key":"XXZMPNX0cL"}],"key":"VhjUb1I7QH"}],"key":"AZWiW3R9WX"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Together, they form a resilient shield that protects your users, your data, and your reputation.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"NphShHf2b2"}],"key":"DkC857gJXv"},{"type":"blockquote","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Proper escaping is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"vFG4alIW9w"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"brakes","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"SBaPYoQwiF"}],"key":"zC1fC3ZTO5"},{"type":"text","value":";\nCSP is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"xrI6I6zJJI"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"gknoXo7iTP"}],"key":"wsnNgQ3Bbm"},{"type":"text","value":".\nYou need both to stay safe on the open web.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"F3I51bqPsM"}],"key":"iEXilFY9t3"}],"key":"rIQJP37Ovm"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"iFEPdJtfml"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Summary Checklist","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"nqOSv4qiMT"}],"key":"TAPGU5CxsV"}],"identifier":"summary-checklist","label":"Summary Checklist","html_id":"summary-checklist","implicit":true,"key":"Epk44VR0ty"},{"type":"table","position":{"start":{"line":127,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"r8Cw6wjD6p"}],"key":"dFcxLI27P4"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"A4jFKHU062"}],"key":"Oz6lw1fmyp"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"fk7KlpPeLy"}],"key":"VrxGnwONfH"}],"key":"JGcQzeHjSw"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Escape Output","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"PbkF8FCAOE"}],"key":"SUqTOe3sVH"}],"key":"wuFSkgAWRk"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Prevent injection from rendering","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"RNjeKMqYn4"}],"key":"yzMvcwqC46"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"rh2OdNvoWI"},{"type":"text","value":" or equivalent","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"hPkWuxnHCR"}],"key":"hFXQQ66AVU"}],"key":"eVJYsP80E8"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Validate Input","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"hs6I2J2P4V"}],"key":"dI0wAkXGpn"}],"key":"dsCYA0goYb"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Reject invalid data early","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"u1FmrLxuf9"}],"key":"sZ2Ktlv3HS"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Whitelist and sanitize","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"B8mAIZaNgS"}],"key":"KmOgJjHeA3"}],"key":"Iv1zJRvjzw"},{"type":"tableRow","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Use CSP Header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"plzOeRUTAe"}],"key":"eHmmrwE8DW"}],"key":"KdTtUTCqOF"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Restrict script and content sources","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"aAub6daMe8"}],"key":"OVT4ZVcvNG"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Set via HTTP header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"aEr4k0c6x5"}],"key":"Qu3h5pKtqH"}],"key":"HlUujpePdR"},{"type":"tableRow","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Test with Report-Only","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"D0joyw7RuA"}],"key":"kOiNjmWvET"}],"key":"BZXoczfc46"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Monitor before enforcing","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"m5Fu1GGbzS"}],"key":"kjIDo1Zptg"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Log violations safely","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"PoHddhLEsv"}],"key":"EeI48YfjnK"}],"key":"ZogFhDWVde"},{"type":"tableRow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Iterate Gradually","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"FMmeASF6bG"}],"key":"smydmr4LsU"}],"key":"ZU6pWtF56e"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Refine over time","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"SvN56hZSvG"}],"key":"kLpIATwdda"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Add domains only when needed","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"za20F7OiBZ"}],"key":"oGnRfNAscU"}],"key":"n7Iv3pPpOG"}],"key":"oNuAF4hbre"},{"type":"thematicBreak","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"GVRa56YhG1"},{"type":"heading","depth":3,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Final Thought","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"ONqzMbS36L"}],"key":"YZkGYx72Ws"}],"identifier":"final-thought","label":"Final Thought","html_id":"final-thought","implicit":true,"key":"cVR0RQgesJ"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"CSP isn’t a silver bullet — but it’s a brilliant ally.\nIt turns the browser from a passive rendering engine into a ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"OIvqtBEkIU"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"vigilant partner in security","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"jd6ruuiwJM"}],"key":"Jadmpq3dzf"},{"type":"text","value":".\nUse it thoughtfully, pair it with strong coding practices, and your web applications will stand firm against the most persistent adversaries of the modern web.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"E9iytRFN22"}],"key":"N5lK5cy23h"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"hffbBBux0G"}],"key":"oiJH84tvJj"}],"key":"RGoqHBqbPm"}],"key":"tc8YU2hecI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"XSS Examples","url":"/wpref/xssexamples","group":"Web Programming"},"next":{"title":"Passwords","url":"/wpref/passwords","group":"Web Programming"}}},"domain":"http://localhost:3000"}