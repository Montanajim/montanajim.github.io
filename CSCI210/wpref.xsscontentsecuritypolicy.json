{"version":2,"kind":"Article","sha256":"f4691d2f29d65dc97fed15efe85f83004b1c976404fbb9167a5491fcec0cf73d","slug":"wpref.xsscontentsecuritypolicy","location":"/wpref/xssContentSecurityPolicy.md","dependencies":[],"frontmatter":{"title":"Content Security Policy","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xssContentSecurityPolicy.md","url":"CSCI210/build/xssContentSecurityPo-9d9c07e2dc0b8af1b28979f40537f04b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Browser’s Bodyguard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VuEBB5gJJb"}],"key":"vCT5HIW1Mu"}],"identifier":"the-browsers-bodyguard","label":"The Browser’s Bodyguard","html_id":"the-browsers-bodyguard","implicit":true,"key":"FaQOnNKZrC"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the constant duel between security and convenience, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a8YyYocM1q"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"L3JjByPuHC"}],"key":"Bm3xCjgC7r"},{"type":"text","value":" remains a classic ambush. Developers defend their web pages with careful ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SUikX31kr5"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"escaping","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eMx14k6qbb"}],"key":"U0sAzkZYTr"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZQdqYupSnZ"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"validation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"l9rr7UmUgV"}],"key":"oXDBKsi3AS"},{"type":"text","value":", but even the best code occasionally slips. That’s where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CvszgFbCNo"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Content Security Policy (CSP)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IupgqlbFD1"}],"key":"TTyFijDli1"},{"type":"text","value":" steps in — not as a replacement, but as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HY0iqjfhlR"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"complementary layer of armor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kHVIgOjN9A"}],"key":"pVX0YE6ixi"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B4tEnbthtO"}],"key":"Gj9I6KnFqX"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fLktDueeh9"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. What is Content Security Policy (CSP)?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uOt30Fjs8K"}],"key":"x3wq3TN4QR"}],"identifier":"id-1-what-is-content-security-policy-csp","label":"1. What is Content Security Policy (CSP)?","html_id":"id-1-what-is-content-security-policy-csp","implicit":true,"key":"LEnhfmYhjD"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uZ2vl3Xfif"}],"key":"O5665qzusA"},{"type":"text","value":" is an HTTP response header that acts as a browser-enforced whitelist. It tells the browser ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MwVKCcHHUP"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rU8UHipoh0"}],"key":"lGjQIAJdb9"},{"type":"text","value":" which sources of scripts, styles, images, fonts, and frames are trusted — and blocks everything else.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"CMWuniot3S"}],"key":"HnCFLLbzTs"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In essence, CSP transforms the browser from a passive renderer into an active security guard.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uwR2O7Ug0c"}],"key":"YI27bcrjIo"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"a3pXo7DAli"}],"key":"Bgekfi7VpG"}],"key":"uNGi0PHoBJ"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"uhapvegdqc"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"This directive means:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ubdY0Pu8Da"}],"key":"V14c90jeAg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All content must come from the same origin (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"oZDcQF2MV9"},{"type":"inlineCode","value":"'self'","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Y7P1IYTTGZ"},{"type":"text","value":").","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mBvcTZYMhw"}],"key":"quo7S5ucbj"}],"key":"DpeH4nlJxv"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"JavaScript may also load from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"l7a2nR7IlZ"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"jsDelivr","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"SmToR99sig"}],"key":"lUI1GZgX2N"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"YPaCHXCfBh"}],"key":"cPqBzwiG9x"}],"key":"DIDOu6yU4E"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plugins and embedded objects (like Flash or Java applets) are entirely forbidden.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"HPJD64EeAt"}],"key":"F4Y2TllQEh"}],"key":"CUCjV9l7bw"}],"key":"xmqNRLqdM5"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The result: even if an attacker injects a malicious ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"TbTRqc5NCi"},{"type":"inlineCode","value":"<script>","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"L3M0St8pjU"},{"type":"text","value":" tag, the browser refuses to execute it because it’s not on the approved list.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"PrdAxK0jY4"}],"key":"klT9Q3kY8E"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bnv0yhI3Cc"},{"type":"heading","depth":2,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2. Why CSP is Complementary, Not a Substitute","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"z87oUcsM77"}],"key":"vJNepKCK6G"}],"identifier":"id-2-why-csp-is-complementary-not-a-substitute","label":"2. Why CSP is Complementary, Not a Substitute","html_id":"id-2-why-csp-is-complementary-not-a-substitute","implicit":true,"key":"VY5sP311tz"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"It’s tempting to treat CSP as a magic fix for XSS — but that would be a mistake.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"pqEMQirrGb"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Escaping and validation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"qzX1HkzYIH"}],"key":"yzOi5FhLCV"},{"type":"text","value":" remain your ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"e7MThPewY9"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"primary defense","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"BarhlDU5Wz"}],"key":"lp0K74LydO"},{"type":"text","value":"; CSP simply limits the damage if something slips through.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"PjsZtBtrCT"}],"key":"WI2i7kQATN"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Here’s why they must work hand-in-hand:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"Psa6pBbpjM"}],"key":"xCjeXRo9ZW"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":38,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"CSP restricts behavior, not content.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"eC0oDA140P"}],"key":"Oe9dGHD2tc"},{"type":"text","value":"\nIt tells the browser what to load, but it can’t sanitize data. Escaping neutralizes harmful input before it ever reaches the browser.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"O44JPn8ftf"}],"key":"m8jD4dOnsK"}],"key":"mksN6FNbwB"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Misconfigurations happen.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mulIsSH1IL"}],"key":"n2oOChiQar"},{"type":"text","value":"\nA single misplaced ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"RuSqazRlRA"},{"type":"inlineCode","value":"'unsafe-inline'","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mfLJ71nj29"},{"type":"text","value":" or forgotten domain can open the gates again. Proper escaping ensures that even missteps in policy remain survivable.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"VpbZsdwNDQ"}],"key":"xkeOTzp5QM"}],"key":"yytn2djDXV"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Browser support varies.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WZ2LVXdx2n"}],"key":"A3tcQymSme"},{"type":"text","value":"\nOlder or embedded browsers may ignore parts of CSP. Escaping works everywhere.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"A2Zs98w6ns"}],"key":"vWmKfgq8SL"}],"key":"BTxCmyMUyC"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Defense in depth.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"v6ueZCaWxo"}],"key":"OuNnnFTdao"},{"type":"text","value":"\nSecurity thrives on redundancy. Escaping stops bad data; CSP catches anything that somehow sneaks through.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"RgBRBGIDoV"}],"key":"QsQvHJ9f9Q"}],"key":"C30bZWnJxk"}],"key":"rg3E48L6to"},{"type":"blockquote","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Think of escaping as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"gbx9gYx9hp"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"locking the door","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"vMyifqu46r"}],"key":"hcs9c6gVPe"},{"type":"text","value":", and CSP as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"aurG0Bh2bt"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"posting a guard outside","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"DBknb8YU6m"}],"key":"uSJdDaYQWE"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"E2uh0pjuTr"}],"key":"nH3usvOhKD"}],"key":"wSyCrUH5Zo"},{"type":"thematicBreak","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"lc6MgIhq3r"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3. Where and How to Apply a CSP Header","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"eovRnq1B7h"}],"key":"AfOzwUS1S6"}],"identifier":"id-3-where-and-how-to-apply-a-csp-header","label":"3. Where and How to Apply a CSP Header","html_id":"id-3-where-and-how-to-apply-a-csp-header","implicit":true,"key":"LFWb4G5DKQ"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"CSP is enforced by the browser but delivered by your server. You set it as an ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"q4Z0byksGl"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"HTTP response header","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"THxqjQM201"}],"key":"OAzOcQy2Jv"},{"type":"text","value":", usually through your web server configuration or application code.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HU3vcvIGzv"}],"key":"svoUU2JpqS"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Apache Example","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"hjHZcQwwzg"}],"key":"Sz0Jhc51i0"}],"identifier":"apache-example","label":"Apache Example","html_id":"apache-example","implicit":true,"key":"PTPtPaLyTi"},{"type":"code","lang":"apache","value":"Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\"","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"key":"URdmJEaUk2"},{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Nginx Example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"p9pC9lsSBp"}],"key":"slb5Pxgp7t"}],"identifier":"nginx-example","label":"Nginx Example","html_id":"nginx-example","implicit":true,"key":"mOAJsQ2YM3"},{"type":"code","lang":"nginx","value":"add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\";","position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"key":"EsL8DVfESm"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"PHP Example","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"zHmEOJaaSM"}],"key":"XIZMw2Hxri"}],"identifier":"php-example","label":"PHP Example","html_id":"php-example","implicit":true,"key":"EZeC93CBKI"},{"type":"code","lang":"php","value":"<?php\nheader(\"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\");\n?>","position":{"start":{"line":69,"column":1},"end":{"line":73,"column":1}},"key":"ugHjh7xZeC"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"(Place this before any HTML output so the header is sent correctly.)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"PkGre3QoUg"}],"key":"t4WZll4Wof"}],"key":"MBNgqiPogU"},{"type":"thematicBreak","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"FmPDjOWT4k"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"4. The Meta Tag — A Limited Alternative","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"NNXnq0BWFc"}],"key":"LuNY7XfC5H"}],"identifier":"id-4-the-meta-tag-a-limited-alternative","label":"4. The Meta Tag — A Limited Alternative","html_id":"id-4-the-meta-tag-a-limited-alternative","implicit":true,"key":"YdxMCVGbyW"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"When you can’t modify server headers (for instance, on a static host or learning environment), CSP can also be added via a ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"mYdDBVPiBt"},{"type":"inlineCode","value":"<meta>","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"tajpgjdk1k"},{"type":"text","value":" tag:","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"Cyv93zq0iW"}],"key":"nQsKcAMFvX"},{"type":"code","lang":"html","value":"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'\">","position":{"start":{"line":83,"column":1},"end":{"line":85,"column":1}},"key":"n9NpgUF47K"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"This works only for the current document and has limited enforcement power. It’s fine for classroom demos or single pages, but in production, always use the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"YbR9Bwvf40"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"HTTP header","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"M5ySX4jJ8i"}],"key":"z5wwv49QDx"},{"type":"text","value":" form.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"cnnz4zHogJ"}],"key":"wgy8QaZHlq"},{"type":"thematicBreak","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"KLHtXj9zgx"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"5. Building a Policy in Practice","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"kJ6faKxpII"}],"key":"HZ3mOVff4f"}],"identifier":"id-5-building-a-policy-in-practice","label":"5. Building a Policy in Practice","html_id":"id-5-building-a-policy-in-practice","implicit":true,"key":"QQL3QC14nL"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Start simple, test carefully, then tighten. CSP has a ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"ScD5dONy9B"},{"type":"emphasis","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"report-only","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"egbOBjWcks"}],"key":"dqdlTTE0Pf"},{"type":"text","value":" mode that allows you to test your policy without breaking your site:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"Ea4wDxtXia"}],"key":"mLQUB59I1l"},{"type":"code","lang":"http","value":"Content-Security-Policy-Report-Only: default-src 'self';","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"key":"lDMtFP1Wfm"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"You can even log violations to a monitoring endpoint:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"M1hb50zMwN"}],"key":"uE3jz67dRg"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; report-uri /csp-violation-report-endpoint/;","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"key":"A0XoDVn75e"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This iterative approach lets you fine-tune your policy safely before enforcement.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"nnqtCcMaUY"}],"key":"ij5Ds0FtRa"},{"type":"thematicBreak","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"uGbTClJJpC"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"6. The Belt and Suspenders Philosophy","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"LDv1TkVDYr"}],"key":"tYoESBu0a7"}],"identifier":"id-6-the-belt-and-suspenders-philosophy","label":"6. The Belt and Suspenders Philosophy","html_id":"id-6-the-belt-and-suspenders-philosophy","implicit":true,"key":"iLc0rD4QTh"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Security is strongest when multiple defenses overlap.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"mnBzZAHpoL"}],"key":"inr89tgOgX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"Hv91Tu2Vie"}],"key":"OG6QXesY8D"},{"type":"text","value":": Removes or neutralizes malicious input.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"mXuE6E39E9"}],"key":"hShmsEDb86"}],"key":"roA7kgUwkb"},{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"bmZmJbMJzk"}],"key":"axuvigqDHD"},{"type":"text","value":": Ensures only expected data enters the system.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"Mr8MQZyNc6"}],"key":"m5TQx1QkXI"}],"key":"N2gJnXKzza"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"y4YoLjRMp1"}],"key":"TkZLOT2bmf"},{"type":"text","value":": Stops execution or loading of untrusted resources.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"A0t1PVJpnW"}],"key":"Pshi18QVzj"}],"key":"hmHfymAQ2M"}],"key":"TcXg4K4uhX"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Together, they form a resilient shield that protects your users, your data, and your reputation.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"H5PA6nGooV"}],"key":"kqrqpSqHnT"},{"type":"blockquote","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Proper escaping is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"L9josLOJzb"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"brakes","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"xuVA6OHelY"}],"key":"MVZa2RpHn8"},{"type":"text","value":";\nCSP is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"HB0JRkNwKr"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"A2qQfKQbCM"}],"key":"QN7yt3vzsi"},{"type":"text","value":".\nYou need both to stay safe on the open web.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"BUNHVrMxun"}],"key":"iVPC4HW6b3"}],"key":"gJ6IOJzPav"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"oluWhQCtzx"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Summary Checklist","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"Dvsoyx6Zqo"}],"key":"xbn8PEPvfw"}],"identifier":"summary-checklist","label":"Summary Checklist","html_id":"summary-checklist","implicit":true,"key":"lWyLUKKfaN"},{"type":"table","position":{"start":{"line":127,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"GmFM0HRncx"}],"key":"W613lGXnIb"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"rawrQAc52I"}],"key":"vBQiyYh5aU"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"yAYnxJuOZ6"}],"key":"OT9jdv8XW5"}],"key":"AqH7c9JvLQ"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Escape Output","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"Og2GofAUhJ"}],"key":"s6WjqL5F6d"}],"key":"nOyIcjvl0A"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Prevent injection from rendering","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"Y8kGw7TgCN"}],"key":"rnCLaiVsPD"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"f5Ub2N7Gok"},{"type":"text","value":" or equivalent","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"sLy0lokdQc"}],"key":"lXPwYNkoaw"}],"key":"xgCZTdYsbW"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Validate Input","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"DNrEfqpZpP"}],"key":"i4XofjOV3k"}],"key":"BZBtUhYeR1"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Reject invalid data early","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"X7x23P45E9"}],"key":"hWdJ0FB4Wz"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Whitelist and sanitize","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"X9etXPzUq5"}],"key":"AhEkDNelTg"}],"key":"LKy0McwlkE"},{"type":"tableRow","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Use CSP Header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"Wr1rFIOV7d"}],"key":"Tzi5ooW0dA"}],"key":"zNmc4xuvG1"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Restrict script and content sources","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"outzUc0vbi"}],"key":"JnlUhwe4Uh"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Set via HTTP header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"faNJYzQlqU"}],"key":"ekxj929Tpq"}],"key":"OZpeE1jDRc"},{"type":"tableRow","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Test with Report-Only","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"YkWI8pIqxY"}],"key":"hIrAX1DroJ"}],"key":"pGYGjXwGDy"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Monitor before enforcing","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"UbbQjjts3f"}],"key":"D1IODTjP10"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Log violations safely","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"OdfdV841X0"}],"key":"n3YCT3fAMx"}],"key":"qIDebEEMqB"},{"type":"tableRow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Iterate Gradually","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"gSj3wixDur"}],"key":"W7bF5TKhZV"}],"key":"e6QfN4QBhd"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Refine over time","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"PmOG6hQOop"}],"key":"fnmXfHKqXB"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Add domains only when needed","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"AYI9Tj2RDC"}],"key":"Vh9cd9TVgU"}],"key":"LpNvu8ZUsf"}],"key":"oHqmUL5s7w"},{"type":"thematicBreak","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"CysNnWuVzv"},{"type":"heading","depth":3,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Final Thought","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"VBNu3rLSwx"}],"key":"TZM9c63JpG"}],"identifier":"final-thought","label":"Final Thought","html_id":"final-thought","implicit":true,"key":"hx3gkBryV4"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"CSP isn’t a silver bullet — but it’s a brilliant ally.\nIt turns the browser from a passive rendering engine into a ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"dWZjPOZarX"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"vigilant partner in security","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"c7Yb2rELMo"}],"key":"iPxsoL1hAx"},{"type":"text","value":".\nUse it thoughtfully, pair it with strong coding practices, and your web applications will stand firm against the most persistent adversaries of the modern web.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"GftRBcZrFc"}],"key":"ejMpAM42Rc"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"VX4r5jn07h"}],"key":"LgHoLiKk0q"}],"key":"V7sdVi6xlV"}],"key":"fwXfPsTwXT"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"XSS Examples","url":"/wpref/xssexamples","group":"Web Programming"},"next":{"title":"Passwords","url":"/wpref/passwords","group":"Web Programming"}}},"domain":"http://localhost:3000"}