<!DOCTYPE html><html lang="en" class="" style="scroll-padding:0"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>XSS Examples - Web Programming</title><meta property="og:title" content="XSS Examples - Web Programming"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/CSCI210//build/_assets/app-TSEI6AL7.css"/><link rel="stylesheet" href="/CSCI210//build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/CSCI210//favicon.ico"/><link rel="stylesheet" href="/CSCI210//myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="fixed top-4 right-4 z-50"><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button></div><main id="main" data-name="article-page-and-navigation-main" class="article-left-grid subgrid-gap"><div class="hidden"></div><header class="relative col-screen"><div class="w-full relative col-screen article article-left-grid subgrid-gap my-[2rem]"><div class="col-page-right"><div class="flex w-full align-middle py-2 mb-[1rem] text-sm col-page-right"><div class="flex-grow"></div><div class="hidden sm:block"><a href="https://github.com/montanajim/CSCI210" title="GitHub Repository: montanajim/CSCI210" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div></div><div class="flex flex-col mb-10 md:flex-row"><div id="skip-to-frontmatter" aria-label="article frontmatter" class="flex-grow col-body"><h1 class="mb-0">Web Programming</h1><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R1oqf8p:" data-state="closed">James Goudy</button></span></div></div><div class="pt-5 md:self-center h-fit lg:pt-0 col-body lg:col-margin-right-inset"><div class="col-margin mt-3 mx-5 lg:m-0 lg:w-[300px]"><div class="flex flex-wrap gap-2 lg:flex-col w-fit lg:mx-auto"><a class="flex no-underline" href="/CSCI210//build/book-534e8bb868c58f09653a3aae427c5b4b.pdf"><span class="sr-only">Download<!-- --> as pdf<!-- --> <!-- -->PDF</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="self-center flex-none inline-block mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span class="w-max max-w-[200px] self-center">PDF</span></a></div></div></div></div></div></div></header><article data-name="article-page-main" class="article article-left-grid subgrid-gap col-screen"><div class="flex items-center p-3 mb-10 border-y bg-slate-50 dark:bg-slate-600 border-y-slate-300 col-screen"><a class="flex gap-1 px-2 py-1 font-normal no-underline rounded border bg-slate-200 border-slate-600 hover:bg-slate-800 hover:text-white hover:border-transparent" href="/CSCI210/"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1rem" height="1rem" class="flex-none self-center transition-transform group-hover:-translate-x-1"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><span>Back to Article</span></a><div class="flex-grow text-center">XSS Examples</div><a href="/CSCI210//build/zxssExamples-0aedf5ce712cc67e0f6b7e0e38b8c86a.md" class="flex gap-1 px-2 py-1 font-normal no-underline rounded border bg-slate-200 border-slate-600 hover:bg-slate-800 hover:text-white hover:border-transparent"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1rem" height="1rem" class="flex-none self-center transition-transform group-hover:-translate-x-1"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Download <!-- -->Article</span></a></div><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-5"><h1 class="mb-0">XSS Examples</h1></div><div class="block my-10 lg:sticky lg:top-0 lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:24px"><nav><div class="my-4 text-sm leading-6 uppercase text-slate-900 dark:text-slate-100">Supporting Documents</div><ul class="flex flex-col gap-2 pl-0 text-sm leading-6 list-none text-slate-700 dark:text-slate-300"><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zphpintroduction#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PHP Introduction</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zphpbasics#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PHP Basics</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zloopif#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Loops and If</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zphparrays#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PHP Arrays</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zfunctions#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Functions</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zfirstformspostandget#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>First Forms - POST and GET</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zhtmlinputfieldreview#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>HTML Input Field Review</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zsessionvariables#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Session Variables</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zsessionhomeworkhint#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Session Variable Homework Assignment Hint</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zpdoconnections#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PDO Connections</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zphpclosingtags#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PHP Closing Tags: Leave Them Out Or Out</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zpdofirstdatadbinsertcarexample#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PDO - First Data Insert - Car Example</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zpdonoplaceholdersexample#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PDO With No Named Placeholders</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zstringsanitation#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>String Sanitation - filter_var()</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zxssdefendingagainstxss#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Defending Against Cross Site Scripting</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zxssexamples#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>XSS Examples</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zxsscontentsecuritypolicy#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Content Security Policy</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zpasswords#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Passwords</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zaddeditdelete#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Add Edit Delete</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zsavingpicturesindatabase#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Saving Pictures In Database</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zreadingjson#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Reading json</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zdatefunctionphp#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Date Function</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zsqliteguide#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>PHP + SQLite Shortcut Guide</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zsearchfiltersqlite#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Search Filter - SQLITE</span></a></li><li><a class="no-underline flex self-center hover:text-blue-700" href="/CSCI210//zyoutubedemo#main"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline mr-2 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25M9 16.5v.75m3-3v3M15 12v5.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><span>Z You Tube Demo</span></a></li></ul></nav></div><div id="skip-to-article"></div><p>This short chapter demonstrates two common XSS scenarios and how to fix them:</p><ol start="1"><li><p><strong>Reflected XSS</strong> — user input (from the query string) is immediately written back into the page. The vulnerable example prints the raw query value; the fixed example escapes it with <code>htmlspecialchars</code> so any injected <code>&lt;script&gt;</code> becomes harmless text.</p></li><li><p><strong>Stored XSS (toy guestbook)</strong> — a user-submitted message is stored in session and later rendered for all visitors. The vulnerable example renders the raw stored value, which will execute in the browser. The fixed example sanitizes stored values on output using a small <code>sanitize()</code> helper that performs <code>trim()</code>, <code>strip_tags()</code> and <code>htmlspecialchars()</code> (ENT_QUOTES, UTF-8).</p></li></ol><p>Read the inline comments — I call out the vulnerable lines and explain the remediation. Use these pages in a classroom or lab to safely demonstrate how an attacker’s <code>&lt;script&gt;</code> turns into harmless text once properly escaped.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="index-php-home-page-with-demo-links" class="relative group"><span class="heading-text"><code>index.php</code> — home page with demo links</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#index-php-home-page-with-demo-links" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-php" style="white-space:pre">&lt;?php
// index.php
// Simple landing page linking to the vulnerable and fixed demo pages.
//
// This file is purely HTML. Links include an example exploit payload to
// illustrate how a reflected XSS payload would look in the query string.
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1.0&quot; /&gt;
    &lt;title&gt;XSS Home Demo&lt;/title&gt;
    &lt;style&gt;
        .div1 {
            width: 50%;
            background-color: cornsilk;
            margin: 50px auto 0 auto;
            padding: 1rem;
            border-radius: 6px;
            font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, &quot;Helvetica Neue&quot;, Arial;
        }
        a { display:block; margin:8px 0; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;div1&quot;&gt;
        &lt;h1&gt;XSS Demos&lt;/h1&gt;

        &lt;!--
          The query string contains a classic demo payload:
          ?q=&lt;script&gt;alert(&#x27;Hacked&#x27;)&lt;/script&gt;
        --&gt;
        &lt;a href=&quot;page1_reflect.php?q=&lt;script&gt;alert(&#x27;Hacked&#x27;)&lt;/script&gt;&quot;&gt;
            Page 1 — Reflect (VULNERABLE)
        &lt;/a&gt;

        &lt;a href=&quot;page1_reflect_prevent.php?q=&lt;script&gt;alert(&#x27;Hacked&#x27;)&lt;/script&gt;&quot;&gt;
            Page 1 — Reflect (Prevented)
        &lt;/a&gt;

        &lt;a href=&quot;stored_hacked.php&quot;&gt;Stored — Guestbook (VULNERABLE)&lt;/a&gt;
        &lt;a href=&quot;stored_hacked_prevent.php&quot;&gt;Stored — Guestbook (Prevented)&lt;/a&gt;

        &lt;a href=&quot;index.php&quot;&gt;Home&lt;/a&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><hr class="py-2 my-5 translate-y-2"/><h2 id="page1-reflect-php-vulnerable-reflected-xss-dont-use-in-production" class="relative group"><span class="heading-text"><code>page1_reflect.php</code> — <strong>vulnerable</strong> reflected XSS (don’t use in production)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#page1-reflect-php-vulnerable-reflected-xss-dont-use-in-production" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-php" style="white-space:pre">&lt;?php
// page1_reflect.php
// Demonstrates reflected XSS by echoing a query parameter directly.
// *** VULNERABLE: the raw $q value is injected into the HTML output. ***

// Use null coalescing so page still works without ?q= in the URL.
$q = $_GET[&#x27;q&#x27;] ?? &#x27;&#x27;;
?&gt;
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;Hacked (Reflect - Vulnerable)&lt;/title&gt;
    &lt;style&gt;
        .div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;div1&quot;&gt;
        &lt;h1&gt;Search&lt;/h1&gt;

        &lt;!-- VULNERABLE LINE: raw echo of user input --&gt;
        &lt;!-- If q contains &lt;script&gt;... it will run in the visitor&#x27;s browser. --&gt;
        &lt;p&gt;You searched for: &lt;?= $q ?&gt;&lt;/p&gt; &lt;!-- VULNERABLE --&gt;

        &lt;br&gt;
        &lt;a href=&quot;index.php&quot;&gt;Home&lt;/a&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Teaching note:</strong> open <code>page1_reflect.php?q=&lt;script&gt;alert(&#x27;Hacked&#x27;)&lt;/script&gt;</code> to see how an attacker-supplied <code>&lt;script&gt;</code> executes. The vulnerability comes from outputting unescaped input into an HTML context.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="page1-reflect-prevent-php-reflected-xss-fixed" class="relative group"><span class="heading-text"><code>page1_reflect_prevent.php</code> — reflected XSS <strong>fixed</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#page1-reflect-prevent-php-reflected-xss-fixed" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-php" style="white-space:pre">&lt;?php
// page1_reflect_prevent.php
// Fixed version of reflected XSS demo. Escape output with htmlspecialchars
// so any HTML tags supplied in the query string are rendered as text.

$q = $_GET[&#x27;q&#x27;] ?? &#x27;&#x27;;

// Use a small helper for clarity (context-aware escaping for HTML).
function e($s) {
    // ENT_QUOTES encodes both double and single quotes.
    // &#x27;UTF-8&#x27; ensures proper encoding for multibyte characters.
    return htmlspecialchars((string)$s, ENT_QUOTES, &#x27;UTF-8&#x27;);
}
?&gt;
&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;Hacked (Reflect - Prevented)&lt;/title&gt;
    &lt;style&gt;.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;div1&quot;&gt;
        &lt;h1&gt;Search&lt;/h1&gt;

        &lt;!-- SAFE OUTPUT: any &lt; or &gt; in $q are converted to &amp;lt; &amp;gt; --&gt;
        &lt;p&gt;You searched for: &lt;?= e($q) ?&gt;&lt;/p&gt; &lt;!-- NOT VULNERABLE --&gt;

        &lt;br&gt;
        &lt;a href=&quot;index.php&quot;&gt;Home&lt;/a&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Teaching note:</strong> <code>htmlspecialchars()</code> is the appropriate escape for HTML body content. If you output into other contexts (e.g., attribute, JS, CSS, URL) you must use a different encoding or a trusted library for context-aware encoding.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="stored-hacked-php-vulnerable-stored-xss-guestbook" class="relative group"><span class="heading-text"><code>stored_hacked.php</code> — <strong>vulnerable</strong> stored XSS guestbook</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#stored-hacked-php-vulnerable-stored-xss-guestbook" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-php" style="white-space:pre">&lt;?php
// stored_hacked.php
// Toy guestbook that demonstrates stored XSS by rendering session-stored messages
// without escaping them. DO NOT deploy this as-is.

session_start();

// Place a malicious demo message in session to simulate previously stored content.
$_SESSION[&#x27;messages&#x27;] = [&quot;&lt;script&gt;alert(&#x27;hacked stored!&#x27;)&lt;/script&gt;&quot;];

// Load messages for display.
$messages = $_SESSION[&#x27;messages&#x27;] ?? [];

// If the user posts something, the code below intentionally follows your original
// request: keep the `if (!empty($_POST[&#x27;msg&#x27;]))` check exactly as provided.
if (!empty($_POST[&#x27;msg&#x27;])) {
    // NOTE: this block is intentionally left minimal to match the original demo.
    // In the vulnerable demo we would append raw values to the messages array.
    // For clarity we simply reload messages here (no safe write).
    $messages = $_SESSION[&#x27;messages&#x27;];
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;Stored — Guestbook (Vulnerable)&lt;/title&gt;
    &lt;style&gt;.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;div1&quot;&gt;
        &lt;h1&gt;Guestbook&lt;/h1&gt;

        &lt;!-- Simple form to demonstrate posting --&gt;
        &lt;form method=&quot;post&quot; action=&quot;&quot;&gt;
            &lt;input name=&quot;msg&quot; placeholder=&quot;Say hi&quot; value=&quot;Hello&quot;&gt;
            &lt;button&gt;POST&lt;/button&gt;
        &lt;/form&gt;

        &lt;ul&gt;
            &lt;?php foreach ($messages as $m): ?&gt;
                &lt;!-- VULNERABLE: stored messages are printed raw, so a stored &lt;script&gt; will execute --&gt;
                &lt;li&gt;&lt;?= (string) $m ?&gt;&lt;/li&gt; &lt;!-- VULNERABLE --&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/ul&gt;

        &lt;br&gt;
        &lt;a href=&quot;index.php&quot;&gt;Home&lt;/a&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Teaching note:</strong> Stored XSS occurs when untrusted data is persisted (database, session, file) and later served to users without cleaning/escaping. The attack becomes more dangerous because many visitors might execute the injected script.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="stored-hacked-prevent-php-stored-xss-prevented-sanitizing-on-output" class="relative group"><span class="heading-text"><code>stored_hacked_prevent.php</code> — stored XSS <strong>prevented</strong> (sanitizing on output)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#stored-hacked-prevent-php-stored-xss-prevented-sanitizing-on-output" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-php" style="white-space:pre">&lt;?php
// stored_hacked_prevent.php
// Prevents stored XSS by escaping/sanitizing messages before output.
// Uses the same `if (!empty($_POST[&#x27;msg&#x27;]))` check as requested.

session_start();

// Demo initial message that simulates previously stored malicious content.
$_SESSION[&#x27;messages&#x27;] = [&quot;&lt;script&gt;alert(&#x27;hacked stored!&#x27;)&lt;/script&gt;&quot;];

// Retrieve messages array from session
$messages = $_SESSION[&#x27;messages&#x27;] ?? [];

// Keep original check as requested (no substitution)
if (!empty($_POST[&#x27;msg&#x27;])) {
    // In a real app we would append the submitted message to the session or DB.
    // For the classroom demo we show the flow but avoid writing raw content.
    $messages = $_SESSION[&#x27;messages&#x27;];
}

/**
 * sanitize()
 * - trim() removes leading/trailing whitespace
 * - strip_tags() removes HTML/PHP tags
 * - htmlspecialchars() escapes remaining special characters for HTML output
 *
 * This function is defensive and simple — it&#x27;s for demonstration and classroom use.
 * In production consider more context-aware measures (e.g., policies, CSP, output encoding libraries).
 */
function sanitize($value)
{
    $value = trim((string)$value);                       // trim whitespace
    $value = strip_tags($value);                        // remove HTML tags
    $value = htmlspecialchars($value, ENT_QUOTES, &#x27;UTF-8&#x27;); // escape for HTML context
    return $value;
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;Stored — Guestbook (Prevented)&lt;/title&gt;
    &lt;style&gt;.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;div1&quot;&gt;
        &lt;h1&gt;Guestbook — Prevented&lt;/h1&gt;

        &lt;form method=&quot;post&quot; action=&quot;&quot;&gt;
            &lt;input name=&quot;msg&quot; placeholder=&quot;Say hi&quot; value=&quot;Hello&quot;&gt;
            &lt;button&gt;POST&lt;/button&gt;
        &lt;/form&gt;

        &lt;ul&gt;
            &lt;?php foreach ($messages as $m): ?&gt;
                &lt;!-- SAFE: sanitize() neutralizes script tags and encodes special chars --&gt;
                &lt;li&gt;&lt;?= sanitize($m) ?&gt;&lt;/li&gt; &lt;!-- NOT VULNERABLE --&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/ul&gt;

        &lt;br&gt;
        &lt;a href=&quot;index.php&quot;&gt;Home&lt;/a&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Teaching note:</strong> the safest approach is to <strong>escape on output</strong> for the context you are rendering into. Sanitizing on input can help (reduce stored attack surface), but <strong>escaping at output</strong> is the strongest, context-specific defense.</p><hr class="py-2 my-5 translate-y-2"/><h2 id="observations" class="relative group"><span class="heading-text">Observations</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#observations" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ol start="1"><li><p>Visit <code>page1_reflect.php?q=&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</code> and then <code>page1_reflect_prevent.php?q=&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</code> — compare behavior.</p></li><li><p>Visit <code>stored_hacked.php</code> and observe the alert from the session-stored message. Then load <code>stored_hacked_prevent.php</code> to see the sanitized result.</p></li><li><p>Discuss: what happens if you put <code>onerror=&quot;...&quot;</code> into an <code>&lt;img&gt;</code> tag inside a message? (Context matters — attribute vs body.)</p></li><li><p>Discuss Content Security Policy (CSP) as a further mitigation, and why it’s complementary (not a substitute) to proper escaping.</p><hr class="py-2 my-5 translate-y-2"/></li></ol><h3 id="id-10-2025" class="relative group"><span class="heading-text">10/2025</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-2025" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><div></div></article><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/CSCI210//zxssdefendingagainstxss"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Web Programming</div>Defending Against Cross Site Scripting</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/CSCI210//zxsscontentsecuritypolicy"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Web Programming</div>Content Security Policy</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/CSCI210//build/entry.client-MRWD3U4M.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-LBXIMZTV.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-UHPLYDBO.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/CSCI210//build/root-JUJEON6X.js"/><link rel="modulepreload" href="/CSCI210//build/_shared/chunk-AUN2WW42.js"/><link rel="modulepreload" href="/CSCI210//build/routes/$-RBL63VHS.js"/><script>window.__remixContext = {"url":"/zxssexamples","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"folders":false},"nav":[],"actions":[],"projects":[{"exports":[{"format":"pdf","filename":"book.pdf","url":"/CSCI210//build/book-534e8bb868c58f09653a3aae427c5b4b.pdf"}],"title":"Web Programming","authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"github":"https://github.com/montanajim/CSCI210","copyright":"2025 By James Goudy","toc":[{"file":"zintro.md"},{"file":"zPHPIntroduction.md"},{"file":"zPHPBasics.md"},{"file":"zLoopIf.md"},{"file":"zphparrays.md"},{"file":"zFunctions.md"},{"file":"zFirstFormsPOSTandGET.md"},{"file":"zHTMLInputFieldReview.md"},{"children":[{"file":"zSessionHomeworkHint.md"}],"file":"zSessionVariables.md"},{"file":"zPDOConnections.md"},{"children":[{"file":"zPDOFirstDataDBInsertCarExample.md"},{"file":"zPDONoPlaceHoldersExample.md"},{"file":"zStringSanitation.md"}],"file":"zPHPClosingTags.md"},{"children":[{"file":"zxssExamples.md"},{"file":"zxssContentSecurityPolicy.md"}],"file":"zxssDefendingAgainstXSS.md"},{"file":"zPasswords.md"},{"file":"zAddEditDelete.md"},{"file":"zSavingPicturesInDatabase.md"},{"file":"zReadingjson.md"},{"file":"zDateFunctionPHP.md"},{"children":[{"file":"zSearchFilterSQLITE.md"}],"file":"zSQLiteGuide.md"},{"file":"zYouTubeDemo.md"}],"bibliography":[],"index":"index","pages":[{"slug":"zphpintroduction","title":"PHP Introduction","description":"","date":"","thumbnail":"/CSCI210//build/Lerdorf_2014-1763165-e05e92b24ac7fab858e580798a1d7248.JPG","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpbasics","title":"PHP Basics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zloopif","title":"Loops and If","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphparrays","title":"PHP Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfunctions","title":"Functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfirstformspostandget","title":"First Forms - POST and GET","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zhtmlinputfieldreview","title":"HTML Input Field Review","description":"","date":"","thumbnail":"/CSCI210//build/input_pix-5447e4359de92f599ada5e6d8444c974.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionvariables","title":"Session Variables","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionhomeworkhint","title":"Session Variable Homework Assignment Hint","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdoconnections","title":"PDO Connections","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpclosingtags","title":"PHP Closing Tags: Leave Them Out Or Out","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zpdofirstdatadbinsertcarexample","title":"PDO - First Data Insert - Car Example","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdonoplaceholdersexample","title":"PDO With No Named Placeholders","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zstringsanitation","title":"String Sanitation - filter_var()","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxssdefendingagainstxss","title":"Defending Against Cross Site Scripting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zxssexamples","title":"XSS Examples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxsscontentsecuritypolicy","title":"Content Security Policy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpasswords","title":"Passwords","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zaddeditdelete","title":"Add Edit Delete","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsavingpicturesindatabase","title":"Saving Pictures In Database","description":"","date":"","thumbnail":"/CSCI210//build/image-20231110172412-f6ea1fad927e6d0dca2447d64f3399ce.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zreadingjson","title":"Reading json","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zdatefunctionphp","title":"Date Function","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsqliteguide","title":"PHP + SQLite Shortcut Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsearchfiltersqlite","title":"Search Filter - SQLITE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zyoutubedemo","title":"Z You Tube Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/CSCI210/"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"folders":false},"nav":[],"actions":[],"projects":[{"exports":[{"format":"pdf","filename":"book.pdf","url":"/CSCI210//build/book-534e8bb868c58f09653a3aae427c5b4b.pdf"}],"title":"Web Programming","authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"github":"https://github.com/montanajim/CSCI210","copyright":"2025 By James Goudy","toc":[{"file":"zintro.md"},{"file":"zPHPIntroduction.md"},{"file":"zPHPBasics.md"},{"file":"zLoopIf.md"},{"file":"zphparrays.md"},{"file":"zFunctions.md"},{"file":"zFirstFormsPOSTandGET.md"},{"file":"zHTMLInputFieldReview.md"},{"children":[{"file":"zSessionHomeworkHint.md"}],"file":"zSessionVariables.md"},{"file":"zPDOConnections.md"},{"children":[{"file":"zPDOFirstDataDBInsertCarExample.md"},{"file":"zPDONoPlaceHoldersExample.md"},{"file":"zStringSanitation.md"}],"file":"zPHPClosingTags.md"},{"children":[{"file":"zxssExamples.md"},{"file":"zxssContentSecurityPolicy.md"}],"file":"zxssDefendingAgainstXSS.md"},{"file":"zPasswords.md"},{"file":"zAddEditDelete.md"},{"file":"zSavingPicturesInDatabase.md"},{"file":"zReadingjson.md"},{"file":"zDateFunctionPHP.md"},{"children":[{"file":"zSearchFilterSQLITE.md"}],"file":"zSQLiteGuide.md"},{"file":"zYouTubeDemo.md"}],"bibliography":[],"index":"index","pages":[{"slug":"zphpintroduction","title":"PHP Introduction","description":"","date":"","thumbnail":"/CSCI210//build/Lerdorf_2014-1763165-e05e92b24ac7fab858e580798a1d7248.JPG","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpbasics","title":"PHP Basics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zloopif","title":"Loops and If","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphparrays","title":"PHP Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfunctions","title":"Functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfirstformspostandget","title":"First Forms - POST and GET","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zhtmlinputfieldreview","title":"HTML Input Field Review","description":"","date":"","thumbnail":"/CSCI210//build/input_pix-5447e4359de92f599ada5e6d8444c974.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionvariables","title":"Session Variables","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionhomeworkhint","title":"Session Variable Homework Assignment Hint","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdoconnections","title":"PDO Connections","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpclosingtags","title":"PHP Closing Tags: Leave Them Out Or Out","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zpdofirstdatadbinsertcarexample","title":"PDO - First Data Insert - Car Example","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdonoplaceholdersexample","title":"PDO With No Named Placeholders","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zstringsanitation","title":"String Sanitation - filter_var()","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxssdefendingagainstxss","title":"Defending Against Cross Site Scripting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zxssexamples","title":"XSS Examples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxsscontentsecuritypolicy","title":"Content Security Policy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpasswords","title":"Passwords","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zaddeditdelete","title":"Add Edit Delete","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsavingpicturesindatabase","title":"Saving Pictures In Database","description":"","date":"","thumbnail":"/CSCI210//build/image-20231110172412-f6ea1fad927e6d0dca2447d64f3399ce.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zreadingjson","title":"Reading json","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zdatefunctionphp","title":"Date Function","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsqliteguide","title":"PHP + SQLite Shortcut Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsearchfiltersqlite","title":"Search Filter - SQLITE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zyoutubedemo","title":"Z You Tube Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"project":{"exports":[{"format":"pdf","filename":"book.pdf","url":"/CSCI210//build/book-534e8bb868c58f09653a3aae427c5b4b.pdf"}],"title":"Web Programming","authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"github":"https://github.com/montanajim/CSCI210","copyright":"2025 By James Goudy","toc":[{"file":"zintro.md"},{"file":"zPHPIntroduction.md"},{"file":"zPHPBasics.md"},{"file":"zLoopIf.md"},{"file":"zphparrays.md"},{"file":"zFunctions.md"},{"file":"zFirstFormsPOSTandGET.md"},{"file":"zHTMLInputFieldReview.md"},{"children":[{"file":"zSessionHomeworkHint.md"}],"file":"zSessionVariables.md"},{"file":"zPDOConnections.md"},{"children":[{"file":"zPDOFirstDataDBInsertCarExample.md"},{"file":"zPDONoPlaceHoldersExample.md"},{"file":"zStringSanitation.md"}],"file":"zPHPClosingTags.md"},{"children":[{"file":"zxssExamples.md"},{"file":"zxssContentSecurityPolicy.md"}],"file":"zxssDefendingAgainstXSS.md"},{"file":"zPasswords.md"},{"file":"zAddEditDelete.md"},{"file":"zSavingPicturesInDatabase.md"},{"file":"zReadingjson.md"},{"file":"zDateFunctionPHP.md"},{"children":[{"file":"zSearchFilterSQLITE.md"}],"file":"zSQLiteGuide.md"},{"file":"zYouTubeDemo.md"}],"bibliography":[],"index":"index","pages":[{"slug":"zphpintroduction","title":"PHP Introduction","description":"","date":"","thumbnail":"/CSCI210//build/Lerdorf_2014-1763165-e05e92b24ac7fab858e580798a1d7248.JPG","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpbasics","title":"PHP Basics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zloopif","title":"Loops and If","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphparrays","title":"PHP Arrays","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfunctions","title":"Functions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zfirstformspostandget","title":"First Forms - POST and GET","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zhtmlinputfieldreview","title":"HTML Input Field Review","description":"","date":"","thumbnail":"/CSCI210//build/input_pix-5447e4359de92f599ada5e6d8444c974.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionvariables","title":"Session Variables","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsessionhomeworkhint","title":"Session Variable Homework Assignment Hint","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdoconnections","title":"PDO Connections","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zphpclosingtags","title":"PHP Closing Tags: Leave Them Out Or Out","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zpdofirstdatadbinsertcarexample","title":"PDO - First Data Insert - Car Example","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpdonoplaceholdersexample","title":"PDO With No Named Placeholders","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zstringsanitation","title":"String Sanitation - filter_var()","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxssdefendingagainstxss","title":"Defending Against Cross Site Scripting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zxssexamples","title":"XSS Examples","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zxsscontentsecuritypolicy","title":"Content Security Policy","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zpasswords","title":"Passwords","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zaddeditdelete","title":"Add Edit Delete","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsavingpicturesindatabase","title":"Saving Pictures In Database","description":"","date":"","thumbnail":"/CSCI210//build/image-20231110172412-f6ea1fad927e6d0dca2447d64f3399ce.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zreadingjson","title":"Reading json","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zdatefunctionphp","title":"Date Function","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsqliteguide","title":"PHP + SQLite Shortcut Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"zsearchfiltersqlite","title":"Search Filter - SQLITE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zyoutubedemo","title":"Z You Tube Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]},"page":{"version":2,"kind":"Article","sha256":"f07f38bbe57abe2079a9c1be16d0058b8b72034f8ae2e405971ab67b3519863f","slug":"zxssexamples","location":"/zxssExamples.md","dependencies":[],"frontmatter":{"title":"XSS Examples","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"github":"https://github.com/montanajim/CSCI210","copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"zxssExamples.md","url":"/CSCI210//build/zxssExamples-0aedf5ce712cc67e0f6b7e0e38b8c86a.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This short chapter demonstrates two common XSS scenarios and how to fix them:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X1zj5l7UCB"}],"key":"CnSWxIrgY4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Reflected XSS","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZI4uZ7cwR5"}],"key":"sO3fYTl9Kj"},{"type":"text","value":" — user input (from the query string) is immediately written back into the page. The vulnerable example prints the raw query value; the fixed example escapes it with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZJ6K5BIUin"},{"type":"inlineCode","value":"htmlspecialchars","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D5GwRDc3gC"},{"type":"text","value":" so any injected ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"u4nHgKFdPf"},{"type":"inlineCode","value":"\u003cscript\u003e","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xGacjs770S"},{"type":"text","value":" becomes harmless text.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NH918fNfFi"}],"key":"WZKAOC5CXl"}],"key":"mx9EwZTvUI"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Stored XSS (toy guestbook)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hpS6wbIHM1"}],"key":"ATLKwTQ3IG"},{"type":"text","value":" — a user-submitted message is stored in session and later rendered for all visitors. The vulnerable example renders the raw stored value, which will execute in the browser. The fixed example sanitizes stored values on output using a small ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XHcz1tfg17"},{"type":"inlineCode","value":"sanitize()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"keLEOmZvjT"},{"type":"text","value":" helper that performs ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"srjdX2cfTy"},{"type":"inlineCode","value":"trim()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"plH9JqOX2h"},{"type":"text","value":", ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jUUgxoUgJY"},{"type":"inlineCode","value":"strip_tags()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yzuMGTnhHH"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ufPDS5Ttg5"},{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bHvzbDSwn0"},{"type":"text","value":" (ENT_QUOTES, UTF-8).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EvlbqfIvGb"}],"key":"WkanLApCuH"}],"key":"ePSQWdpXbm"}],"key":"U6QzwrsWIZ"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Read the inline comments — I call out the vulnerable lines and explain the remediation. Use these pages in a classroom or lab to safely demonstrate how an attacker’s ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"s1ergcy6XB"},{"type":"inlineCode","value":"\u003cscript\u003e","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"m5pXY2EdfX"},{"type":"text","value":" turns into harmless text once properly escaped.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jV8Xo3dkkK"}],"key":"O1ezSdMdPr"},{"type":"thematicBreak","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lHpBKVaPWp"},{"type":"heading","depth":2,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"inlineCode","value":"index.php","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DfUfoRHcdL"},{"type":"text","value":" — home page with demo links","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PDFFrQyixE"}],"identifier":"index-php-home-page-with-demo-links","label":"index.php — home page with demo links","html_id":"index-php-home-page-with-demo-links","implicit":true,"key":"lDm22Dk8r8"},{"type":"code","lang":"php","value":"\u003c?php\n// index.php\n// Simple landing page linking to the vulnerable and fixed demo pages.\n//\n// This file is purely HTML. Links include an example exploit payload to\n// illustrate how a reflected XSS payload would look in the query string.\n?\u003e\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\" /\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\" /\u003e\n    \u003ctitle\u003eXSS Home Demo\u003c/title\u003e\n    \u003cstyle\u003e\n        .div1 {\n            width: 50%;\n            background-color: cornsilk;\n            margin: 50px auto 0 auto;\n            padding: 1rem;\n            border-radius: 6px;\n            font-family: system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial;\n        }\n        a { display:block; margin:8px 0; }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"div1\"\u003e\n        \u003ch1\u003eXSS Demos\u003c/h1\u003e\n\n        \u003c!--\n          The query string contains a classic demo payload:\n          ?q=\u003cscript\u003ealert('Hacked')\u003c/script\u003e\n        --\u003e\n        \u003ca href=\"page1_reflect.php?q=\u003cscript\u003ealert('Hacked')\u003c/script\u003e\"\u003e\n            Page 1 — Reflect (VULNERABLE)\n        \u003c/a\u003e\n\n        \u003ca href=\"page1_reflect_prevent.php?q=\u003cscript\u003ealert('Hacked')\u003c/script\u003e\"\u003e\n            Page 1 — Reflect (Prevented)\n        \u003c/a\u003e\n\n        \u003ca href=\"stored_hacked.php\"\u003eStored — Guestbook (VULNERABLE)\u003c/a\u003e\n        \u003ca href=\"stored_hacked_prevent.php\"\u003eStored — Guestbook (Prevented)\u003c/a\u003e\n\n        \u003ca href=\"index.php\"\u003eHome\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","position":{"start":{"line":14,"column":1},"end":{"line":63,"column":1}},"key":"d6lRAeVykQ"},{"type":"thematicBreak","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"pr3Iu7Ul4J"},{"type":"heading","depth":2,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"inlineCode","value":"page1_reflect.php","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"tZnXSbDQUb"},{"type":"text","value":" — ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"GxCqYrFJOr"},{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"vulnerable","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"GhmEl5OaG9"}],"key":"T2B9MwlQZT"},{"type":"text","value":" reflected XSS (don’t use in production)","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"CzPkeL4ETt"}],"identifier":"page1-reflect-php-vulnerable-reflected-xss-dont-use-in-production","label":"page1_reflect.php — vulnerable reflected XSS (don’t use in production)","html_id":"page1-reflect-php-vulnerable-reflected-xss-dont-use-in-production","implicit":true,"key":"M31RzSUoEL"},{"type":"code","lang":"php","value":"\u003c?php\n// page1_reflect.php\n// Demonstrates reflected XSS by echoing a query parameter directly.\n// *** VULNERABLE: the raw $q value is injected into the HTML output. ***\n\n// Use null coalescing so page still works without ?q= in the URL.\n$q = $_GET['q'] ?? '';\n?\u003e\n\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\" /\u003e\n    \u003ctitle\u003eHacked (Reflect - Vulnerable)\u003c/title\u003e\n    \u003cstyle\u003e\n        .div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"div1\"\u003e\n        \u003ch1\u003eSearch\u003c/h1\u003e\n\n        \u003c!-- VULNERABLE LINE: raw echo of user input --\u003e\n        \u003c!-- If q contains \u003cscript\u003e... it will run in the visitor's browser. --\u003e\n        \u003cp\u003eYou searched for: \u003c?= $q ?\u003e\u003c/p\u003e \u003c!-- VULNERABLE --\u003e\n\n        \u003cbr\u003e\n        \u003ca href=\"index.php\"\u003eHome\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","position":{"start":{"line":69,"column":1},"end":{"line":100,"column":1}},"key":"IWFRVrUd8B"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"strong","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Teaching note:","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"MKvVmaVSGL"}],"key":"NRRTSzhfci"},{"type":"text","value":" open ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"LwlZlBTC2P"},{"type":"inlineCode","value":"page1_reflect.php?q=\u003cscript\u003ealert('Hacked')\u003c/script\u003e","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"pKv8c8p6L7"},{"type":"text","value":" to see how an attacker-supplied ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"UqvY9CCoS4"},{"type":"inlineCode","value":"\u003cscript\u003e","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"BANmAke7qf"},{"type":"text","value":" executes. The vulnerability comes from outputting unescaped input into an HTML context.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"se3J0TLWdZ"}],"key":"mxWBXZ7moL"},{"type":"thematicBreak","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"fTKhBJtfsP"},{"type":"heading","depth":2,"position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"inlineCode","value":"page1_reflect_prevent.php","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"d8uLofaH8V"},{"type":"text","value":" — reflected XSS ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"UosMFt4Jn4"},{"type":"strong","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"fixed","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Ig7Ns6h629"}],"key":"xGsmJgPfdk"}],"identifier":"page1-reflect-prevent-php-reflected-xss-fixed","label":"page1_reflect_prevent.php — reflected XSS fixed","html_id":"page1-reflect-prevent-php-reflected-xss-fixed","implicit":true,"key":"Y7XS2rDcSc"},{"type":"code","lang":"php","value":"\u003c?php\n// page1_reflect_prevent.php\n// Fixed version of reflected XSS demo. Escape output with htmlspecialchars\n// so any HTML tags supplied in the query string are rendered as text.\n\n$q = $_GET['q'] ?? '';\n\n// Use a small helper for clarity (context-aware escaping for HTML).\nfunction e($s) {\n    // ENT_QUOTES encodes both double and single quotes.\n    // 'UTF-8' ensures proper encoding for multibyte characters.\n    return htmlspecialchars((string)$s, ENT_QUOTES, 'UTF-8');\n}\n?\u003e\n\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\" /\u003e\n    \u003ctitle\u003eHacked (Reflect - Prevented)\u003c/title\u003e\n    \u003cstyle\u003e.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"div1\"\u003e\n        \u003ch1\u003eSearch\u003c/h1\u003e\n\n        \u003c!-- SAFE OUTPUT: any \u003c or \u003e in $q are converted to \u0026lt; \u0026gt; --\u003e\n        \u003cp\u003eYou searched for: \u003c?= e($q) ?\u003e\u003c/p\u003e \u003c!-- NOT VULNERABLE --\u003e\n\n        \u003cbr\u003e\n        \u003ca href=\"index.php\"\u003eHome\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","position":{"start":{"line":108,"column":1},"end":{"line":142,"column":1}},"key":"eE6jJC6KoG"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"strong","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"Teaching note:","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"Ptk7WvQfj0"}],"key":"tkr4WUQKuM"},{"type":"text","value":" ","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"yzze2FWap7"},{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"sNKxR1VQyh"},{"type":"text","value":" is the appropriate escape for HTML body content. If you output into other contexts (e.g., attribute, JS, CSS, URL) you must use a different encoding or a trusted library for context-aware encoding.","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"BXSVQrkDR5"}],"key":"RiFJACuL3m"},{"type":"thematicBreak","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"ng2Hm1sTTi"},{"type":"heading","depth":2,"position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"inlineCode","value":"stored_hacked.php","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"d57z73BD6k"},{"type":"text","value":" — ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"vJ5nwLBP39"},{"type":"strong","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"vulnerable","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"Zk2cnVN9r6"}],"key":"OjjF5DbqB3"},{"type":"text","value":" stored XSS guestbook","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"mE7pOoZn6Y"}],"identifier":"stored-hacked-php-vulnerable-stored-xss-guestbook","label":"stored_hacked.php — vulnerable stored XSS guestbook","html_id":"stored-hacked-php-vulnerable-stored-xss-guestbook","implicit":true,"key":"J1bhxVAk4v"},{"type":"code","lang":"php","value":"\u003c?php\n// stored_hacked.php\n// Toy guestbook that demonstrates stored XSS by rendering session-stored messages\n// without escaping them. DO NOT deploy this as-is.\n\nsession_start();\n\n// Place a malicious demo message in session to simulate previously stored content.\n$_SESSION['messages'] = [\"\u003cscript\u003ealert('hacked stored!')\u003c/script\u003e\"];\n\n// Load messages for display.\n$messages = $_SESSION['messages'] ?? [];\n\n// If the user posts something, the code below intentionally follows your original\n// request: keep the `if (!empty($_POST['msg']))` check exactly as provided.\nif (!empty($_POST['msg'])) {\n    // NOTE: this block is intentionally left minimal to match the original demo.\n    // In the vulnerable demo we would append raw values to the messages array.\n    // For clarity we simply reload messages here (no safe write).\n    $messages = $_SESSION['messages'];\n}\n?\u003e\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\" /\u003e\n    \u003ctitle\u003eStored — Guestbook (Vulnerable)\u003c/title\u003e\n    \u003cstyle\u003e.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"div1\"\u003e\n        \u003ch1\u003eGuestbook\u003c/h1\u003e\n\n        \u003c!-- Simple form to demonstrate posting --\u003e\n        \u003cform method=\"post\" action=\"\"\u003e\n            \u003cinput name=\"msg\" placeholder=\"Say hi\" value=\"Hello\"\u003e\n            \u003cbutton\u003ePOST\u003c/button\u003e\n        \u003c/form\u003e\n\n        \u003cul\u003e\n            \u003c?php foreach ($messages as $m): ?\u003e\n                \u003c!-- VULNERABLE: stored messages are printed raw, so a stored \u003cscript\u003e will execute --\u003e\n                \u003cli\u003e\u003c?= (string) $m ?\u003e\u003c/li\u003e \u003c!-- VULNERABLE --\u003e\n            \u003c?php endforeach; ?\u003e\n        \u003c/ul\u003e\n\n        \u003cbr\u003e\n        \u003ca href=\"index.php\"\u003eHome\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","position":{"start":{"line":150,"column":1},"end":{"line":202,"column":1}},"key":"fllOt4lbfW"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"strong","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Teaching note:","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"GrCQbKgYYo"}],"key":"LUU4xbm4G0"},{"type":"text","value":" Stored XSS occurs when untrusted data is persisted (database, session, file) and later served to users without cleaning/escaping. The attack becomes more dangerous because many visitors might execute the injected script.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"v3vJ6l2sv2"}],"key":"gyAlcU2VXc"},{"type":"thematicBreak","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"z0ahbjKX1X"},{"type":"heading","depth":2,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"inlineCode","value":"stored_hacked_prevent.php","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"OFt0qW8vIJ"},{"type":"text","value":" — stored XSS ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"EH5xBEF82a"},{"type":"strong","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"prevented","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"GP7WzxoKuZ"}],"key":"WKsM3DRORZ"},{"type":"text","value":" (sanitizing on output)","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"akWQUGf53f"}],"identifier":"stored-hacked-prevent-php-stored-xss-prevented-sanitizing-on-output","label":"stored_hacked_prevent.php — stored XSS prevented (sanitizing on output)","html_id":"stored-hacked-prevent-php-stored-xss-prevented-sanitizing-on-output","implicit":true,"key":"ULCXJK5QLU"},{"type":"code","lang":"php","value":"\u003c?php\n// stored_hacked_prevent.php\n// Prevents stored XSS by escaping/sanitizing messages before output.\n// Uses the same `if (!empty($_POST['msg']))` check as requested.\n\nsession_start();\n\n// Demo initial message that simulates previously stored malicious content.\n$_SESSION['messages'] = [\"\u003cscript\u003ealert('hacked stored!')\u003c/script\u003e\"];\n\n// Retrieve messages array from session\n$messages = $_SESSION['messages'] ?? [];\n\n// Keep original check as requested (no substitution)\nif (!empty($_POST['msg'])) {\n    // In a real app we would append the submitted message to the session or DB.\n    // For the classroom demo we show the flow but avoid writing raw content.\n    $messages = $_SESSION['messages'];\n}\n\n/**\n * sanitize()\n * - trim() removes leading/trailing whitespace\n * - strip_tags() removes HTML/PHP tags\n * - htmlspecialchars() escapes remaining special characters for HTML output\n *\n * This function is defensive and simple — it's for demonstration and classroom use.\n * In production consider more context-aware measures (e.g., policies, CSP, output encoding libraries).\n */\nfunction sanitize($value)\n{\n    $value = trim((string)$value);                       // trim whitespace\n    $value = strip_tags($value);                        // remove HTML tags\n    $value = htmlspecialchars($value, ENT_QUOTES, 'UTF-8'); // escape for HTML context\n    return $value;\n}\n?\u003e\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"utf-8\" /\u003e\n    \u003ctitle\u003eStored — Guestbook (Prevented)\u003c/title\u003e\n    \u003cstyle\u003e.div1 { width:50%; background:cornsilk; margin:50px auto; padding:1rem; }\u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"div1\"\u003e\n        \u003ch1\u003eGuestbook — Prevented\u003c/h1\u003e\n\n        \u003cform method=\"post\" action=\"\"\u003e\n            \u003cinput name=\"msg\" placeholder=\"Say hi\" value=\"Hello\"\u003e\n            \u003cbutton\u003ePOST\u003c/button\u003e\n        \u003c/form\u003e\n\n        \u003cul\u003e\n            \u003c?php foreach ($messages as $m): ?\u003e\n                \u003c!-- SAFE: sanitize() neutralizes script tags and encodes special chars --\u003e\n                \u003cli\u003e\u003c?= sanitize($m) ?\u003e\u003c/li\u003e \u003c!-- NOT VULNERABLE --\u003e\n            \u003c?php endforeach; ?\u003e\n        \u003c/ul\u003e\n\n        \u003cbr\u003e\n        \u003ca href=\"index.php\"\u003eHome\u003c/a\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e","position":{"start":{"line":210,"column":1},"end":{"line":276,"column":1}},"key":"cmKfnGClS8"},{"type":"paragraph","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"strong","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"Teaching note:","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"eyrrKB51UT"}],"key":"REN6CUZNex"},{"type":"text","value":" the safest approach is to ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"AY251ccDVS"},{"type":"strong","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"escape on output","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"ISrPy85gE8"}],"key":"hpF1TKCfou"},{"type":"text","value":" for the context you are rendering into. Sanitizing on input can help (reduce stored attack surface), but ","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"yQ42xNTMTD"},{"type":"strong","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"text","value":"escaping at output","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"AhfwWOV2eH"}],"key":"fho16725Kf"},{"type":"text","value":" is the strongest, context-specific defense.","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"sMlGi16cg7"}],"key":"bnXdH8GErX"},{"type":"thematicBreak","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"KSNTmRJccT"},{"type":"heading","depth":2,"position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"Observations","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"PxqkgBEVrP"}],"identifier":"observations","label":"Observations","html_id":"observations","implicit":true,"key":"cvwRbzugez"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":284,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":284,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"Visit ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"XlRrNjY36t"},{"type":"inlineCode","value":"page1_reflect.php?q=\u003cscript\u003ealert('XSS')\u003c/script\u003e","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"y44cD1s5bB"},{"type":"text","value":" and then ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"jqaclzsZ3c"},{"type":"inlineCode","value":"page1_reflect_prevent.php?q=\u003cscript\u003ealert('XSS')\u003c/script\u003e","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"bft1ZVA03n"},{"type":"text","value":" — compare behavior.","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"L4G64cVLTB"}],"key":"Dk7aWuzXWc"}],"key":"HPskoh5zW0"},{"type":"listItem","spread":true,"position":{"start":{"line":286,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"Visit ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"vLao5DbzNW"},{"type":"inlineCode","value":"stored_hacked.php","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"xOma5YYQ7S"},{"type":"text","value":" and observe the alert from the session-stored message. Then load ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"LbJpiZYzuq"},{"type":"inlineCode","value":"stored_hacked_prevent.php","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"LLEoq7NWYt"},{"type":"text","value":" to see the sanitized result.","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"CiIn8vUlLZ"}],"key":"Vd44cyEcE4"}],"key":"HHyjYtEdM7"},{"type":"listItem","spread":true,"position":{"start":{"line":288,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"Discuss: what happens if you put ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"J9esbTzCts"},{"type":"inlineCode","value":"onerror=\"...\"","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"CPGhJ3zkjo"},{"type":"text","value":" into an ","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"ej3bsXlJE9"},{"type":"inlineCode","value":"\u003cimg\u003e","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"GEeVmXjncR"},{"type":"text","value":" tag inside a message? (Context matters — attribute vs body.)","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"FHCJJCzxeI"}],"key":"LuVhtAfd3J"}],"key":"q9T0bdKd9f"},{"type":"listItem","spread":true,"position":{"start":{"line":290,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"Discuss Content Security Policy (CSP) as a further mitigation, and why it’s complementary (not a substitute) to proper escaping.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"On4xYjnA8I"}],"key":"fULlme9qoI"},{"type":"thematicBreak","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"hVQZvZ7Yhg"}],"key":"T895tFGqmw"}],"key":"EyDRmFNIYl"},{"type":"heading","depth":3,"position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"Gfe0k54o8w"}],"identifier":"id-10-2025","label":"10/2025","html_id":"id-10-2025","implicit":true,"key":"FTFSp3Pzau"}],"key":"O6WdcnjhOh"}],"key":"GgRMr5uQjZ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Defending Against Cross Site Scripting","url":"/zxssdefendingagainstxss","group":"Web Programming"},"next":{"title":"Content Security Policy","url":"/zxsscontentsecuritypolicy","group":"Web Programming"}}},"domain":"http://localhost:3002"}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/CSCI210//build/manifest-DB24CD34.js";
import * as route0 from "/CSCI210//build/root-JUJEON6X.js";
import * as route1 from "/CSCI210//build/routes/$-RBL63VHS.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/CSCI210//build/entry.client-MRWD3U4M.js");</script></body></html>