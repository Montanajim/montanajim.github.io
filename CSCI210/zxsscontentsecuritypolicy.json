{"version":2,"kind":"Article","sha256":"f4691d2f29d65dc97fed15efe85f83004b1c976404fbb9167a5491fcec0cf73d","slug":"zxsscontentsecuritypolicy","location":"/zxssContentSecurityPolicy.md","dependencies":[],"frontmatter":{"title":"Content Security Policy","content_includes_title":false,"exports":[{"format":"md","filename":"zxssContentSecurityPolicy.md","url":"CSCI210/build/zxssContentSecurityP-e6822298b1a043bda0f398b4b2a2b4e1.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Browser’s Bodyguard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L8i8HeVtZI"}],"key":"xbGijwjg74"}],"identifier":"the-browsers-bodyguard","label":"The Browser’s Bodyguard","html_id":"the-browsers-bodyguard","implicit":true,"key":"hoOW1BDh9d"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the constant duel between security and convenience, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LcGxFg8eSs"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oYY7320TgB"}],"key":"eBBEvABIEQ"},{"type":"text","value":" remains a classic ambush. Developers defend their web pages with careful ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lx45rqCQL2"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"escaping","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sQOxPqfKAk"}],"key":"AEZdTHJMWb"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"H10q6uKSG7"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"validation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cTAZ2R8VmU"}],"key":"pQaCivtW9I"},{"type":"text","value":", but even the best code occasionally slips. That’s where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wsc56u0uRA"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Content Security Policy (CSP)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a40jKVLQtq"}],"key":"B16776Ix4q"},{"type":"text","value":" steps in — not as a replacement, but as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Lhj6Jt6xQB"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"complementary layer of armor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"akkn94BbOe"}],"key":"V3RBloaJG7"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gJYO1jhYTr"}],"key":"x6qt2s9BqW"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"G7vW7aJjmE"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. What is Content Security Policy (CSP)?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eAaI4acduh"}],"key":"GA1beXT5vP"}],"identifier":"id-1-what-is-content-security-policy-csp","label":"1. What is Content Security Policy (CSP)?","html_id":"id-1-what-is-content-security-policy-csp","implicit":true,"key":"mvhloxgi69"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YzOcSrw7Px"}],"key":"jeh6fEKXiC"},{"type":"text","value":" is an HTTP response header that acts as a browser-enforced whitelist. It tells the browser ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GmmTpAgX83"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vWMAv3yCSv"}],"key":"MMuj3QX3TW"},{"type":"text","value":" which sources of scripts, styles, images, fonts, and frames are trusted — and blocks everything else.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MKJW0ktbPG"}],"key":"ZozFAYCulj"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In essence, CSP transforms the browser from a passive renderer into an active security guard.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Xk5VYbFw8N"}],"key":"BFZO5aQ5bz"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hxSrZDSVlr"}],"key":"YVnHTSjs77"}],"key":"TtA6xHQ37L"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"KFhN9urCcN"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"This directive means:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"G2jaPM2N0V"}],"key":"JoTjHTSVqY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All content must come from the same origin (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"H4aemXvMHF"},{"type":"inlineCode","value":"'self'","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"bvC0wpVQjA"},{"type":"text","value":").","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"MJUxCJpBRj"}],"key":"hn9GByoKdP"}],"key":"waocvFy8pu"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"JavaScript may also load from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"JdpcJiIF8b"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"jsDelivr","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"rmtWWSub6b"}],"key":"bbgjXDdfNv"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"k8SwNkpvJr"}],"key":"j6HFcxdklv"}],"key":"Jnrk0WdBTV"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plugins and embedded objects (like Flash or Java applets) are entirely forbidden.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"DxUVQjBu0W"}],"key":"nbiTAufluv"}],"key":"pNQPM7CpS8"}],"key":"SglwZSxaTU"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The result: even if an attacker injects a malicious ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"CpLF3euewD"},{"type":"inlineCode","value":"<script>","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"WmGDGYLKHg"},{"type":"text","value":" tag, the browser refuses to execute it because it’s not on the approved list.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"KYheHh3tvV"}],"key":"DUfaDlAIkF"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"kxzIto8evT"},{"type":"heading","depth":2,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2. Why CSP is Complementary, Not a Substitute","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"LMEL8htWSv"}],"key":"j1cPFm1cNe"}],"identifier":"id-2-why-csp-is-complementary-not-a-substitute","label":"2. Why CSP is Complementary, Not a Substitute","html_id":"id-2-why-csp-is-complementary-not-a-substitute","implicit":true,"key":"dDG8wf7xXa"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"It’s tempting to treat CSP as a magic fix for XSS — but that would be a mistake.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"f5NPVHBS6J"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Escaping and validation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"jZkgC9uYUN"}],"key":"d3N7bSGhNw"},{"type":"text","value":" remain your ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"RKDbLgbXfF"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"primary defense","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"RPSkTwn1ZS"}],"key":"A6vunP8Xb4"},{"type":"text","value":"; CSP simply limits the damage if something slips through.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"rbUiKXFxf8"}],"key":"fkGgCTQ5mm"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Here’s why they must work hand-in-hand:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"xR9qOVocJN"}],"key":"iH31kmndop"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":38,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"CSP restricts behavior, not content.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"OTVUEQYOGd"}],"key":"LYk2NufS4g"},{"type":"text","value":"\nIt tells the browser what to load, but it can’t sanitize data. Escaping neutralizes harmful input before it ever reaches the browser.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Q1477PFS3D"}],"key":"rGf9j5yVoD"}],"key":"vcvQSf8sus"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Misconfigurations happen.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"Em2YJ93qK1"}],"key":"KFmoINBU8X"},{"type":"text","value":"\nA single misplaced ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ctyCYYjQ6n"},{"type":"inlineCode","value":"'unsafe-inline'","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FfMhqmjz40"},{"type":"text","value":" or forgotten domain can open the gates again. Proper escaping ensures that even missteps in policy remain survivable.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"SXldmbafTh"}],"key":"MPP3jD7pmh"}],"key":"k4THIw9u6Z"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Browser support varies.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"mlZcGJOlvL"}],"key":"PE8y2GhTWG"},{"type":"text","value":"\nOlder or embedded browsers may ignore parts of CSP. Escaping works everywhere.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"zd3OPAPLZm"}],"key":"BsAmB6iw46"}],"key":"FageBdO5RV"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Defense in depth.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"bYmxZMFgmN"}],"key":"LwINwMPJWp"},{"type":"text","value":"\nSecurity thrives on redundancy. Escaping stops bad data; CSP catches anything that somehow sneaks through.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"xlfbbfe0q9"}],"key":"eEMBRbqIYo"}],"key":"bdpP6JfZeN"}],"key":"U3OQ0cwbpP"},{"type":"blockquote","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Think of escaping as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"x1ckdMbdta"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"locking the door","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"StDSc7lde3"}],"key":"UA7flMQIvt"},{"type":"text","value":", and CSP as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"W05hXaiTUw"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"posting a guard outside","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"nh53UexfKS"}],"key":"xpMtW0U2yx"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ZfxcKIsnX1"}],"key":"hhuIkdF6sW"}],"key":"LdJ0F67ogZ"},{"type":"thematicBreak","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ZJL6pjMudr"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3. Where and How to Apply a CSP Header","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"SVHUo8FQYS"}],"key":"I5wHbaSNNP"}],"identifier":"id-3-where-and-how-to-apply-a-csp-header","label":"3. Where and How to Apply a CSP Header","html_id":"id-3-where-and-how-to-apply-a-csp-header","implicit":true,"key":"AmoccLiW6Y"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"CSP is enforced by the browser but delivered by your server. You set it as an ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"zllrjttCNZ"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"HTTP response header","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"N5OK5VcMCQ"}],"key":"GZ1Z0DPIZy"},{"type":"text","value":", usually through your web server configuration or application code.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"EQSF8TJfY6"}],"key":"hLZrW4J0ae"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Apache Example","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"o5pBvWUNdM"}],"key":"eYHjcuVqvJ"}],"identifier":"apache-example","label":"Apache Example","html_id":"apache-example","implicit":true,"key":"Cu5pVrvqjj"},{"type":"code","lang":"apache","value":"Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\"","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"key":"Ia7ZrzgOaI"},{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Nginx Example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"cT0aa04ohG"}],"key":"eknxhSjeKA"}],"identifier":"nginx-example","label":"Nginx Example","html_id":"nginx-example","implicit":true,"key":"cMIdnmIoBM"},{"type":"code","lang":"nginx","value":"add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\";","position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"key":"MRTY2cVPDz"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"PHP Example","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"TzewlXRmJF"}],"key":"I5EkxCoVvk"}],"identifier":"php-example","label":"PHP Example","html_id":"php-example","implicit":true,"key":"x21I3KiIZt"},{"type":"code","lang":"php","value":"<?php\nheader(\"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\");\n?>","position":{"start":{"line":69,"column":1},"end":{"line":73,"column":1}},"key":"ky2yX3IXER"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"(Place this before any HTML output so the header is sent correctly.)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"HvdeLkRQ9w"}],"key":"Y3KRFj2uoo"}],"key":"PjdJJ8ZFqI"},{"type":"thematicBreak","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"H9ByperIgI"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"4. The Meta Tag — A Limited Alternative","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"UhKbtITwVH"}],"key":"tXtqaEdzRo"}],"identifier":"id-4-the-meta-tag-a-limited-alternative","label":"4. The Meta Tag — A Limited Alternative","html_id":"id-4-the-meta-tag-a-limited-alternative","implicit":true,"key":"P3i8F75dWp"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"When you can’t modify server headers (for instance, on a static host or learning environment), CSP can also be added via a ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"FO8cGL7WKh"},{"type":"inlineCode","value":"<meta>","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"RvLM37i1La"},{"type":"text","value":" tag:","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"cMJPs2lUt9"}],"key":"rQjrs5YukT"},{"type":"code","lang":"html","value":"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'\">","position":{"start":{"line":83,"column":1},"end":{"line":85,"column":1}},"key":"unxT2sMaYv"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"This works only for the current document and has limited enforcement power. It’s fine for classroom demos or single pages, but in production, always use the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"YuULInTOih"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"HTTP header","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"celN9vdot2"}],"key":"xxu3f3t6vW"},{"type":"text","value":" form.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"d1ypdAMpEz"}],"key":"WBmtsQz0bI"},{"type":"thematicBreak","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"KlDBRnSvfN"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"5. Building a Policy in Practice","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"eMElmjPHCc"}],"key":"jeoE2FESgR"}],"identifier":"id-5-building-a-policy-in-practice","label":"5. Building a Policy in Practice","html_id":"id-5-building-a-policy-in-practice","implicit":true,"key":"j9Pllm3TRP"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Start simple, test carefully, then tighten. CSP has a ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"AId6cWLw7c"},{"type":"emphasis","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"report-only","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"B2utaV9mcH"}],"key":"RFgayFaA4T"},{"type":"text","value":" mode that allows you to test your policy without breaking your site:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"l4tPhg85PF"}],"key":"ERM9RlhoSH"},{"type":"code","lang":"http","value":"Content-Security-Policy-Report-Only: default-src 'self';","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"key":"cKTkcFoV8I"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"You can even log violations to a monitoring endpoint:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"fVt91hEVJS"}],"key":"I57MCS2uFS"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; report-uri /csp-violation-report-endpoint/;","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"key":"B85fIaeLg7"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This iterative approach lets you fine-tune your policy safely before enforcement.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"KorXYOWr6v"}],"key":"li4b08tuXK"},{"type":"thematicBreak","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"o9GnlnwyYR"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"6. The Belt and Suspenders Philosophy","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"LVzaqFwLy6"}],"key":"m4Ge1lLYtA"}],"identifier":"id-6-the-belt-and-suspenders-philosophy","label":"6. The Belt and Suspenders Philosophy","html_id":"id-6-the-belt-and-suspenders-philosophy","implicit":true,"key":"GH6WzJmRNc"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Security is strongest when multiple defenses overlap.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"pQFs9mFgGg"}],"key":"XbzLqWcZoH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"VFPRaucfg1"}],"key":"fe3EKmAlzl"},{"type":"text","value":": Removes or neutralizes malicious input.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"jz5pEJC9X8"}],"key":"CEm5bWJ2Jj"}],"key":"crdnytwnWT"},{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"Nxv80CjhPr"}],"key":"PleN8KLOqN"},{"type":"text","value":": Ensures only expected data enters the system.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"qNCMEYRm5E"}],"key":"A0l5OckdLO"}],"key":"NhBTm0aaOM"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"ib5csLX9KC"}],"key":"kDpPxwsm5E"},{"type":"text","value":": Stops execution or loading of untrusted resources.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"XrxU3p8g1W"}],"key":"zoh3rswlBF"}],"key":"d3C20rw9bG"}],"key":"rNv9RSWNap"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Together, they form a resilient shield that protects your users, your data, and your reputation.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"jn7vI98Qjl"}],"key":"GZGNmTMt7N"},{"type":"blockquote","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Proper escaping is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Zmxl8lfCND"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"brakes","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"H7l7KqEzjN"}],"key":"guRwB0H640"},{"type":"text","value":";\nCSP is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"wLv0aXmH9M"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"iWzL55qefb"}],"key":"s8VleX6cP8"},{"type":"text","value":".\nYou need both to stay safe on the open web.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Jj2Wk5GnTk"}],"key":"N5M5iYhqN4"}],"key":"ZCFPz7N686"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"OoKkX4vYk6"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Summary Checklist","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"WjCUL9qsxc"}],"key":"xKc1q28ICm"}],"identifier":"summary-checklist","label":"Summary Checklist","html_id":"summary-checklist","implicit":true,"key":"Okbjsz6ytD"},{"type":"table","position":{"start":{"line":127,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"UzCRDnU9m4"}],"key":"OqlZF7z5sK"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"jiOwOEEIjW"}],"key":"Jx5yN2QTO5"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"TGKzdMwN8T"}],"key":"crebbnhkda"}],"key":"Oy6QgiWNyV"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Escape Output","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"pIY0mwy99T"}],"key":"Hmxk1DgBy1"}],"key":"yFlepwaiPy"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Prevent injection from rendering","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"W3AnVPBn9b"}],"key":"lR7WtlsYa3"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"ZtClqGtTbA"},{"type":"text","value":" or equivalent","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"VbQZfzNMVq"}],"key":"SXz76OxnyF"}],"key":"l83VOfpHpM"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Validate Input","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"MSm4h3UXA5"}],"key":"z9nRasK7af"}],"key":"qWArP2ixEv"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Reject invalid data early","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"vjItXsrAOl"}],"key":"zR4c4zjyN5"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Whitelist and sanitize","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"gYqg0nItpp"}],"key":"BbOBjlaDLZ"}],"key":"ikIAfPtzL9"},{"type":"tableRow","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Use CSP Header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"c4zdnmScpQ"}],"key":"ktAgeNpb4K"}],"key":"m0tUzkjTCJ"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Restrict script and content sources","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"YyPLrRPXBD"}],"key":"LvM6ICOOWI"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Set via HTTP header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"jWDrMS1Cy7"}],"key":"LIle62ne8s"}],"key":"baISeyRbly"},{"type":"tableRow","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Test with Report-Only","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"N9RKgjlQqm"}],"key":"wib2zupPYQ"}],"key":"Rd14fxPhce"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Monitor before enforcing","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"SQPeTgpX5Y"}],"key":"sJOjMdxhFb"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Log violations safely","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"PnHTX9pyzq"}],"key":"rzDi4mLz2K"}],"key":"lz8cMA0Ay1"},{"type":"tableRow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Iterate Gradually","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"spBsXNruum"}],"key":"epggTGeVhO"}],"key":"icXk9jyBlh"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Refine over time","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"n7lrpPPdDI"}],"key":"NC9C5mfyaX"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Add domains only when needed","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"wVCRmnwZ1N"}],"key":"VYBOsG9hGV"}],"key":"r9ePhqtVmK"}],"key":"z73t5OAJny"},{"type":"thematicBreak","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"scCAkE3fJG"},{"type":"heading","depth":3,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Final Thought","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"tlsHw1gFnt"}],"key":"qHvCMUNvBO"}],"identifier":"final-thought","label":"Final Thought","html_id":"final-thought","implicit":true,"key":"nBlNNaMWi8"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"CSP isn’t a silver bullet — but it’s a brilliant ally.\nIt turns the browser from a passive rendering engine into a ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"DGgTTbfJ63"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"vigilant partner in security","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"q4n8MY8yuC"}],"key":"sFAPSj2PIb"},{"type":"text","value":".\nUse it thoughtfully, pair it with strong coding practices, and your web applications will stand firm against the most persistent adversaries of the modern web.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"WwByUHIpsi"}],"key":"UyyOvNfg98"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"T28BlZpzi4"}],"key":"mZjI8z5ELo"}],"key":"gCS8YRRnz4"}],"key":"fijzeLcPy5"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"String Sanitation - filter_var()","url":"/zstringsanitation","group":"Add Edit Delete"},"next":{"title":"Defending Against Cross Site Scripting","url":"/zxssdefendingagainstxss","group":"Add Edit Delete"}}},"domain":"http://localhost:3002"}