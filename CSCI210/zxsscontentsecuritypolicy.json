{"version":2,"kind":"Article","sha256":"f4691d2f29d65dc97fed15efe85f83004b1c976404fbb9167a5491fcec0cf73d","slug":"zxsscontentsecuritypolicy","location":"/zxssContentSecurityPolicy.md","dependencies":[],"frontmatter":{"title":"Content Security Policy","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbookdocmov\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"zxssContentSecurityPolicy.md","url":"CSCI210/build/zxssContentSecurityP-8f0a74157af382dad1c37ff0dd163246.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Browser’s Bodyguard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vtABmaYRTH"}],"key":"C8OYtdeRsv"}],"identifier":"the-browsers-bodyguard","label":"The Browser’s Bodyguard","html_id":"the-browsers-bodyguard","implicit":true,"key":"YOwmAeSaL4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the constant duel between security and convenience, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"insiApYZVj"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WkFktswmwx"}],"key":"NjKxqq1SFo"},{"type":"text","value":" remains a classic ambush. Developers defend their web pages with careful ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dMsepAUilq"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"escaping","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xMQBt2YX3N"}],"key":"YCculDgE4p"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TeicUY7OGO"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"validation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IHiuWjkXnv"}],"key":"t1ymucZFlM"},{"type":"text","value":", but even the best code occasionally slips. That’s where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bQtAyexPfG"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Content Security Policy (CSP)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VGeKdC9Suo"}],"key":"tobjc5I61N"},{"type":"text","value":" steps in — not as a replacement, but as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PGEIY7tIdS"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"complementary layer of armor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RzZVxmVL6x"}],"key":"upt7OUfFkD"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Szgxa8PKIU"}],"key":"Tvop3Tvlkd"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MvThEc9PKC"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. What is Content Security Policy (CSP)?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ov0j2yUNDo"}],"key":"rQk4GuoQDx"}],"identifier":"id-1-what-is-content-security-policy-csp","label":"1. What is Content Security Policy (CSP)?","html_id":"id-1-what-is-content-security-policy-csp","implicit":true,"key":"jFwq7agzaH"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yCR4q8X65G"}],"key":"yQXVF7Ju63"},{"type":"text","value":" is an HTTP response header that acts as a browser-enforced whitelist. It tells the browser ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"iw6Xhit6WC"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PbCdyFXtY5"}],"key":"K9yrEJSPCW"},{"type":"text","value":" which sources of scripts, styles, images, fonts, and frames are trusted — and blocks everything else.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"V8qv1hubyE"}],"key":"P4fU0ns2gj"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In essence, CSP transforms the browser from a passive renderer into an active security guard.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"UlZUDCGhqS"}],"key":"hUdDwLTpQb"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"conSQsjgtn"}],"key":"Fq9f6GOHI0"}],"key":"SpPZMfDTsy"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"DCCLZOhQAI"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"This directive means:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ygOfLemy3x"}],"key":"fBV4K0058b"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All content must come from the same origin (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"XMJIjvx3g5"},{"type":"inlineCode","value":"'self'","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rOf5JhSMiN"},{"type":"text","value":").","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"UIEuleqeXB"}],"key":"XLAuSEi306"}],"key":"sXxf1QfKL8"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"JavaScript may also load from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"UQMD0PqETW"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"jsDelivr","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"rY8Fz5S4o2"}],"key":"mDhhqICdts"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"iwjKNaiAc2"}],"key":"XiNP7oZAnk"}],"key":"VW4OLtJfzi"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plugins and embedded objects (like Flash or Java applets) are entirely forbidden.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"iGtLPdg5JT"}],"key":"oCw5lDGIPd"}],"key":"cukyDBUrww"}],"key":"XBYrqDAn2Y"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The result: even if an attacker injects a malicious ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"v4EIqhAj1d"},{"type":"inlineCode","value":"<script>","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"q3o5LShrSm"},{"type":"text","value":" tag, the browser refuses to execute it because it’s not on the approved list.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"gHdlKsB1Of"}],"key":"RyFvDMDfvw"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"O3YeWFIsnJ"},{"type":"heading","depth":2,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2. Why CSP is Complementary, Not a Substitute","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ia4xGx6Zpq"}],"key":"A8Ey6PPvfu"}],"identifier":"id-2-why-csp-is-complementary-not-a-substitute","label":"2. Why CSP is Complementary, Not a Substitute","html_id":"id-2-why-csp-is-complementary-not-a-substitute","implicit":true,"key":"Z7cXtosHxP"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"It’s tempting to treat CSP as a magic fix for XSS — but that would be a mistake.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ESA9XQFijT"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Escaping and validation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ei30BUvOnF"}],"key":"GkmThQWo02"},{"type":"text","value":" remain your ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"CRLCY9ZVj9"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"primary defense","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"oN7AJai9cm"}],"key":"rE8PbEOsfO"},{"type":"text","value":"; CSP simply limits the damage if something slips through.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"TxUpkW3jbT"}],"key":"XCDVuP2wco"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Here’s why they must work hand-in-hand:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"MKfH1VIiRf"}],"key":"noJu0FG9h4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":38,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"CSP restricts behavior, not content.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"FMMWPoYqxB"}],"key":"uA4HkTyor6"},{"type":"text","value":"\nIt tells the browser what to load, but it can’t sanitize data. Escaping neutralizes harmful input before it ever reaches the browser.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"RkBXdXfL1Y"}],"key":"i8Z8dO26Sb"}],"key":"Y95YcronW6"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Misconfigurations happen.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FqiTFcR63I"}],"key":"RctJzmHxmI"},{"type":"text","value":"\nA single misplaced ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"NRt6bsYdG2"},{"type":"inlineCode","value":"'unsafe-inline'","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FGLLrv0LhJ"},{"type":"text","value":" or forgotten domain can open the gates again. Proper escaping ensures that even missteps in policy remain survivable.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"Igy5VYcEhl"}],"key":"iODq1rQfQF"}],"key":"n96PBAAzAG"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Browser support varies.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"rLyVlOMjVJ"}],"key":"SkbgWQ2o2T"},{"type":"text","value":"\nOlder or embedded browsers may ignore parts of CSP. Escaping works everywhere.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"lXHKtiz709"}],"key":"RFMbPj9Thu"}],"key":"ntX63bg8mm"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Defense in depth.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"aJWE8LZMu5"}],"key":"NrU4YzNbms"},{"type":"text","value":"\nSecurity thrives on redundancy. Escaping stops bad data; CSP catches anything that somehow sneaks through.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"waKYE5rvsW"}],"key":"rwPxVpqPxQ"}],"key":"z2eUCBiNuJ"}],"key":"Uf25CXxeV2"},{"type":"blockquote","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Think of escaping as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"bMqbREpu8G"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"locking the door","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"V91jBhx27k"}],"key":"GyKKrQ0LmQ"},{"type":"text","value":", and CSP as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ra05Cwv6ow"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"posting a guard outside","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"e0J9Kz2Nqh"}],"key":"F5L5cn2QL3"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"xMXPUmyT35"}],"key":"bX0Lo2vrqX"}],"key":"OYP8NEYr3L"},{"type":"thematicBreak","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"iJa3GcCUN4"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3. Where and How to Apply a CSP Header","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"mEB9Xs73G9"}],"key":"cy281ljQGz"}],"identifier":"id-3-where-and-how-to-apply-a-csp-header","label":"3. Where and How to Apply a CSP Header","html_id":"id-3-where-and-how-to-apply-a-csp-header","implicit":true,"key":"GpnUNlqkRe"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"CSP is enforced by the browser but delivered by your server. You set it as an ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"g8qbQl04I4"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"HTTP response header","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Y7hFPK5i32"}],"key":"EV5dwjzWlA"},{"type":"text","value":", usually through your web server configuration or application code.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"h6ByDDQnrD"}],"key":"LJ62FG7uQD"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Apache Example","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"oZNISnLtOX"}],"key":"gF74ylqDef"}],"identifier":"apache-example","label":"Apache Example","html_id":"apache-example","implicit":true,"key":"yDQ6qfs7XC"},{"type":"code","lang":"apache","value":"Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\"","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"key":"SsiUyjS7DT"},{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Nginx Example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ewVqgf0bN8"}],"key":"DAFT4i7zn5"}],"identifier":"nginx-example","label":"Nginx Example","html_id":"nginx-example","implicit":true,"key":"UVTWSG3cJY"},{"type":"code","lang":"nginx","value":"add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\";","position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"key":"qTqg1mgxac"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"PHP Example","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"lD72qX9Rk2"}],"key":"UsDVtOzaaD"}],"identifier":"php-example","label":"PHP Example","html_id":"php-example","implicit":true,"key":"L6cm5QXTHJ"},{"type":"code","lang":"php","value":"<?php\nheader(\"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\");\n?>","position":{"start":{"line":69,"column":1},"end":{"line":73,"column":1}},"key":"oTb1PeLPGE"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"(Place this before any HTML output so the header is sent correctly.)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"sLSIQGbyBk"}],"key":"iJe61g5UlO"}],"key":"TAgiLOWSt6"},{"type":"thematicBreak","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"ehymKzAZ8S"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"4. The Meta Tag — A Limited Alternative","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"SG0gEjSNT4"}],"key":"MjkJuwY60i"}],"identifier":"id-4-the-meta-tag-a-limited-alternative","label":"4. The Meta Tag — A Limited Alternative","html_id":"id-4-the-meta-tag-a-limited-alternative","implicit":true,"key":"vbyMUfT2Dx"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"When you can’t modify server headers (for instance, on a static host or learning environment), CSP can also be added via a ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"qDbZUe4UyY"},{"type":"inlineCode","value":"<meta>","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"v2miBxyhJC"},{"type":"text","value":" tag:","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"KmvqCpVYXL"}],"key":"dRgCpg2vW4"},{"type":"code","lang":"html","value":"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'\">","position":{"start":{"line":83,"column":1},"end":{"line":85,"column":1}},"key":"aLWoFPSTuq"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"This works only for the current document and has limited enforcement power. It’s fine for classroom demos or single pages, but in production, always use the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"fuBaZz9Ulh"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"HTTP header","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"n6BUKnkq47"}],"key":"C2WP1FWu22"},{"type":"text","value":" form.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"icwsJUJBNu"}],"key":"KTImYi40uZ"},{"type":"thematicBreak","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"YTDl7L8QK1"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"5. Building a Policy in Practice","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"mQqRbuM8dR"}],"key":"KRAapil4YX"}],"identifier":"id-5-building-a-policy-in-practice","label":"5. Building a Policy in Practice","html_id":"id-5-building-a-policy-in-practice","implicit":true,"key":"wI3xuFItM7"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Start simple, test carefully, then tighten. CSP has a ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"rK40Oljj2X"},{"type":"emphasis","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"report-only","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"WEHkUxAGBY"}],"key":"KuhqThtCcK"},{"type":"text","value":" mode that allows you to test your policy without breaking your site:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"Lxtv3r5JuE"}],"key":"akKaohoJMx"},{"type":"code","lang":"http","value":"Content-Security-Policy-Report-Only: default-src 'self';","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"key":"Q8qTPIvZ2n"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"You can even log violations to a monitoring endpoint:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"EaUX3ez3VM"}],"key":"ZIIT9pGxoy"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; report-uri /csp-violation-report-endpoint/;","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"key":"ZgoWoGLjPr"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This iterative approach lets you fine-tune your policy safely before enforcement.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"avrvEDaDH8"}],"key":"PTxfiHoFUi"},{"type":"thematicBreak","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"mF5yPuCAMq"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"6. The Belt and Suspenders Philosophy","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"eSGGCzwnkS"}],"key":"ga5K1RLcTl"}],"identifier":"id-6-the-belt-and-suspenders-philosophy","label":"6. The Belt and Suspenders Philosophy","html_id":"id-6-the-belt-and-suspenders-philosophy","implicit":true,"key":"Wbwl1G7w3h"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Security is strongest when multiple defenses overlap.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"l3pCVWCZOB"}],"key":"aCS6oze8SY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"zf0By1ayZk"}],"key":"DWQapJHtRl"},{"type":"text","value":": Removes or neutralizes malicious input.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"YrBDHp7NtG"}],"key":"PaBleAs1zY"}],"key":"xu0WjmtxGt"},{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"uAzYnch5T0"}],"key":"bfsZMy12JT"},{"type":"text","value":": Ensures only expected data enters the system.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"TyZ39i0OQr"}],"key":"WEhwdLdzDY"}],"key":"ukbdNqKvtH"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"FVknKLDB7R"}],"key":"oGoRC3mvLC"},{"type":"text","value":": Stops execution or loading of untrusted resources.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"wyBPQObiND"}],"key":"u0VH7MbYog"}],"key":"JT00CJY5zo"}],"key":"mhJQ7r6n1N"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Together, they form a resilient shield that protects your users, your data, and your reputation.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"jKRyNl1p9Z"}],"key":"M94a1qtE9S"},{"type":"blockquote","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Proper escaping is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"EFSAIS2ZEq"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"brakes","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"UTwNPZPsSc"}],"key":"Ejommj5gvS"},{"type":"text","value":";\nCSP is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"HemBc0uw88"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"kIR46Z87bm"}],"key":"iKfdp24fLb"},{"type":"text","value":".\nYou need both to stay safe on the open web.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"OS2knu3ohx"}],"key":"yEtwSyUhV8"}],"key":"foNOxwPzCD"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"eUprtcy3Iw"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Summary Checklist","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"ua8jfism20"}],"key":"G1Mezdnm0g"}],"identifier":"summary-checklist","label":"Summary Checklist","html_id":"summary-checklist","implicit":true,"key":"RR0Zyh3S7N"},{"type":"table","position":{"start":{"line":127,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"VZqSiqoMW3"}],"key":"UbahOx4ogl"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"wkQ4cB0ADE"}],"key":"gXxy45DjM4"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"HiX7FnfagE"}],"key":"zeL6uyO9NP"}],"key":"RhNedvvoNB"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Escape Output","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"d5XTQpgnJ1"}],"key":"Ihp36wnQYW"}],"key":"Do2nfq0t09"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Prevent injection from rendering","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"aXVgIJasxI"}],"key":"HaHy9vJCEv"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"LN2RqvE3IG"},{"type":"text","value":" or equivalent","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"LznzQ3JNhZ"}],"key":"t4VTwHOH8i"}],"key":"tyeptzTeIF"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Validate Input","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"kDlKavsjSv"}],"key":"XNP4xSXCtJ"}],"key":"NVER0QGhdf"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Reject invalid data early","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"eILWn46xoM"}],"key":"xn7NV0DVLj"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Whitelist and sanitize","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"YCdTJoQPK0"}],"key":"iZcFfe0O2g"}],"key":"MT2U2DYayh"},{"type":"tableRow","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Use CSP Header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"IjFJR8zpqi"}],"key":"T008rNCKjZ"}],"key":"Y9RmeelAU0"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Restrict script and content sources","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"SHyvxKP5Pp"}],"key":"W9VpORkHf8"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Set via HTTP header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"LKuqS2a99l"}],"key":"LvMLZYdnFk"}],"key":"oYRlHTf8Gk"},{"type":"tableRow","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Test with Report-Only","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"U1CsvZuZRJ"}],"key":"gTqvxpBVST"}],"key":"QsQb0CPN4z"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Monitor before enforcing","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"aMgBkJakG8"}],"key":"UHDoOA7Q2Z"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Log violations safely","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"sTwL2J6XGi"}],"key":"rbhirKe6by"}],"key":"KaPrOMMWzo"},{"type":"tableRow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Iterate Gradually","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"vL7h94WmHo"}],"key":"cREKIzXmGq"}],"key":"cFT5UdQzJI"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Refine over time","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"eDJvDfgpU6"}],"key":"JcmfrhoRFZ"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Add domains only when needed","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"C9jrreNO2x"}],"key":"csuO3Uq2U0"}],"key":"eWY649afQc"}],"key":"OGpH6zL8I0"},{"type":"thematicBreak","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"dK7CuOVNAt"},{"type":"heading","depth":3,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Final Thought","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"Qk8nLGvzPD"}],"key":"rNjdx44z4P"}],"identifier":"final-thought","label":"Final Thought","html_id":"final-thought","implicit":true,"key":"FMGXEZnQfF"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"CSP isn’t a silver bullet — but it’s a brilliant ally.\nIt turns the browser from a passive rendering engine into a ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"XQEDUlBmeg"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"vigilant partner in security","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"sleKLAvGrD"}],"key":"yKE7oF05dr"},{"type":"text","value":".\nUse it thoughtfully, pair it with strong coding practices, and your web applications will stand firm against the most persistent adversaries of the modern web.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"jRZ1bdcnfK"}],"key":"aBiKvSMVcy"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"MnshJuzUxP"}],"key":"VrnzGw5vRq"}],"key":"FC5JVGmacZ"}],"key":"yBavDqfhPY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"XSS Examples","url":"/zxssexamples","group":"Web Programming"},"next":{"title":"Passwords","url":"/zpasswords","group":"Web Programming"}}},"domain":"http://localhost:3000"}