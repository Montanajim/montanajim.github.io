{"version":2,"kind":"Article","sha256":"f4691d2f29d65dc97fed15efe85f83004b1c976404fbb9167a5491fcec0cf73d","slug":"zxsscontentsecuritypolicy","location":"/zxssContentSecurityPolicy.md","dependencies":[],"frontmatter":{"title":"Content Security Policy","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\csci210_webprog\\wpbook\\myst-generated-uid-0"}],"copyright":"2024 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"zxssContentSecurityPolicy.md","url":"/CSCI210/build/zxssContentSecurityP-68805fcee3204e2c9dca708a069dfd23.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Browser’s Bodyguard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xf8Wsttigt"}],"key":"iZH8WPiPt5"}],"identifier":"the-browsers-bodyguard","label":"The Browser’s Bodyguard","html_id":"the-browsers-bodyguard","implicit":true,"key":"SyX9b8sKoY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the constant duel between security and convenience, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Hh6kqMHgil"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cross-Site Scripting (XSS)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vczCcR4KNI"}],"key":"HGg5BKFksb"},{"type":"text","value":" remains a classic ambush. Developers defend their web pages with careful ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZQ5RYTb7Pr"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"escaping","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U5UIqH9HPk"}],"key":"X07z8ELMeU"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"z0Rz4OCmdo"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"validation","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"d7WuTVbxmZ"}],"key":"g9jjNYyOCL"},{"type":"text","value":", but even the best code occasionally slips. That’s where ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qS9ej2frcT"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Content Security Policy (CSP)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WgS9QXtCTV"}],"key":"HUVpg8FCyG"},{"type":"text","value":" steps in — not as a replacement, but as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"izJzeJT3sr"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"complementary layer of armor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OHdqVgv9B0"}],"key":"nj4oiDM5CK"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Zc9cN3Dy48"}],"key":"HPVVaTDIlR"},{"type":"thematicBreak","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XapiaFFLSE"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1. What is Content Security Policy (CSP)?","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EiYPxPPl0t"}],"key":"VTsLGLmxKZ"}],"identifier":"id-1-what-is-content-security-policy-csp","label":"1. What is Content Security Policy (CSP)?","html_id":"id-1-what-is-content-security-policy-csp","implicit":true,"key":"u5gZAgZANY"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ctN1TfgzSl"}],"key":"j3kIAzA2RZ"},{"type":"text","value":" is an HTTP response header that acts as a browser-enforced whitelist. It tells the browser ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"DG8E0mEDmB"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"b6KCsA0AvH"}],"key":"xDb7bSRM66"},{"type":"text","value":" which sources of scripts, styles, images, fonts, and frames are trusted — and blocks everything else.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rRmfupiCif"}],"key":"uIopW0bz5L"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"In essence, CSP transforms the browser from a passive renderer into an active security guard.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YmOOEKIK0K"}],"key":"LUHoY61Icf"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"P1GP5kMGmG"}],"key":"cJkopxQqVr"}],"key":"bFiDJPLmYQ"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"g8dIeHeEiF"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"This directive means:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"XpkvFUZvTH"}],"key":"tCnh6ZmuEN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"All content must come from the same origin (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"YRz0ImbCoT"},{"type":"inlineCode","value":"'self'","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"xUSbVVTFhj"},{"type":"text","value":").","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"YZyy4R4Ud0"}],"key":"MGHsIkMLlz"}],"key":"HzbROXmKOA"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"JavaScript may also load from ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"F1qq3YJ94U"},{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"jsDelivr","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"SLwZFOz5Fa"}],"key":"A65i7QfZD7"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LglG8oMAZa"}],"key":"jKWyHvh3yH"}],"key":"Ezrau4l3gb"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plugins and embedded objects (like Flash or Java applets) are entirely forbidden.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ueUEZtyBsH"}],"key":"klUOxaFr5w"}],"key":"QGNiLFvqxg"}],"key":"vXItun5uJn"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"The result: even if an attacker injects a malicious ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"hRtNss0niM"},{"type":"inlineCode","value":"<script>","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"mQenNTRjKJ"},{"type":"text","value":" tag, the browser refuses to execute it because it’s not on the approved list.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ju0Rw9GyjV"}],"key":"cB3Y5QzQSG"},{"type":"thematicBreak","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"w1YFDzggfe"},{"type":"heading","depth":2,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2. Why CSP is Complementary, Not a Substitute","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"RKbzqaW55Z"}],"key":"FxD0XssAME"}],"identifier":"id-2-why-csp-is-complementary-not-a-substitute","label":"2. Why CSP is Complementary, Not a Substitute","html_id":"id-2-why-csp-is-complementary-not-a-substitute","implicit":true,"key":"fSR8dNaWhX"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"It’s tempting to treat CSP as a magic fix for XSS — but that would be a mistake.\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"gq5EwW7Hzy"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Escaping and validation","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"FT9QQAYMlv"}],"key":"YMmyNVlGRJ"},{"type":"text","value":" remain your ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"lHs4SXOY5Q"},{"type":"emphasis","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"primary defense","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"fVQOELA9E5"}],"key":"ZsR53hWXdT"},{"type":"text","value":"; CSP simply limits the damage if something slips through.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"nrVg96Lzkf"}],"key":"palfFuTjUP"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Here’s why they must work hand-in-hand:","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"kDqGh5FxIu"}],"key":"lstisODuA2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":38,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"CSP restricts behavior, not content.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"PV5BZYz83H"}],"key":"qYULYcu9kD"},{"type":"text","value":"\nIt tells the browser what to load, but it can’t sanitize data. Escaping neutralizes harmful input before it ever reaches the browser.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"GI1xrerfJ4"}],"key":"lWsoGyyaZh"}],"key":"IZmDzUYvte"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Misconfigurations happen.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mTuvFUwM4J"}],"key":"n3yv9CFfaY"},{"type":"text","value":"\nA single misplaced ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"KQeKLTYOl9"},{"type":"inlineCode","value":"'unsafe-inline'","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"mP3ZDVOZcS"},{"type":"text","value":" or forgotten domain can open the gates again. Proper escaping ensures that even missteps in policy remain survivable.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"DXPsDXHat3"}],"key":"GjEOISWvuC"}],"key":"hNmHSH2Zuz"},{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Browser support varies.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WwUghkyt9v"}],"key":"twcyKewBXc"},{"type":"text","value":"\nOlder or embedded browsers may ignore parts of CSP. Escaping works everywhere.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"AuNB73ltkd"}],"key":"XXwJ6XwGFa"}],"key":"cCs9FP0FkD"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Defense in depth.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"dpJMQwL2G0"}],"key":"KKa2p5XQIr"},{"type":"text","value":"\nSecurity thrives on redundancy. Escaping stops bad data; CSP catches anything that somehow sneaks through.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"BM5RI1GRDO"}],"key":"gthtP35k9Q"}],"key":"kQv0qIPABE"}],"key":"jwF8s8YyqP"},{"type":"blockquote","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Think of escaping as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"rrAioY1LJD"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"locking the door","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"fEvkvEyCx7"}],"key":"TV0qO2Y1Y2"},{"type":"text","value":", and CSP as ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"rfJt75pqTf"},{"type":"strong","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"posting a guard outside","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"XcptYA7Z6d"}],"key":"NRQ3Ha0Ljo"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ApOkj3iBP2"}],"key":"x3wvrZ9fnd"}],"key":"xTQA3VIt47"},{"type":"thematicBreak","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"eeInu4RIsM"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3. Where and How to Apply a CSP Header","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"s4TdTcJtXZ"}],"key":"cuJbjJnrNX"}],"identifier":"id-3-where-and-how-to-apply-a-csp-header","label":"3. Where and How to Apply a CSP Header","html_id":"id-3-where-and-how-to-apply-a-csp-header","implicit":true,"key":"vlPFmJ3Knp"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"CSP is enforced by the browser but delivered by your server. You set it as an ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"w5oGToaoHQ"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"HTTP response header","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"noSScmxNGY"}],"key":"KZIpLZ7rbU"},{"type":"text","value":", usually through your web server configuration or application code.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"mmwTm193pW"}],"key":"bOaXJAPcBq"},{"type":"heading","depth":3,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Apache Example","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"LErh1asPqS"}],"key":"poFctxESxk"}],"identifier":"apache-example","label":"Apache Example","html_id":"apache-example","implicit":true,"key":"gKaQH0Dh83"},{"type":"code","lang":"apache","value":"Header set Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\"","position":{"start":{"line":57,"column":1},"end":{"line":59,"column":1}},"key":"aDBJ16v3w9"},{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Nginx Example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"XMYM5lSBzu"}],"key":"aMtEW1xtEk"}],"identifier":"nginx-example","label":"Nginx Example","html_id":"nginx-example","implicit":true,"key":"job2MOQok0"},{"type":"code","lang":"nginx","value":"add_header Content-Security-Policy \"default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\";","position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"key":"BhP0G8YEzj"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"PHP Example","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"MlOUuXYK0B"}],"key":"yJZGPTIQtU"}],"identifier":"php-example","label":"PHP Example","html_id":"php-example","implicit":true,"key":"d81G0h2lsj"},{"type":"code","lang":"php","value":"<?php\nheader(\"Content-Security-Policy: default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; object-src 'none';\");\n?>","position":{"start":{"line":69,"column":1},"end":{"line":73,"column":1}},"key":"GpmdDyvu4t"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"(Place this before any HTML output so the header is sent correctly.)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"NVuCrLlGex"}],"key":"Ro8AyXqIGk"}],"key":"unEQqMPPRq"},{"type":"thematicBreak","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"JhU9Tk8qhr"},{"type":"heading","depth":2,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"4. The Meta Tag — A Limited Alternative","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"R73SZBFrN5"}],"key":"qjgOR4PQs7"}],"identifier":"id-4-the-meta-tag-a-limited-alternative","label":"4. The Meta Tag — A Limited Alternative","html_id":"id-4-the-meta-tag-a-limited-alternative","implicit":true,"key":"PYoUSiBZsU"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"When you can’t modify server headers (for instance, on a static host or learning environment), CSP can also be added via a ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"kU2l3efqGx"},{"type":"inlineCode","value":"<meta>","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"UNdc8FG5dP"},{"type":"text","value":" tag:","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"MBb1TCyX9Y"}],"key":"a9lkLVMztq"},{"type":"code","lang":"html","value":"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; script-src 'self'\">","position":{"start":{"line":83,"column":1},"end":{"line":85,"column":1}},"key":"BddKPY87ZG"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"This works only for the current document and has limited enforcement power. It’s fine for classroom demos or single pages, but in production, always use the ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"uu63thSE8h"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"HTTP header","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"F9R6LqHcCS"}],"key":"YYsBHzVdiy"},{"type":"text","value":" form.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"WlJZWYHWko"}],"key":"sXf37TmRRz"},{"type":"thematicBreak","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"GA0HG78F5a"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"5. Building a Policy in Practice","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"UMFndsCeg4"}],"key":"Sr2teE6Qsl"}],"identifier":"id-5-building-a-policy-in-practice","label":"5. Building a Policy in Practice","html_id":"id-5-building-a-policy-in-practice","implicit":true,"key":"bRBAYWC6BI"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Start simple, test carefully, then tighten. CSP has a ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"dtG8C80gTB"},{"type":"emphasis","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"report-only","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"FLUXKCSuXJ"}],"key":"UAL52GkZFL"},{"type":"text","value":" mode that allows you to test your policy without breaking your site:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"HUtsxmCK1X"}],"key":"f9BGS2P8Jj"},{"type":"code","lang":"http","value":"Content-Security-Policy-Report-Only: default-src 'self';","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"key":"rltddLcoyY"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"You can even log violations to a monitoring endpoint:","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"KE6ZGMvU4Z"}],"key":"hPyf6RLrnn"},{"type":"code","lang":"http","value":"Content-Security-Policy: default-src 'self'; report-uri /csp-violation-report-endpoint/;","position":{"start":{"line":101,"column":1},"end":{"line":103,"column":1}},"key":"hyv0SZomyp"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This iterative approach lets you fine-tune your policy safely before enforcement.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"dcmUWOzFcS"}],"key":"mEyt93QeYD"},{"type":"thematicBreak","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"VQtGxSPN9u"},{"type":"heading","depth":2,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"strong","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"6. The Belt and Suspenders Philosophy","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"LqRk5l6hGn"}],"key":"K4jbHRi7gB"}],"identifier":"id-6-the-belt-and-suspenders-philosophy","label":"6. The Belt and Suspenders Philosophy","html_id":"id-6-the-belt-and-suspenders-philosophy","implicit":true,"key":"yPt0P6U9gi"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"Security is strongest when multiple defenses overlap.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"QaO0YummjB"}],"key":"NaVFE1i6Uy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"Escaping","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"R2gYaRfEY4"}],"key":"oeuCSvzK81"},{"type":"text","value":": Removes or neutralizes malicious input.","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"uzhdVpkiGZ"}],"key":"rk1w0apxgN"}],"key":"cYV2yikUL7"},{"type":"listItem","spread":true,"position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"Validation","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"kAtvVOWInF"}],"key":"aVV1Zw0174"},{"type":"text","value":": Ensures only expected data enters the system.","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"Sbv2oPHxGl"}],"key":"KE7Kk8F8uM"}],"key":"VWDZo6a7CG"},{"type":"listItem","spread":true,"position":{"start":{"line":115,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"CSP","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"AZy1tuNc6T"}],"key":"Lz8BOMLKNK"},{"type":"text","value":": Stops execution or loading of untrusted resources.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"MqA7vKOebf"}],"key":"WZwXceL4hc"}],"key":"SHF7BJyBNF"}],"key":"MA2hySljJp"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Together, they form a resilient shield that protects your users, your data, and your reputation.","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"cwx9pVCSIc"}],"key":"FYmqgaWvLI"},{"type":"blockquote","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Proper escaping is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"dbHMcQzRXZ"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"brakes","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"yeni9gYRhH"}],"key":"sEFr2QztI5"},{"type":"text","value":";\nCSP is the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"p8go0Vkmsd"},{"type":"emphasis","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"seatbelt","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"L6rBBTXDce"}],"key":"AV2ljrqeyz"},{"type":"text","value":".\nYou need both to stay safe on the open web.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"IN6mx0aWGb"}],"key":"vbJKeIiMvw"}],"key":"dYk1gUtRHk"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"RiwXakUM3g"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Summary Checklist","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"NHvkwWdbUE"}],"key":"I0Zay5XIgB"}],"identifier":"summary-checklist","label":"Summary Checklist","html_id":"summary-checklist","implicit":true,"key":"Uf5Bc3BA6K"},{"type":"table","position":{"start":{"line":127,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Layer","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"WXj30jHhj2"}],"key":"uJ1GWFNoQA"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"ED0BrxptEu"}],"key":"gPHML976Ck"},{"type":"tableCell","header":true,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"daYEVRWRme"}],"key":"sIrEKeOBiR"}],"key":"ZkwfihuKk9"},{"type":"tableRow","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Escape Output","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"a3BUd0M48F"}],"key":"wdPsuNbVuP"}],"key":"eIHOHCheOY"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Prevent injection from rendering","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"MybyyeSdip"}],"key":"BAOPN43K1u"},{"type":"tableCell","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"inlineCode","value":"htmlspecialchars()","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"yLWbAKqoNK"},{"type":"text","value":" or equivalent","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"GX3R75jFu5"}],"key":"Awmq5xPODR"}],"key":"rrQFgzvrUg"},{"type":"tableRow","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"strong","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Validate Input","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"Uq3ZBj8bol"}],"key":"YJs68xCWt1"}],"key":"nOin6hKBz6"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Reject invalid data early","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"oyY87nNkLd"}],"key":"RHBsQAHkKt"},{"type":"tableCell","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Whitelist and sanitize","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"RgsPl4onNl"}],"key":"XlsGaSkiAf"}],"key":"VQUDZq8VQG"},{"type":"tableRow","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Use CSP Header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"KU9SKI6TCu"}],"key":"SiAzGmFTsq"}],"key":"DjZ5LhF5nv"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Restrict script and content sources","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"y4l9DNT9sc"}],"key":"JJCmxp5n0p"},{"type":"tableCell","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"Set via HTTP header","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"imcQdrLTz5"}],"key":"Ed5LUhDbc1"}],"key":"tb8lzelHNB"},{"type":"tableRow","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"strong","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Test with Report-Only","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"OwT88fshLu"}],"key":"uMFl6TZDJ3"}],"key":"SP8T3C6Nzg"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Monitor before enforcing","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"dUJPcn8J4L"}],"key":"fn5ZcYtRyD"},{"type":"tableCell","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"Log violations safely","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"TksrHvcPnq"}],"key":"R8LZhC8cfW"}],"key":"nOwA53uOWH"},{"type":"tableRow","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Iterate Gradually","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"GGSCe9Zv0W"}],"key":"LoYCQrmnvy"}],"key":"wS5cZ8yWlv"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Refine over time","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"q7K4vORndq"}],"key":"fdHiaRdPPS"},{"type":"tableCell","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Add domains only when needed","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"JQdIgsdGEw"}],"key":"wS6cYJNkQv"}],"key":"qIWDsOgS7F"}],"key":"Y11HhkWItw"},{"type":"thematicBreak","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"oyDcyskLjy"},{"type":"heading","depth":3,"position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Final Thought","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"di4zWM8Mlf"}],"key":"s92EkSbdNu"}],"identifier":"final-thought","label":"Final Thought","html_id":"final-thought","implicit":true,"key":"n3XT1NZWGd"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"CSP isn’t a silver bullet — but it’s a brilliant ally.\nIt turns the browser from a passive rendering engine into a ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"LvTrRHvHyO"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"vigilant partner in security","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"ga04zpMm8v"}],"key":"njDQDRnmxT"},{"type":"text","value":".\nUse it thoughtfully, pair it with strong coding practices, and your web applications will stand firm against the most persistent adversaries of the modern web.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"FtJcknoKHW"}],"key":"XIOlCOCyEy"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"10/2025","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"rsjuUWfHgi"}],"key":"xgxGZluSIs"}],"key":"S5GWFY5AzR"}],"key":"KRfu4fbTza"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"XSS Examples","url":"/zxssexamples","group":"Web Programming"},"next":{"title":"Passwords","url":"/zpasswords","group":"Web Programming"}}},"domain":"http://localhost:3000"}