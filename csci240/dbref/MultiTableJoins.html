
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Multi Table Joins &#8212; CSCI 240 Databases and SQL</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/agogo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Foreign Keys and Cascading" href="ForeignKeysandCascading.html" />
    <link rel="prev" title="Single File Queries" href="SingleFileQueries.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../intro.html">CSCI 240 Databases and SQL</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="SingleFileQueries.html" title="Single File Queries"
             accesskey="P">previous</a> |
          <a href="ForeignKeysandCascading.html" title="Foreign Keys and Cascading"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="multi-table-joins">
<h1>Multi Table Joins<a class="headerlink" href="#multi-table-joins" title="Permalink to this heading">¶</a></h1>
<section id="joins">
<h2>Joins<a class="headerlink" href="#joins" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Inner join:</strong> An inner join returns all rows from both tables where the join condition is satisfied. Stated differently, there is a match in both tables and only those records are returned.</p></li>
<li><p><strong>Left join:</strong> A left join returns all rows from the left table, even if there are no matching rows in the right table. The right table will only return rows that match the join condition.</p></li>
<li><p><strong>Right join:</strong> A right join is the opposite of a left join. It returns all rows from the right table, even if there are no matching rows in the left table. The left table will only return rows that match the join condition.</p></li>
<li><p><strong>Self join:</strong> A self-join is a join between two tables that are the same table. This can be used to find relationships between rows in the same table.</p></li>
<li><p><strong>Cross join:</strong> Returns all records from both tables.</p></li>
</ul>
<p><img alt="MultiTableJoins" src="../_images/SQL_Joins.svg" /></p>
<img src="SQL_Joins.svg" style="zoom:67%;" />
<hr class="docutils" />
<div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- 03/09/23</span><span class="w"></span>

<span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">zdbjoins</span><span class="p">;</span><span class="w"></span>

<span class="k">use</span><span class="w"> </span><span class="n">zdbjoins</span><span class="p">;</span><span class="w"></span>

<span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">fname</span><span class="w">      </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">person_id</span><span class="w">  </span><span class="kt">int</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">auto_increment</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>

<span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">make</span><span class="w"> 	     </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">model</span><span class="w">       </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">color</span><span class="w">       </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">person_id</span><span class="w">   </span><span class="kt">int</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">car_id</span><span class="w">      </span><span class="kt">int</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">auto_increment</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">constraint</span><span class="w"> </span><span class="n">fk_carperson</span><span class="w"> </span><span class="k">foreign</span><span class="w"> </span><span class="k">key</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="k">references</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">(</span><span class="n">person_id</span><span class="p">)</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>


<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">person_id</span><span class="p">)</span><span class="w"></span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Ally&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="s1">&#39;Bubba&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="s1">&#39;Billy&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"></span>
<span class="w">       </span><span class="p">(</span><span class="s1">&#39;Danny&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="s1">&#39;David&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">),(</span><span class="s1">&#39;Jim&#39;</span><span class="p">,</span><span class="mi">7</span><span class="p">),(</span><span class="s1">&#39;Jack&#39;</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span><span class="w"></span>


<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">(</span><span class="n">make</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">color</span><span class="p">,</span><span class="n">person_id</span><span class="p">)</span><span class="w"> </span>
<span class="k">values</span><span class="w">  </span><span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="s1">&#39;F150&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="s1">&#39;F150&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="s1">&#39;Mustang&#39;</span><span class="p">,</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s1">&#39;Ford&#39;</span><span class="p">,</span><span class="s1">&#39;Fiesta&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="no">null</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s1">&#39;Scion&#39;</span><span class="p">,</span><span class="s1">&#39;XB&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="no">null</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s1">&#39;Subaru&#39;</span><span class="p">,</span><span class="s1">&#39;Forester&#39;</span><span class="p">,</span><span class="s1">&#39;forest&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">;</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">;</span><span class="w"></span>


<span class="c1">-- cartesian product</span><span class="w"></span>
<span class="c1">-- **** VERY VERY BAD ********</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">make</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- INNER JOIN --</span><span class="w"></span>
<span class="c1">-- Connect where there is a one to one match</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">make</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">Inner</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="w">     </span><span class="k">on</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">person_id</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- output label</span><span class="w"></span>
<span class="k">Select</span><span class="w">  </span><span class="s2">&quot;Left Join&quot;</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- LEFT JOIN --</span><span class="w"></span>
<span class="c1">-- Connect where you show ALL of the data in </span><span class="w"></span>
<span class="c1">-- the left table [tbl_person] and </span><span class="w"></span>
<span class="c1">-- only the data in the right table[tbl_car]</span><span class="w"></span>
<span class="c1">-- that has a match</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">make</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">Left</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="w">     </span><span class="k">on</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">person_id</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- output label</span><span class="w"></span>
<span class="k">Select</span><span class="w">  </span><span class="s2">&quot;Right Join&quot;</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- RIGHT JOIN --</span><span class="w"></span>
<span class="c1">-- Connect where you show ALL of the data in </span><span class="w"></span>
<span class="c1">-- the right table [tbl_car] and </span><span class="w"></span>
<span class="c1">-- only the data in the left table[tbl_person]</span><span class="w"></span>
<span class="c1">-- that has a match</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">make</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"></span>
<span class="k">from</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">Right</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="w">     </span><span class="k">on</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">person_id</span><span class="p">;</span><span class="w"></span>


<span class="c1">-- output label</span><span class="w"></span>
<span class="k">Select</span><span class="w">  </span><span class="s2">&quot;Cross Join&quot;</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- Cross JOIN --</span><span class="w"></span>
<span class="c1">-- Connect where you show ALL of the data in </span><span class="w"></span>
<span class="c1">-- the right table [tbl_car] and </span><span class="w"></span>
<span class="c1">-- all of  the data in the left table[tbl_person]</span><span class="w"></span>
<span class="c1">-- There will be nulls from both tables</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">From</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="w">    </span><span class="k">on</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span>
<span class="k">UNION</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="k">From</span><span class="w"> </span><span class="n">tbl_person</span><span class="w"> </span><span class="k">Right</span><span class="w"> </span><span class="k">Join</span><span class="w"> </span><span class="n">tbl_car</span><span class="w"></span>
<span class="w">    </span><span class="k">on</span><span class="w"> </span><span class="n">tbl_person</span><span class="p">.</span><span class="n">person_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tbl_car</span><span class="p">.</span><span class="n">person_id</span><span class="p">;</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">Note that the UNION will delete any duplicates.</span>
<span class="cm">If you wanted to see duplicates, then you use UNION ALL</span>

<span class="cm">*/</span><span class="p">.</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">######### NOTE: ################</span>
<span class="cm">Some forms of SQL including mysql</span>
<span class="cm">they will equate an </span>
<span class="cm">inner join/ join/cross join</span>
<span class="cm">as the same. In the standard, </span>
<span class="cm">they are not the same.</span>
<span class="cm">#################################</span>
<span class="cm">*/</span><span class="w"></span>


<span class="c1">-- ----------  Similiar Tables --------------------------</span><span class="w"></span>
<span class="c1">-- Dealing with two similar tables</span><span class="w"></span>
<span class="c1">-- putting two tables together</span><span class="w"></span>

<span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">fname</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">lname</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">hunters_id</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">auto_increment</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="p">);</span><span class="w"> </span>

<span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="w"></span>
<span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">fname</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">lname</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">fisherman_id</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">auto_increment</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>


<span class="c1">-- in the tables below</span><span class="w"></span>
<span class="c1">-- Dan, Jon and Tom are in both groups</span><span class="w"></span>
<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="p">,</span><span class="k">type</span><span class="p">)</span><span class="w"></span>
<span class="k">values</span><span class="w">  </span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span><span class="s2">&quot;Barker&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Ali&quot;</span><span class="p">,</span><span class="s2">&quot;Allison&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Car&quot;</span><span class="p">,</span><span class="s2">&quot;Carlson&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Dan&quot;</span><span class="p">,</span><span class="s2">&quot;Dunsford&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Jon&quot;</span><span class="p">,</span><span class="s2">&quot;Jones&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span><span class="s2">&quot;Troves&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Sam&quot;</span><span class="p">,</span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Tim&quot;</span><span class="p">,</span><span class="s2">&quot;Truvers&quot;</span><span class="p">,</span><span class="s2">&quot;hunter&quot;</span><span class="p">);</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">From</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="p">;</span><span class="w"></span>

<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="p">,</span><span class="k">type</span><span class="p">)</span><span class="w"></span>
<span class="k">values</span><span class="w">  </span><span class="p">(</span><span class="s2">&quot;Bobby&quot;</span><span class="p">,</span><span class="s2">&quot;Barnes&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Alley&quot;</span><span class="p">,</span><span class="s2">&quot;Allsford&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Carrie&quot;</span><span class="p">,</span><span class="s2">&quot;Cooper&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Dan&quot;</span><span class="p">,</span><span class="s2">&quot;Dunsford&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Jon&quot;</span><span class="p">,</span><span class="s2">&quot;Jones&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span><span class="s2">&quot;Troves&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Sammy&quot;</span><span class="p">,</span><span class="s2">&quot;Smothers&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;Thomas&quot;</span><span class="p">,</span><span class="s2">&quot;Tuffy&quot;</span><span class="p">,</span><span class="s2">&quot;fisherman&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>
<span class="k">Select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">From</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- combine both tables - UNION</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="p">,</span><span class="k">type</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="k">UNION</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="w"> </span>
<span class="k">Order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">lname</span><span class="p">;</span><span class="w"></span>

<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="k">UNION</span><span class="w"> </span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="w"> </span>
<span class="k">Order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">lname</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- preserves the duplicates</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="w"> </span>
<span class="k">Order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">lname</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- ensures that there is one distinct</span><span class="w"></span>
<span class="c1">-- entry for each name</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="k">UNION</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- find overlapping / intersecting names</span><span class="w"></span>
<span class="c1">-- find members in both groups</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="n">Intersect</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- this exludes the overlapping names</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_hunters</span><span class="w"> </span>
<span class="k">Except</span><span class="w"></span>
<span class="k">Select</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="n">lname</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tbl_fishermen</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./dbref"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="RelationalDatabases.html">Relational Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="MySQLFundamentals.html">MySQL Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingDatabasesAndTables.html">Creating Databases and Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataDefinitionLanguage.html">Data Definition Language - DDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataQueryLanguage.html">Data Query Language - DQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataManipulationLanguage.html">Data Manipulation Language - DML</a></li>
<li class="toctree-l1"><a class="reference internal" href="Datatypes.html">Datatypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cascade_Deletes.html">Cascade Deletes</a></li>
<li class="toctree-l1"><a class="reference internal" href="SingleFileQueries.html">Single File Queries</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multi Table Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForeignKeysandCascading.html">Foreign Keys and Cascading</a></li>
<li class="toctree-l1"><a class="reference internal" href="Views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="Indexes.html">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="StoreProcedures.html">Store Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Triggers.html">Triggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Events.html">Events</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="SingleFileQueries.html" title="Single File Queries"
              >previous</a> |
            <a href="ForeignKeysandCascading.html" title="Foreign Keys and Cascading"
              >next</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/dbref/MultiTableJoins.md"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023 By James Goudy.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>