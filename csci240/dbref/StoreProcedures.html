
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Store Procedures &#8212; CSCI 240 Databases and SQL</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/agogo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Triggers" href="Triggers.html" />
    <link rel="prev" title="Indexes" href="Indexes.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../intro.html">CSCI 240 Databases and SQL</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="Indexes.html" title="Indexes"
             accesskey="P">previous</a> |
          <a href="Triggers.html" title="Triggers"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="store-procedures">
<h1>Store Procedures<a class="headerlink" href="#store-procedures" title="Permalink to this heading">¶</a></h1>
<section id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">¶</a></h2>
<p>A stored procedure is a set of SQL statements that are stored in a database and can be called by name. They are used to group together SQL statements that are executed frequently, which can improve performance and reduce errors. Stored procedures can also be used to enforce security and encapsulate business logic, making it easier to maintain and update the database.</p>
</section>
<section id="advantages">
<h2>Advantages<a class="headerlink" href="#advantages" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>Code reusability.</p></li>
<li><p>Lesser Network transfer</p></li>
<li><p>More secure – The Database Administrator
can GRANT or REVOKE privileges at a procedure level.</p></li>
<li><p>Modularised code structure.</p>
<p><a class="reference external" href="https://www.softwaretestinghelp.com/mysql-stored-procedure/#Advantages">https://www.softwaretestinghelp.com/mysql-stored-procedure/#Advantages</a></p>
</li>
</ul>
<div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Stored Procedures</span><span class="w"></span>
<span class="w"> </span>
<span class="c1">-- We change the delimiter to indicate what is </span><span class="w"></span>
<span class="c1">-- part of the store procedure vs what is an SQL command</span><span class="w"></span>
<span class="c1">-- outside a stored procedure</span><span class="w"></span>
<span class="c1">-- We can change the delimiter to anything we want.</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="n">$$</span><span class="w"></span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">pro_Payments</span><span class="p">()</span><span class="w"></span>

<span class="w">  </span><span class="k">BEGIN</span><span class="w"> </span>
<span class="w">	  </span><span class="c1">-- SQL Statements Go Here</span><span class="w"></span>
<span class="w">	  </span><span class="c1">-- These can also include SQL statements to </span><span class="w"></span>
<span class="w">	  </span><span class="c1">-- create tables, views, users, and set priviledges</span><span class="w"></span>
<span class="w">	  </span>
<span class="w">      </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">payments</span><span class="w"></span>
<span class="w">      </span><span class="k">LIMIT</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="n">$$</span><span class="w"></span>

<span class="c1">-- change the delimiter back to </span><span class="w"></span>
<span class="n">DELIMITER</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="c1">-- excecute the stored procedure</span><span class="w"></span>
<span class="k">CALL</span><span class="w"> </span><span class="n">pro_Payments</span><span class="p">();</span><span class="w"></span>

<span class="c1">-- ------------- Another Example -------------------------</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="n">$$</span><span class="w"></span>

<span class="c1">-- here we are creating a stored procedure that will </span><span class="w"></span>
<span class="c1">-- take input. Note the key word &quot;IN&quot; which means input</span><span class="w"></span>
<span class="c1">-- we then define a variable name and the data type</span><span class="w"></span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">pro_Payments2</span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">payAmount</span><span class="w"> </span><span class="kt">DECIMAL</span><span class="p">)</span><span class="w"></span>

<span class="w">  </span><span class="k">BEGIN</span><span class="w"> </span>

<span class="w">  	</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">payments</span><span class="w"></span>
<span class="w">    	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">payAmount</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">END</span><span class="w"> </span><span class="n">$$</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="k">call</span><span class="w"> </span><span class="n">pro_Payments2</span><span class="p">(</span><span class="mi">70000</span><span class="p">);</span><span class="w"></span>

<span class="c1">-- ------------- Another Example -------------------------</span><span class="w"></span>

<span class="c1">-- Here is a query to show stored procedures</span><span class="w"></span>
<span class="k">SELECT</span><span class="w">  </span><span class="n">routine_schema</span><span class="p">,</span><span class="w">  </span>
<span class="w">        </span><span class="n">routine_name</span><span class="p">,</span><span class="w">  </span>
<span class="w">        </span><span class="n">routine_type</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">routines</span><span class="w"> </span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">routine_schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;classicmodels&#39;</span><span class="w"> </span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">routine_name</span><span class="p">;</span><span class="w"></span>

<span class="c1">-- Turn this into a stored procedure</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="o">//</span><span class="w"></span>

<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">pro_ListProcedures</span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">procName</span><span class="w"> </span><span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span><span class="w"></span>

<span class="w">  </span><span class="k">BEGIN</span><span class="w"> </span>

<span class="w">    </span><span class="k">SELECT</span><span class="w">  </span><span class="n">routine_schema</span><span class="p">,</span><span class="w">  </span>
<span class="w">            </span><span class="n">routine_name</span><span class="p">,</span><span class="w">  </span>
<span class="w">            </span><span class="n">routine_type</span><span class="w"> </span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">routines</span><span class="w"> </span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">routine_schema</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;classicmodels&#39;</span><span class="w"> </span>
<span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">routine_name</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span>
<span class="k">END</span><span class="w"> </span><span class="o">//</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="k">CALL</span><span class="w"> </span><span class="n">pro_ListProcedures</span><span class="p">(</span><span class="s1">&#39;classicmodels&#39;</span><span class="p">);</span><span class="w"></span>


<span class="c1">-- -------------- Helpful  query ----------------------------------</span><span class="w"></span>
<span class="k">SHOW</span><span class="w"> </span><span class="k">FULL</span><span class="w"> </span><span class="k">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">classicmodels</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">TABLE_TYPE</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;VIEW&#39;</span><span class="p">;</span><span class="w"></span>


<span class="c1">-- -------- Here is an example of a stored procedure to  list views --------------</span><span class="w"></span>


<span class="n">DELIMITER</span><span class="w"> </span><span class="o">//</span><span class="w"></span>



<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">proc_ListViews</span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">theDBName</span><span class="w"> </span><span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span><span class="w"></span>

<span class="w">  </span><span class="k">BEGIN</span><span class="w"> </span>

<span class="w">      </span><span class="k">SELECT</span><span class="w"> </span><span class="n">TABLE_SCHEMA</span><span class="p">,</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span>
<span class="w">      </span><span class="k">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="k">tables</span><span class="w"> </span>
<span class="w">      </span><span class="k">WHERE</span><span class="w"> </span><span class="n">TABLE_TYPE</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;VIEW&#39;</span><span class="w"></span>
<span class="w">          </span><span class="k">AND</span><span class="w"> </span><span class="n">TABLE_SCHEMA</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="n">theDBName</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="k">END</span><span class="w"> </span><span class="o">//</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="k">CALL</span><span class="w"> </span><span class="n">proc_ListViews</span><span class="p">(</span><span class="s1">&#39;classicmodels&#39;</span><span class="p">);</span><span class="w"></span>


<span class="c1">-- Another example --</span><span class="w"></span>

<span class="n">DELIMITER</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./dbref"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="RelationalDatabases.html">Relational Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="MySQLFundamentals.html">MySQL Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingDatabasesAndTables.html">Creating Databases and Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataDefinitionLanguage.html">Data Definition Language - DDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataQueryLanguage.html">Data Query Language - DQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataManipulationLanguage.html">Data Manipulation Language - DML</a></li>
<li class="toctree-l1"><a class="reference internal" href="Datatypes.html">Datatypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cascade_Deletes.html">Cascade Deletes</a></li>
<li class="toctree-l1"><a class="reference internal" href="SingleFileQueries.html">Single File Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultiTableJoins.html">Multi Table Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForeignKeysandCascading.html">Foreign Keys and Cascading</a></li>
<li class="toctree-l1"><a class="reference internal" href="Views.html">Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="Indexes.html">Indexes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Store Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="Triggers.html">Triggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Events.html">Events</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="Indexes.html" title="Indexes"
              >previous</a> |
            <a href="Triggers.html" title="Triggers"
              >next</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/dbref/StoreProcedures.md"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023 By James Goudy.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>