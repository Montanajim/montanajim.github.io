{"version":2,"kind":"Article","sha256":"6651426f9ce3f50414aceec1e7b7099f024e537ee0abb096e15a6aba99928fcc","slug":"xpanda-transformation","location":"/xPanda_Transformation.md","dependencies":[],"frontmatter":{"title":"Panda Data Transformation","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\0_jbdbook\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xPanda_Transformation.md","url":"/csci127/build/xPanda_Transformatio-9a15bb775a8149ee84365f750ef7527a.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Explanation of Each Function","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dQeksql52I"}],"key":"rhlMTClOFE"}],"identifier":"explanation-of-each-function","label":"Explanation of Each Function","html_id":"explanation-of-each-function","implicit":true,"key":"JHAIf8QSLo"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineCode","value":"df.sort_values(by='column')","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rnzS9lImTS"}],"key":"bHxK09reee"},{"type":"text","value":":","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pRu7FklEya"}],"key":"SRHDOmi6p1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sorts the DataFrame rows based on the specified column.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"z50bEEDuTb"}],"key":"d62Ij91Vuv"}],"key":"DhzIeYjMmT"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Sort rows by the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oeY9rglBTO"},{"type":"inlineCode","value":"Age","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zX1aiNmhlf"},{"type":"text","value":" column.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oPISw9ANxb"}],"key":"zhH86Qt1sI"}],"key":"fKMTzzshDz"}],"key":"e649nH22A9"}],"key":"vHY7tDb0g1"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineCode","value":"df.sort_index()","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vXiELnDKNH"}],"key":"mB1AmlzMbb"},{"type":"text","value":":","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"uoPl0NnSx8"}],"key":"IQtZy5eK1O"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Sorts the rows or columns by their index.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"b0QygkfnCu"}],"key":"qxGIknrCOW"}],"key":"TS467py69H"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Sort rows in descending order by their index.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"hq57miNnfs"}],"key":"FlbrQQgtQ4"}],"key":"JIykdisKqd"}],"key":"QdbOK0yvJe"}],"key":"lYkB5JL6P7"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineCode","value":"df.groupby()","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZRUmwQvZwA"}],"key":"AqXwQgolK3"},{"type":"text","value":":","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NkAsA59RiP"}],"key":"az0DoRt9Bn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Groups the data by a specified column and applies aggregation functions (e.g., ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jRnW48ju8Y"},{"type":"inlineCode","value":"mean","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"rYnQGCrIDk"},{"type":"text","value":", ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"MgeM7srdkU"},{"type":"inlineCode","value":"sum","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"w0WKM9nhmp"},{"type":"text","value":", etc.).","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bycSWITe4i"}],"key":"jZayVLbkSX"}],"key":"T9LhbiILzQ"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Group data by ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"cONMXkKjDp"},{"type":"inlineCode","value":"Department","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"zrvIWXFEuN"},{"type":"text","value":" and calculate the average ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Y9xo1tQSZK"},{"type":"inlineCode","value":"Salary","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BnzzBSCWWN"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"UeCABHA0Do"}],"key":"Vg6oc6hPOs"}],"key":"FgSoMYQuMa"}],"key":"Mgj4oFGzYU"}],"key":"IZqzSRxmzI"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"inlineCode","value":"df.pivot_table()","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PUjeHfliDE"}],"key":"wZjyhnmCCL"},{"type":"text","value":":","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pSJH4yITbb"}],"key":"rK7EiXqVta"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Creates a pivot table to summarize and aggregate data.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"BYH2LJxczC"}],"key":"J6hdQQEF5T"}],"key":"ETpbnH0ZJX"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Show the average ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Du3FqvUGp5"},{"type":"inlineCode","value":"Salary","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ywtuS398Va"},{"type":"text","value":" grouped by ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ZX9JMufWNN"},{"type":"inlineCode","value":"Department","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ScpvHYYpVC"},{"type":"text","value":" and ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"b5V8cEQDxe"},{"type":"inlineCode","value":"City","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"HhCMrXIDF5"},{"type":"text","value":".","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ZW1fUZ0XG3"}],"key":"obrdNZKpCj"}],"key":"WN3VlQmy9F"}],"key":"BREqRbwgQ7"}],"key":"bejypRe2K8"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineCode","value":"df.apply()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"riTtIkiquM"}],"key":"DTsQAEp9eu"},{"type":"text","value":":","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"mltFRabGLz"}],"key":"jxmexR9etP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Applies a custom function to each element in a column or row.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"gKmeAWHU3Y"}],"key":"d4M7sB78TK"}],"key":"BOhRFWoZnK"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Increase each ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"FMbNbtdqoo"},{"type":"inlineCode","value":"Salary","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"IdNJtf5lxi"},{"type":"text","value":" by 10%.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BbgmFYgfuv"}],"key":"cyhhGr3me4"}],"key":"XA4GLB77a7"}],"key":"V3gGMuouRe"}],"key":"Z7rhPDP429"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"inlineCode","value":"df.astype()","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mBkR5pcdBb"}],"key":"dJmomMPgNS"},{"type":"text","value":":","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Jz8PDwfCcO"}],"key":"I16aZYgWeN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Changes the data type of a column.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"v3qrfy3ptN"}],"key":"GiMPN0QGfJ"}],"key":"nTb5SreHA7"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: Convert the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"w9887AnpI0"},{"type":"inlineCode","value":"Age","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"geIWNuWC3C"},{"type":"text","value":" column to a string type.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"EYUHnjUwkX"}],"key":"TR4nULbALX"}],"key":"kocLj0U7qW"}],"key":"vSAKMib6rK"}],"key":"FvjQt7MGrB"}],"key":"nR8ZL15237"},{"type":"code","lang":"python","value":"# Data Transformation\n\nimport pandas as pd\n\n# Create sample data\ndata = {\n    'Name': ['Alice', 'Bob', 'Charlie', 'David', 'Eve'],\n    'Age': [25, 30, 35, 40, 22],\n    'City': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'],\n    'Department': ['HR', 'Finance', 'HR', 'IT', 'Finance'],\n    'Salary': [70000, 80000, 120000, 90000, 75000]\n}\n\n# Create a DataFrame\ndf = pd.DataFrame(data)\nprint(\"Original DataFrame:\")\nprint(df)\nprint(\"\\n\")\n\n# ------------------------------\n# 1. df.sort_values(by='column'): Sort rows by a specified column\n# ------------------------------\nprint(\"Sorting rows by 'Age':\")\ndf_sorted = df.sort_values(by='Age')\nprint(df_sorted)\nprint(\"\\n\")\n\n# ------------------------------\n# 2. df.sort_index(): Sort rows by their index\n# ------------------------------\nprint(\"Sorting rows by index in descending order:\")\ndf_index_sorted = df.sort_index(ascending=False)\nprint(df_index_sorted)\nprint(\"\\n\")\n\n# ------------------------------\n# 3. df.groupby(): Group data for aggregation\n# ------------------------------\nprint(\"Grouping by 'Department' and calculating mean 'Salary':\")\ndf_grouped = df.groupby('Department')['Salary'].mean()\nprint(df_grouped)\nprint(\"\\n\")\n\n# ------------------------------\n# 4. df.pivot_table(): Create a pivot table\n# ------------------------------\nprint(\"Creating a pivot table for average 'Salary' by 'Department' and 'City':\")\ndf_pivot = df.pivot_table(values='Salary', index='Department', columns='City', aggfunc='mean')\nprint(df_pivot)\nprint(\"\\n\")\n\n# ------------------------------\n# 5. df.apply(): Apply a custom function\n# ------------------------------\nprint(\"Applying a custom function to increase 'Salary' by 10%:\")\ndf['Salary'] = df['Salary'].apply(lambda x: x * 1.1)\nprint(df)\nprint(\"\\n\")\n\n# ------------------------------\n# 6. df.astype(): Change data type of a column\n# ------------------------------\nprint(\"Changing 'Age' column to string type:\")\ndf['Age'] = df['Age'].astype(str)\nprint(df)\nprint(\"\\n\")\n\n\n'''\nOUTPUT\nOriginal DataFrame:\n      Name  Age  ... Department  Salary\n0    Alice   25  ...         HR   70000\n1      Bob   30  ...    Finance   80000\n2  Charlie   35  ...         HR  120000\n3    David   40  ...         IT   90000\n4      Eve   22  ...    Finance   75000\n\n[5 rows x 5 columns]\n\n\nSorting rows by 'Age':\n      Name  Age  ... Department  Salary       \n4      Eve   22  ...    Finance   75000       \n0    Alice   25  ...         HR   70000       \n1      Bob   30  ...    Finance   80000       \n2  Charlie   35  ...         HR  120000       \n3    David   40  ...         IT   90000       \n\n[5 rows x 5 columns]\n\n\nSorting rows by index in descending order:    \n      Name  Age  ... Department  Salary\n4      Eve   22  ...    Finance   75000       \n3    David   40  ...         IT   90000       \n2  Charlie   35  ...         HR  120000       \n1      Bob   30  ...    Finance   80000       \n0    Alice   25  ...         HR   70000       \n\n[5 rows x 5 columns]\n\n\nGrouping by 'Department' and calculating mean \n'Salary':\nDepartment\nFinance    77500.0\nHR         95000.0\nIT         90000.0\nName: Salary, dtype: float64\n\n\nCreating a pivot table for average 'Salary' by 'Department' and 'City':\nCity         Chicago  ...  Phoenix\nDepartment            ...\nFinance          NaN  ...  75000.0\nHR          120000.0  ...      NaN\nIT               NaN  ...      NaN\n\n[3 rows x 5 columns]\n\n\nApplying a custom function to increase 'Salary' by 10%:\n      Name  Age  ... Department    Salary     \n0    Alice   25  ...         HR   77000.0     \n1      Bob   30  ...    Finance   88000.0     \n2  Charlie   35  ...         HR  132000.0     \n3    David   40  ...         IT   99000.0     \n4      Eve   22  ...    Finance   82500.0     \n\n[5 rows x 5 columns]\n\n\nChanging 'Age' column to string type:\n      Name Age  ... Department    Salary      \n0    Alice  25  ...         HR   77000.0      \n1      Bob  30  ...    Finance   88000.0      \n2  Charlie  35  ...         HR  132000.0      \n3    David  40  ...         IT   99000.0      \n4      Eve  22  ...    Finance   82500.0      \n\n[5 rows x 5 columns]\n'''","position":{"start":{"line":28,"column":1},"end":{"line":172,"column":1}},"key":"WDFo48MnXw"}],"key":"A8j5MtwfSn"}],"key":"tXLm7yOAe8"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Panda Data Cleaning","url":"/xpanda-datacleaning","group":"CSCI 127"},"next":{"title":"Panda Aggregation","url":"/xpanda-aggregation","group":"CSCI 127"}}},"domain":"http://localhost:3001"}