{"version":2,"kind":"Article","sha256":"22b0594eea509fb370fff36e59790dd017f56817171c2e9720726087c03df587","slug":"xpanda-mergingshaping","location":"/xPanda_MergingShaping.md","dependencies":[],"frontmatter":{"title":"Panda Merging and Shaping","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\0_jbdbook\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xPanda_MergingShaping.md","url":"/csci127/build/xPanda_MergingShapin-0cce651973bfd260c83e3d4d8ae2c791.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explanation of Each Operation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qrapvM7uNZ"}],"key":"SbTUZaXZmq"}],"identifier":"explanation-of-each-operation","label":"Explanation of Each Operation","html_id":"explanation-of-each-operation","implicit":true,"key":"HX47ZVr7Kb"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"pd.merge()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BEb84TFNxP"}],"key":"uqtQxmvXiU"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oQ8kOIciAE"}],"key":"XA5AHLSnPU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Merges two DataFrames on a common column or key.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ASFoAZx4fB"}],"key":"oXntqHc2WL"}],"key":"dGgaPM5r93"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Nf1lw5wuiY"},{"type":"inlineCode","value":"merged_df","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gJieg7zg0q"},{"type":"text","value":" combines ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iJwT8w6sDm"},{"type":"inlineCode","value":"df1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FUdTvmGLpd"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jo6IirJzOw"},{"type":"inlineCode","value":"df2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SxWMqoQgKa"},{"type":"text","value":" on the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GFmPT3ICyl"},{"type":"inlineCode","value":"ID","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZWKTahldkE"},{"type":"text","value":" column using an inner join.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FrHUtPiorc"}],"key":"W4niBmvrmR"}],"key":"SxMg4oFKAU"}],"key":"XP8vuz9ywl"}],"key":"Z7xLdJbse0"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"pd.concat()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wUERaTkVRj"}],"key":"P8oi9GkFAD"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"phv53KL4iR"}],"key":"a4KgFo2E0L"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Concatenates two or more DataFrames along rows (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tmOwGNReup"},{"type":"inlineCode","value":"axis=0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tH5XVYmLgf"},{"type":"text","value":") or columns (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BmRdQaFlFv"},{"type":"inlineCode","value":"axis=1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"N685OOKDRf"},{"type":"text","value":").","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cIOxInNgaE"}],"key":"opdArUXOId"}],"key":"dgAJXOwniE"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BKOrIv3c94"},{"type":"inlineCode","value":"concat_rows","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ldVRTE2MdQ"},{"type":"text","value":" stacks ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ull0bmkNP8"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"V6WmBpfQPR"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"oJGo5JlZ53"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UwKUO0FXg8"},{"type":"text","value":" vertically, while ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XeWFLHV8zQ"},{"type":"inlineCode","value":"concat_columns","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"u57oryVgSE"},{"type":"text","value":" appends ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QdbOMyHMp4"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tHiWkJXiZv"},{"type":"text","value":" as additional columns to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"st22EoQQkq"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ysrF2Ad4bb"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"V8uftWBe3I"}],"key":"Ul8vXwSO8N"}],"key":"PFiRExsiuN"}],"key":"QsilH86n1P"}],"key":"m6QbPLhZPf"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"df.join()","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"U91ihaveuy"}],"key":"jE7mZWtSlf"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"SC2s6c0w51"}],"key":"F2XLHlnnRd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Joins two DataFrames based on their indices.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"QbH5Wlua0o"}],"key":"d3DPC03GFq"}],"key":"BQEsxftPIV"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mK8bcotWNh"},{"type":"inlineCode","value":"joined_df","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ewOg0ZS05g"},{"type":"text","value":" joins ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Z7kqnCgmTh"},{"type":"inlineCode","value":"df1_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"GbQyAwJRa2"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"pZJ8F2HpNa"},{"type":"inlineCode","value":"df3_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Mc0piGZTvF"},{"type":"text","value":" on their index values.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wNhzTQMEEs"}],"key":"Vr6C1gmM5U"}],"key":"GiQZF3rqQS"}],"key":"ySA40vabj7"}],"key":"lJvUJn9cq8"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineCode","value":"df.melt()","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jdW1s6fm0r"}],"key":"tBSJFQR37H"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bjA2RnMZbV"}],"key":"mjf40tsbgV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from wide format to long format by unpivoting columns.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gKaNt1jzv4"}],"key":"CM0wyubDd9"}],"key":"DXP5x5lVcN"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zpBj28qgeN"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ldcGiHqoqt"},{"type":"text","value":" turns ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vyzID2C0o4"},{"type":"inlineCode","value":"Name","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"LeOy70TSMo"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mayoIvXspU"},{"type":"inlineCode","value":"Age","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"uGX8hjUVwk"},{"type":"text","value":" columns into rows with corresponding values.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WwuWDTKB83"}],"key":"jZg65fgLOi"}],"key":"MQStXYT27E"}],"key":"BHuvdB0qvA"}],"key":"l5Ck6r7Iqu"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"df.pivot()","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"iUWKf5qeUb"}],"key":"pEifgnTXau"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"E6IhWTioSE"}],"key":"la9PmkgbI8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from long format to wide format by pivoting on a specified column.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"FSVBpzG45U"}],"key":"xnoFOllAxG"}],"key":"TPyaZyA2tf"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"GDCp5J6TIz"},{"type":"inlineCode","value":"pivoted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"os0GjosbeI"},{"type":"text","value":" pivots ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"npRvjUjpHG"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"NPPJOK9P6k"},{"type":"text","value":" back to wide format with ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"cQMsNdsWNe"},{"type":"inlineCode","value":"Name","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Tgj1l0iKGW"},{"type":"text","value":" and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"k2GlpEj4rp"},{"type":"inlineCode","value":"Age","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"kSEgV7iTBU"},{"type":"text","value":" as columns.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"s1aTZ8BzPP"}],"key":"WIDCq5gTnQ"}],"key":"mcXwjbTYug"}],"key":"ltRvGTlBOf"}],"key":"BSmoyG2gEW"}],"key":"sEDFVQpP7A"},{"type":"code","lang":"python","value":"# Panda Merging and Shaping\n\nimport pandas as pd\n\n# Create sample DataFrames for demonstration\ndf1 = pd.DataFrame({\n    'ID': [1, 2, 3],\n    'Name': ['Alice', 'Bob', 'Charlie'],\n    'Age': [25, 30, 35]\n})\n\ndf2 = pd.DataFrame({\n    'ID': [2, 3, 4],\n    'City': ['New York', 'Chicago', 'Los Angeles'],\n    'Salary': [80000, 120000, 75000]\n})\n\ndf3 = pd.DataFrame({\n    'Department': ['HR', 'Finance', 'IT'],\n    'Head': ['Alice', 'David', 'Charlie']\n})\n\n# ------------------------------\n# 1. pd.merge(): Merge two DataFrames on a common column\n# ------------------------------\nprint(\"Merging df1 and df2 on 'ID':\")\nmerged_df = pd.merge(df1, df2, on='ID', how='inner')  # Inner join\nprint(merged_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 2. pd.concat(): Concatenate two DataFrames along rows or columns\n# ------------------------------\nprint(\"Concatenating df1 and df2 along rows:\")\nconcat_rows = pd.concat([df1, df2], axis=0)  # Concatenating rows\nprint(concat_rows)\nprint(\"\\n\")\n\nprint(\"Concatenating df1 and df2 along columns:\")\nconcat_columns = pd.concat([df1, df2], axis=1)  # Concatenating columns\nprint(concat_columns)\nprint(\"\\n\")\n\n# ------------------------------\n# 3. df.join(): Join two DataFrames on their index\n# ------------------------------\nprint(\"Joining df1 and df3 by index:\")\ndf1_indexed = df1.set_index('Name')\ndf3_indexed = df3.set_index('Head')\njoined_df = df1_indexed.join(df3_indexed, how='left')\nprint(joined_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 4. df.melt(): Unpivot a DataFrame from wide to long format\n# ------------------------------\nprint(\"Melting df1 to long format:\")\nmelted_df = pd.melt(df1, id_vars=['ID'], value_vars=['Name', 'Age'], var_name='Attribute', value_name='Value')\nprint(melted_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 5. df.pivot(): Pivot a DataFrame from long to wide format\n# ------------------------------\nprint(\"Pivoting melted_df back to wide format:\")\npivoted_df = melted_df.pivot(index='ID', columns='Attribute', values='Value')\nprint(pivoted_df)\nprint(\"\\n\")\n\n\n'''\nMerging df1 and df2 on 'ID':\n   ID     Name  Age      City  Salary      \n0   2      Bob   30  New York   80000      \n1   3  Charlie   35   Chicago  120000      \n\n\nConcatenating df1 and df2 along rows:      \n   ID     Name   Age         City    Salary\n0   1    Alice  25.0          NaN       NaN\n1   2      Bob  30.0          NaN       NaN\n2   3  Charlie  35.0          NaN       NaN\n0   2      NaN   NaN     New York   80000.0\n1   3      NaN   NaN      Chicago  120000.0\n2   4      NaN   NaN  Los Angeles   75000.0\n\n\nConcatenating df1 and df2 along columns:\n   ID     Name  Age  ID         City  Salary\n0   1    Alice   25   2     New York   80000\n1   2      Bob   30   3      Chicago  120000\n2   3  Charlie   35   4  Los Angeles   75000\n\n\nJoining df1 and df3 by index:\n         ID  Age Department\nName\nAlice     1   25         HR\nBob       2   30        NaN\nCharlie   3   35         IT\n\n\nMelting df1 to long format:\n   ID Attribute    Value\n0   1      Name    Alice\n1   2      Name      Bob\n2   3      Name  Charlie\n3   1       Age       25\n4   2       Age       30\n5   3       Age       35\n\n\nPivoting melted_df back to wide format:\nAttribute Age     Name\nID\n1          25    Alice\n2          30      Bob\n3          35  Charlie\n'''","position":{"start":{"line":21,"column":1},"end":{"line":141,"column":1}},"key":"bsmH4OBOvs"}],"key":"x7x7u2zece"}],"key":"gUnNfMLRkQ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Panda Aggregation","url":"/xpanda-aggregation","group":"CSCI 127"},"next":{"title":"Panda Statistical Operations","url":"/xpanda-statistical","group":"CSCI 127"}}},"domain":"http://localhost:3001"}