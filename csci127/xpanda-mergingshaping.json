{"version":2,"kind":"Article","sha256":"22b0594eea509fb370fff36e59790dd017f56817171c2e9720726087c03df587","slug":"xpanda-mergingshaping","location":"/xPanda_MergingShaping.md","dependencies":[],"frontmatter":{"title":"Panda Merging and Shaping","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\0_jbdbook\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xPanda_MergingShaping.md","url":"/csci127/build/xPanda_MergingShapin-0cce651973bfd260c83e3d4d8ae2c791.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explanation of Each Operation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UEzaXQQaQG"}],"key":"sPnetmeGEf"}],"identifier":"explanation-of-each-operation","label":"Explanation of Each Operation","html_id":"explanation-of-each-operation","implicit":true,"key":"OdPiVqbd2l"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"pd.merge()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wH1t7C1EoI"}],"key":"k9kYcp1GYz"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XAszMi6Wc6"}],"key":"Tx02hUfwOH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Merges two DataFrames on a common column or key.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AiEiQKafUD"}],"key":"uVK6idbGRo"}],"key":"um4A5WM5Vf"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"V8VXINyaHX"},{"type":"inlineCode","value":"merged_df","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tLRmCHeM0T"},{"type":"text","value":" combines ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FpkKhTPSpi"},{"type":"inlineCode","value":"df1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NrzCGF2JW5"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uMGHGTshz0"},{"type":"inlineCode","value":"df2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pMkkng3jVV"},{"type":"text","value":" on the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"D4KR98j93Z"},{"type":"inlineCode","value":"ID","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IbkX0pcLBI"},{"type":"text","value":" column using an inner join.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ruJHc08xCn"}],"key":"D5Kd4xtD5V"}],"key":"btiwy8Pw8f"}],"key":"HO5lcP9tmx"}],"key":"n3TUYGhF11"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"pd.concat()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"J4RPyMbwAO"}],"key":"BYXHAuceww"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UrKuRnHEKQ"}],"key":"sxD4vktNca"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Concatenates two or more DataFrames along rows (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jXS3TpAUwd"},{"type":"inlineCode","value":"axis=0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sdX1crAFq5"},{"type":"text","value":") or columns (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"g0dHWIQJRo"},{"type":"inlineCode","value":"axis=1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tv6BaQewJD"},{"type":"text","value":").","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wkRUInkoFf"}],"key":"SrA9cLfMA3"}],"key":"KlyEoYoPV4"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fNinD0ltpt"},{"type":"inlineCode","value":"concat_rows","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rGIRRoXBzY"},{"type":"text","value":" stacks ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Fb0BKr4IBG"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gmf5BnIoPa"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"j7GxyarFag"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"w9nb9WQpg6"},{"type":"text","value":" vertically, while ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Af2pz35Tdc"},{"type":"inlineCode","value":"concat_columns","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sFUdP8Pp1o"},{"type":"text","value":" appends ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XfSHgw4OcQ"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fTKqh1Po1B"},{"type":"text","value":" as additional columns to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AHLxKyLHuH"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eSORedCRUT"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qKQ74mAglz"}],"key":"TNXAV5WXT4"}],"key":"QFokpSKPiN"}],"key":"f7AxpLQ5aV"}],"key":"qz9QhjECAL"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"df.join()","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"e0CpZEjQky"}],"key":"z7bgFiCQ1G"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Z9mtPD4XWR"}],"key":"zDihngfRAT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Joins two DataFrames based on their indices.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RzRmYp6d39"}],"key":"Op7tqRRoQX"}],"key":"AFMnnurUg3"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"voxbJpvRyz"},{"type":"inlineCode","value":"joined_df","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dU6KUpx1X8"},{"type":"text","value":" joins ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MTh0JIMgqJ"},{"type":"inlineCode","value":"df1_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fkoyplkrd4"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xW9chQ8alW"},{"type":"inlineCode","value":"df3_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LFkYjphp5X"},{"type":"text","value":" on their index values.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MprmKNyvxF"}],"key":"w97c6F1KbD"}],"key":"PTLYn0muJw"}],"key":"h01mKOysMD"}],"key":"AhexhRi4nw"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineCode","value":"df.melt()","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"X9cpHmOfFv"}],"key":"LyxZ49zJQL"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mpw8GYsb3N"}],"key":"MLiZGfmGzK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from wide format to long format by unpivoting columns.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eVoUaYSNU5"}],"key":"aHb7uhMLnU"}],"key":"TTQIJfVMdH"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"tEJ7I1LBUD"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ccKXn0r68P"},{"type":"text","value":" turns ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"dkVHTyF8yo"},{"type":"inlineCode","value":"Name","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ScYunXiUFZ"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"EERYtdMPA4"},{"type":"inlineCode","value":"Age","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"oX77rWPZfH"},{"type":"text","value":" columns into rows with corresponding values.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"iCHWgcGlnK"}],"key":"yLt8c7LoOY"}],"key":"R7exYrTTz0"}],"key":"Mg3dxfD7cw"}],"key":"zrf4BXfbJy"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"df.pivot()","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"kLkHM0ojwj"}],"key":"ILCVKfG13o"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"AewtoqDEBo"}],"key":"AZz8bJHfOi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from long format to wide format by pivoting on a specified column.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"NNXbDZIYSr"}],"key":"OPtvWlf4fh"}],"key":"dX0VbYA2p8"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pCHqLy84m5"},{"type":"inlineCode","value":"pivoted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IDrSFUKah0"},{"type":"text","value":" pivots ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"J04hljWnp8"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"x2STd0Ysya"},{"type":"text","value":" back to wide format with ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"G6HbB84FfP"},{"type":"inlineCode","value":"Name","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"OT7Pb2xTPO"},{"type":"text","value":" and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XhIIxHJFSS"},{"type":"inlineCode","value":"Age","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bmEv9Hy3cH"},{"type":"text","value":" as columns.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"aN2eZMvBN4"}],"key":"zSOjzLVXMw"}],"key":"j8yXWYvTdp"}],"key":"GKm3l7la2t"}],"key":"EzqZkm4HJD"}],"key":"DRmobSCdqU"},{"type":"code","lang":"python","value":"# Panda Merging and Shaping\n\nimport pandas as pd\n\n# Create sample DataFrames for demonstration\ndf1 = pd.DataFrame({\n    'ID': [1, 2, 3],\n    'Name': ['Alice', 'Bob', 'Charlie'],\n    'Age': [25, 30, 35]\n})\n\ndf2 = pd.DataFrame({\n    'ID': [2, 3, 4],\n    'City': ['New York', 'Chicago', 'Los Angeles'],\n    'Salary': [80000, 120000, 75000]\n})\n\ndf3 = pd.DataFrame({\n    'Department': ['HR', 'Finance', 'IT'],\n    'Head': ['Alice', 'David', 'Charlie']\n})\n\n# ------------------------------\n# 1. pd.merge(): Merge two DataFrames on a common column\n# ------------------------------\nprint(\"Merging df1 and df2 on 'ID':\")\nmerged_df = pd.merge(df1, df2, on='ID', how='inner')  # Inner join\nprint(merged_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 2. pd.concat(): Concatenate two DataFrames along rows or columns\n# ------------------------------\nprint(\"Concatenating df1 and df2 along rows:\")\nconcat_rows = pd.concat([df1, df2], axis=0)  # Concatenating rows\nprint(concat_rows)\nprint(\"\\n\")\n\nprint(\"Concatenating df1 and df2 along columns:\")\nconcat_columns = pd.concat([df1, df2], axis=1)  # Concatenating columns\nprint(concat_columns)\nprint(\"\\n\")\n\n# ------------------------------\n# 3. df.join(): Join two DataFrames on their index\n# ------------------------------\nprint(\"Joining df1 and df3 by index:\")\ndf1_indexed = df1.set_index('Name')\ndf3_indexed = df3.set_index('Head')\njoined_df = df1_indexed.join(df3_indexed, how='left')\nprint(joined_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 4. df.melt(): Unpivot a DataFrame from wide to long format\n# ------------------------------\nprint(\"Melting df1 to long format:\")\nmelted_df = pd.melt(df1, id_vars=['ID'], value_vars=['Name', 'Age'], var_name='Attribute', value_name='Value')\nprint(melted_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 5. df.pivot(): Pivot a DataFrame from long to wide format\n# ------------------------------\nprint(\"Pivoting melted_df back to wide format:\")\npivoted_df = melted_df.pivot(index='ID', columns='Attribute', values='Value')\nprint(pivoted_df)\nprint(\"\\n\")\n\n\n'''\nMerging df1 and df2 on 'ID':\n   ID     Name  Age      City  Salary      \n0   2      Bob   30  New York   80000      \n1   3  Charlie   35   Chicago  120000      \n\n\nConcatenating df1 and df2 along rows:      \n   ID     Name   Age         City    Salary\n0   1    Alice  25.0          NaN       NaN\n1   2      Bob  30.0          NaN       NaN\n2   3  Charlie  35.0          NaN       NaN\n0   2      NaN   NaN     New York   80000.0\n1   3      NaN   NaN      Chicago  120000.0\n2   4      NaN   NaN  Los Angeles   75000.0\n\n\nConcatenating df1 and df2 along columns:\n   ID     Name  Age  ID         City  Salary\n0   1    Alice   25   2     New York   80000\n1   2      Bob   30   3      Chicago  120000\n2   3  Charlie   35   4  Los Angeles   75000\n\n\nJoining df1 and df3 by index:\n         ID  Age Department\nName\nAlice     1   25         HR\nBob       2   30        NaN\nCharlie   3   35         IT\n\n\nMelting df1 to long format:\n   ID Attribute    Value\n0   1      Name    Alice\n1   2      Name      Bob\n2   3      Name  Charlie\n3   1       Age       25\n4   2       Age       30\n5   3       Age       35\n\n\nPivoting melted_df back to wide format:\nAttribute Age     Name\nID\n1          25    Alice\n2          30      Bob\n3          35  Charlie\n'''","position":{"start":{"line":21,"column":1},"end":{"line":141,"column":1}},"key":"oQBuIhYtkO"}],"key":"JwGTW02yCX"}],"key":"lfHIQnxZJO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Panda Aggregation","url":"/xpanda-aggregation","group":"CSCI 127"},"next":{"title":"Panda Statistical Operations","url":"/xpanda-statistical","group":"CSCI 127"}}},"domain":"http://localhost:3000"}