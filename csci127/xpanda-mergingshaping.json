{"version":2,"kind":"Article","sha256":"22b0594eea509fb370fff36e59790dd017f56817171c2e9720726087c03df587","slug":"xpanda-mergingshaping","location":"/xPanda_MergingShaping.md","dependencies":[],"frontmatter":{"title":"Panda Merging and Shaping","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\0_jbdbook\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xPanda_MergingShaping.md","url":"/csci127/build/xPanda_MergingShapin-0cce651973bfd260c83e3d4d8ae2c791.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explanation of Each Operation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ktwJgMiZjL"}],"key":"PSRBqZ64gF"}],"identifier":"explanation-of-each-operation","label":"Explanation of Each Operation","html_id":"explanation-of-each-operation","implicit":true,"key":"nHacQSDHAc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"pd.merge()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yZxTeHPtGr"}],"key":"jSOKyIsxY3"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dHPHoWOMNA"}],"key":"eafhIyjJFi"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Merges two DataFrames on a common column or key.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tJh7oY7Ulz"}],"key":"a20AM9UB4Q"}],"key":"aYAqusChub"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"M7xCe0Cre4"},{"type":"inlineCode","value":"merged_df","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"x1SXWzzCHr"},{"type":"text","value":" combines ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kA3Npbr8cE"},{"type":"inlineCode","value":"df1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Cdn9QKApi9"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aGu2K71ugb"},{"type":"inlineCode","value":"df2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TZIfqolArw"},{"type":"text","value":" on the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cAokDZhEtf"},{"type":"inlineCode","value":"ID","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jspgjogewq"},{"type":"text","value":" column using an inner join.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LdfZ1WvA1x"}],"key":"Qz6XWQ2EaX"}],"key":"rlmBeiNnBW"}],"key":"NT2TmpUjJZ"}],"key":"MpDluxPUUP"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"pd.concat()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XvPZkYFxPo"}],"key":"vi7QPBoeQh"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ODXKBXVwaX"}],"key":"UoAz4NKNMr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Concatenates two or more DataFrames along rows (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ajTkvLapFt"},{"type":"inlineCode","value":"axis=0","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BDr6z1N1aD"},{"type":"text","value":") or columns (","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eHDM5HMIW3"},{"type":"inlineCode","value":"axis=1","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ah4wqY6EaM"},{"type":"text","value":").","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fWlPo3eCca"}],"key":"ZTm7ZBwREv"}],"key":"e1vyXNXBRU"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HWLr9lLCsh"},{"type":"inlineCode","value":"concat_rows","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HTCqGAvlRk"},{"type":"text","value":" stacks ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MoZbLaZnRB"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"oVacqaryYE"},{"type":"text","value":" and ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"YwAbs8YrHB"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rZpo8qKGYp"},{"type":"text","value":" vertically, while ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KqrSrOrfqL"},{"type":"inlineCode","value":"concat_columns","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xJNZbWnhEJ"},{"type":"text","value":" appends ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KKX7G92b2M"},{"type":"inlineCode","value":"df2","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"jJTgGQarED"},{"type":"text","value":" as additional columns to ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pIJxH5LQtu"},{"type":"inlineCode","value":"df1","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SBtDB0Z8OT"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fyg7d2A6UH"}],"key":"lWvK0YmKtU"}],"key":"urx1PT3Udw"}],"key":"wKT23mdtrc"}],"key":"BQwUjJ7XdU"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineCode","value":"df.join()","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vd2IFymR4k"}],"key":"GnrAoSHdnr"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PuSTykTxYp"}],"key":"W598xE5cMI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Joins two DataFrames based on their indices.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"GMRMtYvRyh"}],"key":"smYiCDntT4"}],"key":"x9yhWqC3jS"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"f5W9ZCKZgT"},{"type":"inlineCode","value":"joined_df","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PliN70R7NV"},{"type":"text","value":" joins ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"i0mTUGJj8D"},{"type":"inlineCode","value":"df1_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"byvYI7j5kD"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HVD1BsxoVm"},{"type":"inlineCode","value":"df3_indexed","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jSCTdjIcdn"},{"type":"text","value":" on their index values.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"of1aGNosAO"}],"key":"eE4mI3fTUN"}],"key":"E3ePKMbGh6"}],"key":"m8dfLSvr07"}],"key":"BdPmRMugEd"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"inlineCode","value":"df.melt()","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"dbWBdam7b8"}],"key":"CezEr7Xz3T"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fGqUSvvmdq"}],"key":"YjM6E4pwnc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from wide format to long format by unpivoting columns.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Pb5MzkfYof"}],"key":"vo0fX6aILr"}],"key":"ks377h3EW9"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"CJpldPbSaP"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"JOscVnWrEf"},{"type":"text","value":" turns ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"X9g4bBcwFw"},{"type":"inlineCode","value":"Name","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"a5sEe0dIWX"},{"type":"text","value":" and ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"IV61o9LZy3"},{"type":"inlineCode","value":"Age","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"aN6E7NbF3o"},{"type":"text","value":" columns into rows with corresponding values.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WtkzmTy110"}],"key":"MV6wVJyobO"}],"key":"uEndt1mQUv"}],"key":"GgRQjgOn7g"}],"key":"x3VPDxMTBX"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"df.pivot()","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DQQlt2dc24"}],"key":"eEvjZQ4472"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"JGScp5Balj"}],"key":"NNBVsdK1iz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Converts a DataFrame from long format to wide format by pivoting on a specified column.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"PwzNMrC0Ox"}],"key":"eioLlCC2yH"}],"key":"XFp3F2WjE4"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Example: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KLHwN0px0X"},{"type":"inlineCode","value":"pivoted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"BEjxRJ4NzU"},{"type":"text","value":" pivots ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"TrYRvvfGDj"},{"type":"inlineCode","value":"melted_df","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"eTX9hlExQ5"},{"type":"text","value":" back to wide format with ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"bQwAMX7GAY"},{"type":"inlineCode","value":"Name","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"f23P67RUjx"},{"type":"text","value":" and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ie4oJxQKyB"},{"type":"inlineCode","value":"Age","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XKTZ6jtamv"},{"type":"text","value":" as columns.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"VUeZgtWFEF"}],"key":"zlq7FS3oH7"}],"key":"LGO430dNZb"}],"key":"hIT018fo02"}],"key":"jMR5BxRNl8"}],"key":"OB5lFgu1Pl"},{"type":"code","lang":"python","value":"# Panda Merging and Shaping\n\nimport pandas as pd\n\n# Create sample DataFrames for demonstration\ndf1 = pd.DataFrame({\n    'ID': [1, 2, 3],\n    'Name': ['Alice', 'Bob', 'Charlie'],\n    'Age': [25, 30, 35]\n})\n\ndf2 = pd.DataFrame({\n    'ID': [2, 3, 4],\n    'City': ['New York', 'Chicago', 'Los Angeles'],\n    'Salary': [80000, 120000, 75000]\n})\n\ndf3 = pd.DataFrame({\n    'Department': ['HR', 'Finance', 'IT'],\n    'Head': ['Alice', 'David', 'Charlie']\n})\n\n# ------------------------------\n# 1. pd.merge(): Merge two DataFrames on a common column\n# ------------------------------\nprint(\"Merging df1 and df2 on 'ID':\")\nmerged_df = pd.merge(df1, df2, on='ID', how='inner')  # Inner join\nprint(merged_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 2. pd.concat(): Concatenate two DataFrames along rows or columns\n# ------------------------------\nprint(\"Concatenating df1 and df2 along rows:\")\nconcat_rows = pd.concat([df1, df2], axis=0)  # Concatenating rows\nprint(concat_rows)\nprint(\"\\n\")\n\nprint(\"Concatenating df1 and df2 along columns:\")\nconcat_columns = pd.concat([df1, df2], axis=1)  # Concatenating columns\nprint(concat_columns)\nprint(\"\\n\")\n\n# ------------------------------\n# 3. df.join(): Join two DataFrames on their index\n# ------------------------------\nprint(\"Joining df1 and df3 by index:\")\ndf1_indexed = df1.set_index('Name')\ndf3_indexed = df3.set_index('Head')\njoined_df = df1_indexed.join(df3_indexed, how='left')\nprint(joined_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 4. df.melt(): Unpivot a DataFrame from wide to long format\n# ------------------------------\nprint(\"Melting df1 to long format:\")\nmelted_df = pd.melt(df1, id_vars=['ID'], value_vars=['Name', 'Age'], var_name='Attribute', value_name='Value')\nprint(melted_df)\nprint(\"\\n\")\n\n# ------------------------------\n# 5. df.pivot(): Pivot a DataFrame from long to wide format\n# ------------------------------\nprint(\"Pivoting melted_df back to wide format:\")\npivoted_df = melted_df.pivot(index='ID', columns='Attribute', values='Value')\nprint(pivoted_df)\nprint(\"\\n\")\n\n\n'''\nMerging df1 and df2 on 'ID':\n   ID     Name  Age      City  Salary      \n0   2      Bob   30  New York   80000      \n1   3  Charlie   35   Chicago  120000      \n\n\nConcatenating df1 and df2 along rows:      \n   ID     Name   Age         City    Salary\n0   1    Alice  25.0          NaN       NaN\n1   2      Bob  30.0          NaN       NaN\n2   3  Charlie  35.0          NaN       NaN\n0   2      NaN   NaN     New York   80000.0\n1   3      NaN   NaN      Chicago  120000.0\n2   4      NaN   NaN  Los Angeles   75000.0\n\n\nConcatenating df1 and df2 along columns:\n   ID     Name  Age  ID         City  Salary\n0   1    Alice   25   2     New York   80000\n1   2      Bob   30   3      Chicago  120000\n2   3  Charlie   35   4  Los Angeles   75000\n\n\nJoining df1 and df3 by index:\n         ID  Age Department\nName\nAlice     1   25         HR\nBob       2   30        NaN\nCharlie   3   35         IT\n\n\nMelting df1 to long format:\n   ID Attribute    Value\n0   1      Name    Alice\n1   2      Name      Bob\n2   3      Name  Charlie\n3   1       Age       25\n4   2       Age       30\n5   3       Age       35\n\n\nPivoting melted_df back to wide format:\nAttribute Age     Name\nID\n1          25    Alice\n2          30      Bob\n3          35  Charlie\n'''","position":{"start":{"line":21,"column":1},"end":{"line":141,"column":1}},"key":"D2g2b4Iru5"}],"key":"CrdY2Pj5RJ"}],"key":"DsceTmje4A"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Panda Aggregation","url":"/xpanda-aggregation","group":"CSCI 127"},"next":{"title":"Panda Statistical Operations","url":"/xpanda-statistical","group":"CSCI 127"}}},"domain":"http://localhost:3000"}