{"version":2,"kind":"Article","sha256":"e917fa25c3e9ab0aa3bab476db569d3cbcc6750c02d6413c017cae6d36facd9b","slug":"xserialization-pickle-function","location":"/xSerialization_Pickle_Function.md","dependencies":[],"frontmatter":{"title":"Serialization - Pickle - Function","content_includes_title":false,"authors":[{"nameParsed":{"literal":"James Goudy","given":"James","family":"Goudy"},"name":"James Goudy","id":"contributors-a_books\\0_jbdbook\\myst-generated-uid-0"}],"copyright":"2025 By James Goudy","numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"xSerialization_Pickle_Function.md","url":"/csci127/build/xSerialization_Pickl-ca782e8c4ac69c770ac4123f9f739442.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","kind":"danger","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Danger","key":"vs11en6whF"}],"key":"caL4b93F8k"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ONLY UNPICKLE FILES FROM A TRUSTED SOURCE. MALICOUS CODE CAN BE EXECUTED IN THE RECONSTRUCTION PROCESS","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VJs3lTMZ5p"}],"key":"QuPByi6SC8"}],"key":"C9MAX1tvSg"},{"type":"admonition","kind":"caution","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Caution","key":"vDVHrIWe5a"}],"key":"TSwzHA38vP"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Pickling functions is done by reference and not the code itself. If other modules are involved, problems could arise. Also since it doesnâ€™t actually read the code, the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KXhlI6Kr9n"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"marshal","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jf2SUOCWTO"}],"key":"iidzhFQFl2"},{"type":"text","value":" library must be used. Marshal.load will actually read the function code.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LwLDONOcYI"}],"key":"uqZ5CNlMTq"}],"key":"LRnYrvjxx0"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Pickle Function Demo Code","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ueV441HtbZ"}],"identifier":"pickle-function-demo-code","label":"Pickle Function Demo Code","html_id":"pickle-function-demo-code","implicit":true,"key":"RPRSE0OKGc"},{"type":"code","lang":"python","value":"\"\"\"\nProgrammer: James Goudy\n\n***\nPickling functions are NOT reccomended,\nespcially if they require other modules.\n\nPickling functions does it by reference\nand not the code itself.\n\nTo get around that, using the marshal\nlibrary (loads) will read the actual code.\n***\n\"\"\"\n\nimport pickle\nimport marshal\nimport types\n\ndef add(num1, num2):\n  \"\"\"\n  Adds two numbers \n  and returns the sum.\n  \"\"\"\n  return num1 + num2\n\ndef pickle_add_func():\n  \n  # reads the actual add function code\n  # and turns it into bytecode\n  mybytecode = marshal.dumps(add.__code__)\n\n  # write the bytecode to a binary file\n  with open(\"add.pickle\",\"wb\") as outfile:\n    pickle.dump(mybytecode,outfile)\n  outfile.close()\n\n  print(\"\\nFunction Pickled\")\n\ndef de_pickle_add_func():\n  \n  # read the file contents\n  with open('add.pickle','rb') as infile:\n    mypickledata = infile.read()\n  infile.close()\n\n  # unpickle contents to bytecode / binary\n  mybytecode = pickle.loads(mypickledata)\n\n  # get the code marshel bytecode object\n  mycode = marshal.loads(mybytecode)\n\n  # create the new function\n  newAdd = types.FunctionType(mycode,globals())\n\n  print(\"Function \\'Depickled\\'\")\n  ans = newAdd(10,30)\n\n  print(ans)\n\n\ndef main():\n\n  pickle_add_func()\n  \n\n  de_pickle_add_func()\n\n  print(\"bye\")\n\nmain()\n\n\n","position":{"start":{"line":15,"column":1},"end":{"line":90,"column":1}},"key":"GjruaJlDty"}],"key":"EscVmobb7t"}],"key":"IaqAMfBG6b"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Serialization - Pickle - Data","url":"/xserialization-pickle-data","group":"CSCI 127"},"next":{"title":"Serialization - Pickle -  Security Implications","url":"/xserialization-pickle-security","group":"CSCI 127"}}},"domain":"http://localhost:3000"}